
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Safe forecasting with spot">
      
      
        <meta name="author" content="bartzbeielstein">
      
      
        <link rel="canonical" href="https://sequential-parameter-optimization.github.io/spotforecast2-safe/api/forecaster/">
      
      
        <link rel="prev" href="../processing/">
      
      
        <link rel="next" href="../utils/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Forecaster - spotforecast2-safe</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#forecaster-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="spotforecast2-safe" class="md-header__button md-logo" aria-label="spotforecast2-safe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotforecast2-safe
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Forecaster
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotforecast2-safe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    spotforecast2-safe
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api_overview/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../data/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../processing/model_persistence/" class="md-tabs__link">
          
  
  
  Processing Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../preprocessing/outliers/" class="md-tabs__link">
          
  
  
  Preprocessing Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../recursive/ForecasterRecursive/" class="md-tabs__link">
          
  
  
  Forecaster Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../safe/spotforecast2-safe/" class="md-tabs__link">
          
  
  
  Safety & Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/" class="md-tabs__link">
          
  
  
  Development & Community

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="spotforecast2-safe" class="md-nav__button md-logo" aria-label="spotforecast2-safe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    spotforecast2-safe
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotforecast2-safe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    spotforecast2-safe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Forecaster
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Forecaster
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        forecaster
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.regressor" class="md-nav__link">
    <span class="md-ellipsis">
      
        regressor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterRecursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterRecursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_predict_X" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_predict_X
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_sample_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_sample_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.get_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict_bootstrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_bootstrapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#base-forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Forecaster
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Base Forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.regressor" class="md-nav__link">
    <span class="md-ellipsis">
      
        regressor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursive-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recursive Forecasting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recursive Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="recursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterEquivalentDate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterEquivalentDate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterRecursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterRecursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_predict_X" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_predict_X
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_sample_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_sample_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.get_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_bootstrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_bootstrapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forecasting-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forecasting Utilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Forecasting Utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_exog" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_exog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_exog_dtypes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_extract_values_and_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_extract_values_and_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_predict_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_predict_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_preprocess_series" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_preprocess_series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_residuals_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_residuals_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_select_fit_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_select_fit_kwargs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        date_to_index_position
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="date_to_index_position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-an-integer-input" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using an integer input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using a date input for prediction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-number-of-steps-from-the-last-date-in-the-index-to-the-target-date" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5 (number of steps from the last date in the index to the target date)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using a date input for validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-position-plus-one-of-the-target-date-in-the-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5 (position plus one of the target date in the index)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.exog_to_direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        exog_to_direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.exog_to_direct_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        exog_to_direct_numpy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.expand_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        expand_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.get_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_exog_dtypes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.get_style_repr_html" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_style_repr_html
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_estimator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initialize_estimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-estimator-argument" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the estimator argument
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-deprecated-regressor-argument" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the deprecated regressor argument
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_transformer_series" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_transformer_series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.input_to_frame" class="md-nav__link">
    <span class="md-ellipsis">
      
        input_to_frame
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.predict_multivariate" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_multivariate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.prepare_steps_direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        prepare_steps_direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.select_n_jobs_fit_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        select_n_jobs_fit_forecaster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.set_skforecast_warnings" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_skforecast_warnings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.transform_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_dataframe
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.transform_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_numpy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weather/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weather
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Processing Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Processing Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processing/model_persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Preprocessing Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/outliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Outlier Detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Forecaster Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Forecaster Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recursive/ForecasterRecursive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ForecasterRecursive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../recursive/ForecasterEquivalentDate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ForecasterEquivalentDate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Safety & Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Safety & Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../safe/spotforecast2-safe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streamlining Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../safe/MODEL_CARD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model/Method Card
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../safe/VERSION_MANAGEMENT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development & Community
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development & Community
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        forecaster
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.regressor" class="md-nav__link">
    <span class="md-ellipsis">
      
        regressor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.set_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterBase.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterRecursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterRecursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_predict_X" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_predict_X
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_sample_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_sample_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.get_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict_bootstrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_bootstrapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.ForecasterRecursive.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#base-forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base Forecaster
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Base Forecaster">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterBase
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.regressor" class="md-nav__link">
    <span class="md-ellipsis">
      
        regressor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.set_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.base.ForecasterBase.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursive-forecasting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recursive Forecasting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recursive Forecasting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="recursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterEquivalentDate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterEquivalentDate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive" class="md-nav__link">
    <span class="md-ellipsis">
      
        ForecasterRecursive
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterRecursive">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__setstate__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __setstate__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_predict_X" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_predict_X
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_sample_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_sample_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_train_X_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.get_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_params
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_bootstrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_bootstrapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_in_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_in_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_out_sample_residuals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forecasting-utilities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forecasting Utilities
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Forecasting Utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_exog" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_exog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_exog_dtypes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_extract_values_and_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_extract_values_and_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_interval" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_interval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_predict_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_predict_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_preprocess_series" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_preprocess_series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_residuals_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_residuals_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_select_fit_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_select_fit_kwargs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.check_y" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_y
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position" class="md-nav__link">
    <span class="md-ellipsis">
      
        date_to_index_position
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="date_to_index_position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-an-integer-input" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using an integer input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-prediction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using a date input for prediction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-number-of-steps-from-the-last-date-in-the-index-to-the-target-date" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5 (number of steps from the last date in the index to the target date)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using a date input for validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-position-plus-one-of-the-target-date-in-the-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output: 5 (position plus one of the target date in the index)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.exog_to_direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        exog_to_direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.exog_to_direct_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        exog_to_direct_numpy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.expand_index" class="md-nav__link">
    <span class="md-ellipsis">
      
        expand_index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.get_exog_dtypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_exog_dtypes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.get_style_repr_html" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_style_repr_html
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_estimator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initialize_estimator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-estimator-argument" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the estimator argument
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-deprecated-regressor-argument" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using the deprecated regressor argument
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_lags" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_lags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_transformer_series" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_transformer_series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_weights" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_weights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.initialize_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_window_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.input_to_frame" class="md-nav__link">
    <span class="md-ellipsis">
      
        input_to_frame
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.predict_multivariate" class="md-nav__link">
    <span class="md-ellipsis">
      
        predict_multivariate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.prepare_steps_direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        prepare_steps_direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.select_n_jobs_fit_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        select_n_jobs_fit_forecaster
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.set_skforecast_warnings" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_skforecast_warnings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.transform_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_dataframe
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.forecaster.utils.transform_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_numpy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="forecaster-module">Forecaster Module</h1>
<p>Core forecasting classes and utilities.</p>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.forecaster" class="doc doc-heading">
            <code>spotforecast2_safe.forecaster</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.forecaster.ForecasterBase" class="doc doc-heading">
            <code>ForecasterBase</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>Base class for all forecasters in spotforecast2.</p>
<p>All forecasters should specify all the parameters that can be set at
the class level in their <strong>init</strong>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterBase.__spotforecast_tags__">__spotforecast_tags__</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with forecaster tags that characterize
the behavior of the forecaster.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>To see all abstract methods that need to be implemented:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterBase</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">ForecasterBase</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">isabstract</span><span class="p">)]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[&#39;create_train_X_y&#39;, &#39;fit&#39;, &#39;predict&#39;, &#39;set_params&#39;]</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">class</span><span class="w"> </span><span class="nc">ForecasterBase</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all forecasters in spotforecast2.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    All forecasters should specify all the parameters that can be set at</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    the class level in their __init__.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        __spotforecast_tags__: Dictionary with forecaster tags that characterize</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            the behavior of the forecaster.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        To see all abstract methods that need to be implemented:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        &gt;&gt;&gt; import inspect</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.base import ForecasterBase</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        &gt;&gt;&gt; [m[0] for m in inspect.getmembers(ForecasterBase, predicate=inspect.isabstract)]</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        [&#39;create_train_X_y&#39;, &#39;fit&#39;, &#39;predict&#39;, &#39;set_params&#39;]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_preprocess_repr</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">training_range_</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">series_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">exog_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">transformer_series</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the information to be displayed when a Forecaster object is printed.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            estimator: Estimator object. Default is None.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            training_range_: Training range. Only used for ForecasterRecursiveMultiSeries.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            series_names_in_: Names of the series used in the forecaster.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                Only used for ForecasterRecursiveMultiSeries. Default is None.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            exog_names_in_: Names of the exogenous variables used in the forecaster.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            transformer_series: Transformer used in the series.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                Only used for ForecasterRecursiveMultiSeries. Default is None.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            Tuple containing params (estimator parameters string), training_range_</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            (training range string representation), series_names_in_ (series names</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            string representation), exog_names_in_ (exogenous variable names string</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            representation), and transformer_series (transformer string representation).</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            &gt;&gt;&gt; estimator = Ridge(alpha=0.5)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=estimator, lags=3)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            &gt;&gt;&gt; params, tr, sn, en, ts = forecaster._preprocess_repr(estimator=estimator)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            &gt;&gt;&gt; params</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            &quot;{&#39;alpha&#39;: 0.5, &#39;copy_X&#39;: True, &#39;fit_intercept&#39;: True, &#39;max_iter&#39;: None, &#39;positive&#39;: False, &#39;random_state&#39;: None, &#39;solver&#39;: &#39;auto&#39;, &#39;tol&#39;: 0.0001}&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">if</span> <span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">name_pipe_steps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">named_steps</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name_pipe_steps</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="p">}</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="n">params</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="n">params</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">params</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">if</span> <span class="n">training_range_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">training_range_</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">training_range_</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_range_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">training_range_</span> <span class="o">=</span> <span class="n">training_range_</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">training_range_</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">training_range_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">training_range_</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">series_names_in_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="n">series_names_in_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                    <span class="n">series_names_in_</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">series_names_in_</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">:]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">if</span> <span class="n">exog_names_in_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">exog_names_in_</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">:]</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="n">transformer_series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transformer_series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="p">]</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                    <span class="n">transformer_series</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                        <span class="n">transformer_series</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">transformer_series</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                    <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">training_range_</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">series_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">transformer_series</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_text_repr</span><span class="p">(</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">max_text_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">indent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;    &quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format text for __repr__ method.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            text: Text to format.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            max_text_length: Maximum length of the text before wrapping. Default is 58.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            width: Maximum width of the text. Default is 80.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            indent: Indentation of the text. Default is four spaces.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            Formatted text string with proper wrapping and indentation.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            &gt;&gt;&gt; forecaster._format_text_repr(&quot;Short text&quot;)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            &#39;Short text&#39;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_text_length</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    &quot;</span> <span class="o">+</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">subsequent_indent</span><span class="o">=</span><span class="n">indent</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">return</span> <span class="n">text</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create training matrices from univariate time series and exogenous variables.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            Tuple containing X_train (training values/predictors with shape</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            (len(y) - max_lag, len(lags))) and y_train (target values of the</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            time series related to each row of X_train with shape (len(y) - max_lag,)).</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            &gt;&gt;&gt; X_train.head(2)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">               lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            3    2.0    1.0    0.0</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            4    3.0    2.0    1.0</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            &gt;&gt;&gt; y_train.head(2)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            3    3</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            4    4</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            Name: y, dtype: int64</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">pass</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Training Forecaster.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">                number of observations as y and their indexes must be aligned so</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">                that y[i] is regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            None</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            &gt;&gt;&gt; forecaster.is_fitted</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            True</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">pass</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict n steps ahead.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            steps: Number of steps to predict.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                first iteration of the prediction (t + 1). If None, the values stored in</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">                last_window are used to calculate the initial predictors, and the</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">                predictions start right after training data. Default is None.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Default is None.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            Predicted values as a pandas Series.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            10    9.5</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            11    9.0</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            12    8.5</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            Name: pred, dtype: float64</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">pass</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new values to the parameters of the scikit-learn model stored in the forecaster.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            params: Parameters values dictionary.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(alpha=1.0), lags=3)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_params({&#39;estimator__alpha&#39;: 0.5})</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            &gt;&gt;&gt; forecaster.estimator.alpha</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            0.5</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">pass</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_lags</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute lags.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        Attributes max_lag and window_size are also updated.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            lags: Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                or range: include only lags present in lags, all elements must be int.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">                If None: no lags are included as predictors. Default is None.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            None</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_lags(lags=5)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            &gt;&gt;&gt; forecaster.lags</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            array([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">pass</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_window_features</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">window_features</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute window_features.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Attributes max_size_window_features, window_features_names,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        window_features_class_names and window_size are also updated.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            window_features: Instance or list of instances used to create window features.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">                Window features are created from the original time series and are</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                included as predictors. Default is None.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            &gt;&gt;&gt; window_feat = RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_window_features(window_features=window_feat)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            &gt;&gt;&gt; forecaster.window_features</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            [RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">pass</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            Dictionary with forecaster tags describing behavior and capabilities.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            &gt;&gt;&gt; tags[&#39;forecaster_task&#39;]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            &#39;regression&#39;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Show forecaster information.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            None</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            &gt;&gt;&gt; forecaster.summary()</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            ForecasterRecursive</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            ===================</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            Estimator: Ridge()</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            Lags: [1 2 3]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            ...</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        This method is called when an object is unpickled (deserialized).</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        It handles the migration of deprecated attributes to their new names.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            state: The state dictionary from the pickled object.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            None</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            &gt;&gt;&gt; import pickle</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            &gt;&gt;&gt; pickled_forecaster = pickle.dumps(forecaster)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            &gt;&gt;&gt; unpickled_forecaster = pickle.loads(pickled_forecaster)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">if</span> <span class="s2">&quot;regressor&quot;</span> <span class="ow">in</span> <span class="n">state</span> <span class="ow">and</span> <span class="s2">&quot;estimator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;estimator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">regressor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deprecated property. Use estimator instead.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            The estimator object.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            &gt;&gt;&gt; forecaster.regressor # Raises FutureWarning</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            Ridge()</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="s2">&quot;The `regressor` attribute is deprecated and will be removed in future &quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="s2">&quot;versions. Use `estimator` instead.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="spotforecast2_safe.forecaster.ForecasterBase.regressor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">regressor</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Deprecated property. Use estimator instead.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The estimator object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span> <span class="c1"># Raises FutureWarning</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Ridge()</span>
</code></pre></div>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Custom <strong>setstate</strong> to ensure backward compatibility when unpickling.</p>
<p>This method is called when an object is unpickled (deserialized).
It handles the migration of deprecated attributes to their new names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state dictionary from the pickled object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pickled_forecaster</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">unpickled_forecaster</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickled_forecaster</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    This method is called when an object is unpickled (deserialized).</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    It handles the migration of deprecated attributes to their new names.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        state: The state dictionary from the pickled object.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        None</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        &gt;&gt;&gt; import pickle</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        &gt;&gt;&gt; pickled_forecaster = pickle.dumps(forecaster)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        &gt;&gt;&gt; unpickled_forecaster = pickle.loads(pickled_forecaster)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">if</span> <span class="s2">&quot;regressor&quot;</span> <span class="ow">in</span> <span class="n">state</span> <span class="ow">and</span> <span class="s2">&quot;estimator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;estimator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.create_train_X_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create training matrices from univariate time series and exogenous variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Must have the same
number of observations as y and their indexes must be aligned.
Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing X_train (training values/predictors with shape</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(len(y) - max_lag, len(lags))) and y_train (target values of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time series related to each row of X_train with shape (len(y) - max_lag,)).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">   lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">3    2.0    1.0    0.0</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">4    3.0    2.0    1.0</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">3    3</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">4    4</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">Name: y, dtype: int64</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create training matrices from univariate time series and exogenous variables.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        y: Training time series.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            Default is None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        Tuple containing X_train (training values/predictors with shape</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        (len(y) - max_lag, len(lags))) and y_train (target values of the</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        time series related to each row of X_train with shape (len(y) - max_lag,)).</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        &gt;&gt;&gt; X_train.head(2)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">           lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        3    2.0    1.0    0.0</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        4    3.0    2.0    1.0</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        &gt;&gt;&gt; y_train.head(2)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        3    3</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        4    4</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        Name: y, dtype: int64</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Training Forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Must have the same
number of observations as y and their indexes must be aligned so
that y[i] is regressed on exog[i]. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">is_fitted</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Training Forecaster.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        y: Training time series.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            number of observations as y and their indexes must be aligned so</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            that y[i] is regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        None</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &gt;&gt;&gt; forecaster.is_fitted</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        True</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.get_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tags</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the tags that characterize the behavior of the forecaster.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with forecaster tags describing behavior and capabilities.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;forecaster_task&#39;</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">&#39;regression&#39;</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        Dictionary with forecaster tags describing behavior and capabilities.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        &gt;&gt;&gt; tags[&#39;forecaster_task&#39;]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        &#39;regression&#39;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1). If None, the values stored in
last_window are used to calculate the initial predictors, and the
predictions start right after training data. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values as a pandas Series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">10    9.5</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">11    9.0</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">12    8.5</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">Name: pred, dtype: float64</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Predict n steps ahead.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        steps: Number of steps to predict.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            first iteration of the prediction (t + 1). If None, the values stored in</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            last_window are used to calculate the initial predictors, and the</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            predictions start right after training data. Default is None.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Default is None.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        Predicted values as a pandas Series.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        10    9.5</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        11    9.0</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        12    8.5</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        Name: pred, dtype: float64</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.set_lags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_lags</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new value to the attribute lags.</p>
<p>Attributes max_lag and window_size are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.
If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,
or range: include only lags present in lags, all elements must be int.
If None: no lags are included as predictors. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_lags</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">array([1, 2, 3, 4, 5])</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_lags</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute lags.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Attributes max_lag and window_size are also updated.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        lags: Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            or range: include only lags present in lags, all elements must be int.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            If None: no lags are included as predictors. Default is None.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        None</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_lags(lags=5)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        &gt;&gt;&gt; forecaster.lags</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        array([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Set new values to the parameters of the scikit-learn model stored in the forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameters values dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">({</span><span class="s1">&#39;estimator__alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">alpha</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">0.5</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new values to the parameters of the scikit-learn model stored in the forecaster.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        params: Parameters values dictionary.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(alpha=1.0), lags=3)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_params({&#39;estimator__alpha&#39;: 0.5})</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        &gt;&gt;&gt; forecaster.estimator.alpha</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        0.5</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.set_window_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new value to the attribute window_features.</p>
<p>Attributes max_size_window_features, window_features_names,
window_features_class_names and window_size are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>window_features</code>
            </td>
            <td>
                  <code><span title="object">object</span> | <span title="list">list</span>[<span title="object">object</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance or list of instances used to create window features.
Window features are created from the original time series and are
included as predictors. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">window_feat</span> <span class="o">=</span> <span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="o">=</span><span class="n">window_feat</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_window_features</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">window_features</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute window_features.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    Attributes max_size_window_features, window_features_names,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    window_features_class_names and window_size are also updated.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        window_features: Instance or list of instances used to create window features.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            Window features are created from the original time series and are</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            included as predictors. Default is None.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        &gt;&gt;&gt; window_feat = RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_window_features(window_features=window_feat)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        &gt;&gt;&gt; forecaster.window_features</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        [RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterBase.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Show forecaster information.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">ForecasterRecursive</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">===================</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">Estimator: Ridge()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">Lags: [1 2 3]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">...</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Show forecaster information.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        None</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        &gt;&gt;&gt; forecaster.summary()</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        ForecasterRecursive</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        ===================</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        Estimator: Ridge()</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Lags: [1 2 3]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        ...</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.forecaster.ForecasterRecursive" class="doc doc-heading">
            <code>ForecasterRecursive</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ForecasterBase (spotforecast2_safe.forecaster.base.ForecasterBase)" href="#spotforecast2_safe.forecaster.base.ForecasterBase">ForecasterBase</a></code></p>



        <p>Recursive autoregressive forecaster for scikit-learn compatible estimators.</p>
<p>This class turns any estimator compatible with the scikit-learn API into a
recursive autoregressive (multi-step) forecaster. The forecaster learns to predict
future values by using lagged values of the target variable and optional exogenous
features. Predictions are made iteratively, where each step uses previous predictions
as input for the next step (recursive strategy).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn compatible estimator for regression. If None, a default
estimator will be initialized. Can also be passed via regressor parameter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="typing.List">List</span>[<span title="int">int</span>], <span title="numpy.ndarray">ndarray</span>, <span title="range">range</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lagged values of the target variable to use as predictors. Can be an
integer (uses lags from 1 to lags), list of integers, numpy array, or range.
At least one of lags or window_features must be provided. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_features</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="object">object</span>, <span title="typing.List">List</span>[<span title="object">object</span>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of window feature objects to compute features from the
target variable. Each object must implement transform_batch() method.
At least one of lags or window_features must be provided. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer_y</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer object for the target variable. Must implement fit()
and transform() methods. Applied before training and predictions.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer_exog</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer object for exogenous variables. Must implement
fit() and transform() methods. Applied before training and predictions.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weight_func</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to compute sample weights for training. Must accept an
index and return an array of weights. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing to apply to the target variable.
Must be a positive integer. Differencing is applied before creating lags.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional keyword arguments to pass to the estimator's
fit() method. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binner_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of keyword arguments for QuantileBinner used in
probabilistic predictions. Defaults to {'n_bins': 10, 'method': 'linear'}.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_id</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="int">int</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier for the forecaster instance. Can be a string or
integer. Used for tracking and logging purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regressor</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative parameter name for estimator. If provided, used instead
of estimator. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.estimator">estimator</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted scikit-learn estimator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.lags">lags</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lag indices used in the model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.lags_names">lags_names</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of lag features (e.g., ['lag_1', 'lag_2']).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.window_features">window_features</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of window feature transformers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.window_features_names">window_features_names</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.window_size">window_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum window size needed (max of lags and window features).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.transformer_y">transformer_y</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer for target variable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.transformer_exog">transformer_exog</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer for exogenous variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.weight_func">weight_func</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for sample weighting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.differentiation">differentiation</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing applied.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.differentiator">differentiator</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesDifferentiator instance if differencing is used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.is_fitted">is_fitted</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if forecaster has been fitted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.fit_date">fit_date</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp of the last fit operation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.last_window_">last_window_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last window_size observations from training data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.index_type_">index_type_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of index in training data (RangeIndex or DatetimeIndex).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.index_freq_">index_freq_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency of DatetimeIndex if applicable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.training_range_">training_range_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First and last index values of training data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.series_name_in_">series_name_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.exog_in_">exog_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if exogenous variables were used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.exog_names_in_">exog_names_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of exogenous variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.exog_type_in_">exog_type_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of exogenous input (Series or DataFrame).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.X_train_features_names_out_">X_train_features_names_out_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of all training features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.in_sample_residuals_">in_sample_residuals_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals from training set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.in_sample_residuals_by_bin_">in_sample_residuals_by_bin_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals grouped by bins for probabilistic pred.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.ForecasterRecursive.forecaster_id">forecaster_id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier for the forecaster instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Either lags or window_features (or both) must be provided during initialization.</li>
<li>The forecaster uses a recursive strategy where each multi-step prediction
  depends on previous predictions within the same forecast horizon.</li>
<li>Exogenous variables must have the same index as the target variable and must
  be available for the entire prediction horizon.</li>
<li>The forecaster supports point predictions, prediction intervals, bootstrapping,
  quantile predictions, and probabilistic forecasts via conformal methods.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a basic forecaster with lags:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with window features and transformations:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">7</span><span class="p">)],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">transformer_y</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">(),</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">differentiation</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with exogenous variables:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">forecaster_id</span><span class="o">=</span><span class="s1">&#39;my_forecaster&#39;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_future</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">105</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog_future</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with probabilistic prediction configuration:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">GradientBoostingRegressor</span><span class="p">(),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">binner_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_bins&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">}</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">  50</a></span>
<span class="normal"><a href="#__codelineno-0-51">  51</a></span>
<span class="normal"><a href="#__codelineno-0-52">  52</a></span>
<span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">class</span><span class="w"> </span><span class="nc">ForecasterRecursive</span><span class="p">(</span><span class="n">ForecasterBase</span><span class="p">):</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Recursive autoregressive forecaster for scikit-learn compatible estimators.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    This class turns any estimator compatible with the scikit-learn API into a</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    recursive autoregressive (multi-step) forecaster. The forecaster learns to predict</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    future values by using lagged values of the target variable and optional exogenous</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    features. Predictions are made iteratively, where each step uses previous predictions</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    as input for the next step (recursive strategy).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        estimator: Scikit-learn compatible estimator for regression. If None, a default</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            estimator will be initialized. Can also be passed via regressor parameter.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        lags: Lagged values of the target variable to use as predictors. Can be an</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            integer (uses lags from 1 to lags), list of integers, numpy array, or range.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            At least one of lags or window_features must be provided. Defaults to None.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        window_features: List of window feature objects to compute features from the</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            target variable. Each object must implement transform_batch() method.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            At least one of lags or window_features must be provided. Defaults to None.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        transformer_y: Transformer object for the target variable. Must implement fit()</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            and transform() methods. Applied before training and predictions.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        transformer_exog: Transformer object for exogenous variables. Must implement</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            fit() and transform() methods. Applied before training and predictions.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        weight_func: Function to compute sample weights for training. Must accept an</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            index and return an array of weights. Defaults to None.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        differentiation: Order of differencing to apply to the target variable.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            Must be a positive integer. Differencing is applied before creating lags.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        fit_kwargs: Dictionary of additional keyword arguments to pass to the estimator&#39;s</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            fit() method. Defaults to None.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        binner_kwargs: Dictionary of keyword arguments for QuantileBinner used in</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            probabilistic predictions. Defaults to {&#39;n_bins&#39;: 10, &#39;method&#39;: &#39;linear&#39;}.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        forecaster_id: Identifier for the forecaster instance. Can be a string or</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            integer. Used for tracking and logging purposes. Defaults to None.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        regressor: Alternative parameter name for estimator. If provided, used instead</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            of estimator. Defaults to None.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        estimator: Fitted scikit-learn estimator.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        lags: Lag indices used in the model.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        lags_names: Names of lag features (e.g., [&#39;lag_1&#39;, &#39;lag_2&#39;]).</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        window_features: List of window feature transformers.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        window_features_names: Names of window features.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        window_size: Maximum window size needed (max of lags and window features).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        transformer_y: Transformer for target variable.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        transformer_exog: Transformer for exogenous variables.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        weight_func: Function for sample weighting.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        differentiation: Order of differencing applied.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        differentiator: TimeSeriesDifferentiator instance if differencing is used.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        is_fitted: Boolean indicating if forecaster has been fitted.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        fit_date: Timestamp of the last fit operation.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        last_window_: Last window_size observations from training data.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        index_type_: Type of index in training data (RangeIndex or DatetimeIndex).</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        index_freq_: Frequency of DatetimeIndex if applicable.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        training_range_: First and last index values of training data.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        series_name_in_: Name of the target series.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        exog_in_: Boolean indicating if exogenous variables were used in training.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        exog_names_in_: Names of exogenous variables.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        exog_type_in_: Type of exogenous input (Series or DataFrame).</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        X_train_features_names_out_: Names of all training features.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        in_sample_residuals_: Residuals from training set.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        in_sample_residuals_by_bin_: Residuals grouped by bins for probabilistic pred.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        forecaster_id: Identifier for the forecaster instance.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        - Either lags or window_features (or both) must be provided during initialization.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        - The forecaster uses a recursive strategy where each multi-step prediction</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">          depends on previous predictions within the same forecast horizon.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        - Exogenous variables must have the same index as the target variable and must</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">          be available for the entire prediction horizon.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        - The forecaster supports point predictions, prediction intervals, bootstrapping,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">          quantile predictions, and probabilistic forecasts via conformal methods.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Create a basic forecaster with lags:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        ...     lags=10</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Create a forecaster with window features and transformations:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        &gt;&gt;&gt; from sklearn.preprocessing import StandardScaler</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        ...     estimator=RandomForestRegressor(n_estimators=100),</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        ...     lags=[1, 7, 30],</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=7)],</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        ...     transformer_y=StandardScaler(),</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        ...     differentiation=1</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=10)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Create a forecaster with exogenous variables:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;target&#39;)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(100)}, index=y.index)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        ...     estimator=Ridge(),</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        ...     lags=7,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        ...     forecaster_id=&#39;my_forecaster&#39;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y, exog)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        &gt;&gt;&gt; exog_future = pd.DataFrame(</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        ...     {&#39;temp&#39;: np.random.randn(5)},</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        ...     index=pd.RangeIndex(start=100, stop=105)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5, exog=exog_future)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        Create a forecaster with probabilistic prediction configuration:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import GradientBoostingRegressor</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        ...     estimator=GradientBoostingRegressor(),</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ...     lags=14,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        ...     binner_kwargs={&#39;n_bins&#39;: 15, &#39;method&#39;: &#39;linear&#39;}</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">lags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">window_features</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">transformer_y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">transformer_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">weight_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">binner_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">forecaster_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">initialize_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">regressor</span><span class="p">))</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="o">=</span> <span class="n">transformer_y</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span> <span class="o">=</span> <span class="n">transformer_exog</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="o">=</span> <span class="n">weight_func</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="n">__version__</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span> <span class="o">=</span> <span class="n">forecaster_id</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">=</span> <span class="s2">&quot;binned&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="p">(</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">initialize_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="s2">&quot;At least one of the arguments `lags` or `window_features` &quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="s2">&quot;must be different from None. This is required to create the &quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="s2">&quot;predictors used in training the forecaster.&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="p">[</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="n">ws</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">]</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                <span class="k">if</span> <span class="n">ws</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="p">]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="p">]</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">initialize_weights</span><span class="p">(</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">weight_func</span><span class="o">=</span><span class="n">weight_func</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">series_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="sa">f</span><span class="s2">&quot;Argument `differentiation` must be an integer equal to or &quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="sa">f</span><span class="s2">&quot;greater than 1. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="n">TimeSeriesDifferentiator</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                <span class="n">order</span><span class="o">=</span><span class="n">differentiation</span>  <span class="c1"># , window_size=self.window_size # TODO: TimeSeriesDifferentiator in preprocessing created only takes order, add window_size if needed</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="n">fit_kwargs</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="n">binner_kwargs</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="k">if</span> <span class="n">binner_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">}</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="o">=</span> <span class="n">QuantileBinner</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>  <span class="c1"># single-series | global</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>  <span class="c1"># recursive | direct | deep_learning</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="p">],</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="p">}</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Information displayed when a ForecasterRecursive object is printed.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            str: String representation of the forecaster with key information about its configuration and state.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            &gt;&gt;&gt; print(forecaster)  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            =========================</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">            ForecasterRecursive</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            =========================</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            Estimator: LinearRegression</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            Lags: [1, 2, 3]</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            Window features: []</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">            Window size: 3</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            Series name: None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            Exogenous included: False</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            Exogenous names: None</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            Transformer for y: None</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            Transformer for exog: None</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            Weight function included: False</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            Differentiation order: None</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            Training range: None</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            Training index type: None</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            Training index frequency: None</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            Estimator parameters: {...}</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            fit_kwargs: {...}</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            Creation date: ...</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            Last fit date: None</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            spotforecast version: ...</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            Python version: ...</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            Forecaster id: None</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="sa">f</span><span class="s2">&quot;Estimator: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="sa">f</span><span class="s2">&quot;Lags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="sa">f</span><span class="s2">&quot;Window features: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="sa">f</span><span class="s2">&quot;Exogenous included: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="sa">f</span><span class="s2">&quot;Exogenous names: </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="sa">f</span><span class="s2">&quot;Transformer for y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="sa">f</span><span class="s2">&quot;Transformer for exog: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="sa">f</span><span class="s2">&quot;Weight function included: </span><span class="si">{</span><span class="kc">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">False</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation order: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="sa">f</span><span class="s2">&quot;Estimator parameters: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="sa">f</span><span class="s2">&quot;fit_kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        HTML representation of the object.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            HTML string representation of the forecaster.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            &gt;&gt;&gt; forecaster._repr_html_()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            &#39;&lt;div class=&quot;container-...&quot;&gt;...&lt;/div&gt;&#39;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Estimator:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Lags:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window features:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Series name:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Exogenous included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Weight function included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation order:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Creation date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Last fit date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;spotforecast version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Python version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Forecaster id:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="s2">                &lt;summary&gt;Exogenous Variables&lt;/summary&gt;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="s2">                    </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="s2">                &lt;summary&gt;Data Transformations&lt;/summary&gt;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Transformer for y:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Transformer for exog:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="s2">                &lt;summary&gt;Training Information&lt;/summary&gt;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training range:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index type:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index frequency:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="s2">                &lt;summary&gt;Estimator Parameters&lt;/summary&gt;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="s2">                    </span><span class="si">{</span><span class="n">params</span><span class="si">}</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="s2">                &lt;summary&gt;Fit Kwargs&lt;/summary&gt;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="s2">                    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        Only sets __spotforecast_tags__ if not present, preserving custom tags.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__spotforecast_tags__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                    <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                    <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                    <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                    <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                    <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="p">}</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_lags</span><span class="p">(</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">train_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        Create lagged predictors and aligned target values.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            y: Target values used to build lag features. Expected shape is</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">                (n_samples,) or (n_samples, 1).</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            X_as_pandas: If True, returns lagged features as a pandas DataFrame.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            train_index: Index to use for the lagged feature DataFrame when</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">                `X_as_pandas` is True.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">                - X_data: Lagged predictors with shape (n_rows, n_lags) or None</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">                  if no lags are configured.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">                - y_data: Target values aligned to the lagged predictors with</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">                  shape (n_rows,).</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            ValueError: If `X_as_pandas` is True but `train_index` is not provided.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            ValueError: If the length of `y` is not sufficient to create the</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">                specified lags.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(lags=3)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">            &gt;&gt;&gt; y = np.arange(10)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            &gt;&gt;&gt; train_index = pd.RangeIndex(start=3, stop=10)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            &gt;&gt;&gt; X_data, y_data = forecaster._create_lags(y=y, X_as_pandas=True, train_index=train_index)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_data, pd.DataFrame)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">            True</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">            &gt;&gt;&gt; X_data.shape</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">            (7, 3)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            &gt;&gt;&gt; y_data.shape</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">            (7,)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">if</span> <span class="n">X_as_pandas</span> <span class="ow">and</span> <span class="n">train_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                <span class="s2">&quot;If `X_as_pandas` is True, `train_index` must be provided.&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>                <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>                <span class="sa">f</span><span class="s2">&quot;needed by the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>                <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>                <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="p">)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">X_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="c1"># y = y.ravel() # Assuming y is already raveled</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="c1"># Using stride_tricks for sliding window</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="n">y_strided</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">sliding_window_view</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">)[</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="p">:</span><span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="p">]</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="n">X_data</span> <span class="o">=</span> <span class="n">y_strided</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                <span class="n">X_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">X_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                <span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">y_data</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="k">return</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_window_features</span><span class="p">(</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">train_index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        Generate window features from the target series.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">            y: Target series used to compute window features. Must be a pandas</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">                Series with an index aligned to `train_index` after trimming.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">            train_index: Index for the training rows to align the window features.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            X_as_pandas: If True, keeps each window feature matrix as a pandas</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">                DataFrame; otherwise converts to NumPy arrays.</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">                - X_train_window_features: List of window feature matrices, one</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">                  per window feature transformer.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">                - X_train_window_features_names_out_: List of feature names for</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">                  all generated window features.</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            TypeError: If any window feature&#39;s `transform_batch` method does not</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">                return a pandas DataFrame.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            ValueError: If the output DataFrame from any window feature does not</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">                have the same number of rows as `train_index` or if the index</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">                does not match `train_index`.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            &gt;&gt;&gt; train_index = y.index[3:]  # Assuming window_size is 3</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            &gt;&gt;&gt; X_train_window_features, feature_names = forecaster._create_window_features(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            ...     y=y,</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            ...     train_index=train_index,</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            ...     X_as_pandas=True</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train_window_features[0], pd.DataFrame)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            True</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            &gt;&gt;&gt; X_train_window_features[0].shape[0] == len(train_index)</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            True</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            &gt;&gt;&gt; (X_train_window_features[0].index == train_index).all()</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            True</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">len_train_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_index</span><span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">X_train_window_features</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">transform_batch</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a pandas DataFrame.&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                <span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">len_train_index</span><span class="p">:]</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span> <span class="o">==</span> <span class="n">len_train_index</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same number of rows as &quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`: </span><span class="si">{</span><span class="n">len_train_index</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">train_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same index as &quot;</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                    <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`.&quot;</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="n">X_train_window_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">X_train_window_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">return</span> <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="p">]:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create training predictors and target values.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">                Optional exogenous variables for training. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">                Must have the same index as `y` and cover the same time range.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">                - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">                - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">                - X_train_features_names_out_: List of all predictor feature names.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">                - lags_names: List of lag feature names.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">                - window_features_names: List of window feature names.</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">                - exog_names_in_: List of exogenous variable names (if exogenous variables are used).</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">                - exog_dtypes_in_: Dictionary of input data types for exogenous variables.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">                - exog_dtypes_out_: Dictionary of output data types for exogenous variables after transformation (if exogenous variables are used).</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">            ValueError: If the length of `y` is not sufficient to create the specified lags and window features.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">            ValueError: If `exog` is provided but does not have the same index as `y` or does not cover the same time range.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">            ValueError: If `exog` is provided but contains data types that are not supported after transformation.</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">            &gt;&gt;&gt; (X_train, y_train, exog_names_in_, window_features_names,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            ...  exog_names_out, feature_names, exog_dtypes_in_,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">            ...  exog_dtypes_out_) = forecaster._create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            True</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">            True</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            &gt;&gt;&gt; feature_names == forecaster.lags_names + window_features_names + exog_names_out</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">            True</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="sa">f</span><span class="s2">&quot;needed by the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="sa">f</span><span class="s2">&quot;    Lags window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="sa">f</span><span class="s2">&quot;    Window features window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">fit_transformer</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">df</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">fit</span><span class="o">=</span><span class="n">fit_transformer</span><span class="p">,</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="p">)</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="n">y_values</span><span class="p">,</span> <span class="n">y_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="k">if</span> <span class="n">y_values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="n">y_values</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="n">train_index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                <span class="n">y_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                <span class="n">y_values</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">X_as_pandas</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`exog`&quot;</span><span class="p">,</span> <span class="n">ignore_freq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">len_y_original</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="n">len_train</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_index</span><span class="p">)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">len_exog</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_y_original</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_train</span><span class="p">:</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                    <span class="sa">f</span><span class="s2">&quot;Length mismatch for exogenous variables. Expected either:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                    <span class="sa">f</span><span class="s2">&quot;  - Full length matching `y`: </span><span class="si">{</span><span class="n">len_y_original</span><span class="si">}</span><span class="s2"> observations, OR</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                    <span class="sa">f</span><span class="s2">&quot;  - Pre-aligned length: </span><span class="si">{</span><span class="n">len_train</span><span class="si">}</span><span class="s2"> observations (y length - window_size)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                    <span class="sa">f</span><span class="s2">&quot;Got: </span><span class="si">{</span><span class="n">len_exog</span><span class="si">}</span><span class="s2"> observations.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                    <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="p">)</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="k">if</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_y_original</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span> <span class="o">==</span> <span class="n">y_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>                        <span class="s2">&quot;When `exog` has the same length as `y`, the index of &quot;</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                        <span class="s2">&quot;`exog` must be aligned with the index of `y` &quot;</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                        <span class="s2">&quot;to ensure the correct alignment of values.&quot;</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                    <span class="p">)</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="c1"># Standard case: exog covers full y range, trim by window_size</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span> <span class="o">==</span> <span class="n">train_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>                        <span class="s2">&quot;When `exog` already starts after the first `window_size` &quot;</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>                        <span class="s2">&quot;observations, its index must be aligned with the index &quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                        <span class="s2">&quot;of `y` starting from `window_size`.&quot;</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                    <span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="n">df</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                <span class="n">fit</span><span class="o">=</span><span class="n">fit_transformer</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>            <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>            <span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>            <span class="n">X_as_pandas</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>                <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="c1"># Create lags</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="c1"># Note: y_values might have NaNs from differentiation.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="c1"># TODO: check if _create_lags handles this!</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="n">X_train_lags</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_lags</span><span class="p">(</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="n">X_as_pandas</span><span class="p">,</span> <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="p">)</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="k">if</span> <span class="n">X_train_lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_lags</span><span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>            <span class="n">n_diff</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="n">y_vals_for_wf</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="n">y_index_for_wf</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="n">y_vals_for_wf</span> <span class="o">=</span> <span class="n">y_values</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                <span class="n">y_index_for_wf</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="n">y_window_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_vals_for_wf</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y_index_for_wf</span><span class="p">)</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_create_window_features</span><span class="p">(</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="n">y</span><span class="o">=</span><span class="n">y_window_features</span><span class="p">,</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                    <span class="n">X_as_pandas</span><span class="o">=</span><span class="n">X_as_pandas</span><span class="p">,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                    <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_window_features</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_exog_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">train_index</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>                <span class="n">data</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Public method to create training predictors and target values.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        This method is a public wrapper around the internal method `_create_train_X_y`,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        which generates the training predictors and target values based on the provided time series and exogenous variables.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">            y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            exog: Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">                - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            True</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            True</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="k">return</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_train_test_split_one_step_ahead</span><span class="p">(</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        Create matrices needed to train and test the forecaster for one-step-ahead</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        predictions.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">            initial_train_size: Initial size of the training set. It is the number of</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">                observations used to train the forecaster before making the first</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">                prediction.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">            exog: Exogenous variable/s included as predictor/s. Must have the same</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">                number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">                - X_train: Predictor values used to train the model as pandas DataFrame.</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">                - y_train: Target values related to each row of X_train as pandas Series.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">                - X_test: Predictor values used to test the model as pandas DataFrame.</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">                - y_test: Target values related to each row of X_test as pandas Series.</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train, X_test, y_test = forecaster._train_test_split_one_step_ahead(y=y, initial_train_size=20, exog=exog)</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            True</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            True</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_test, pd.DataFrame)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">            True</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_test, pd.Series)</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">            True</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="n">is_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">initial_train_size</span><span class="p">],</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">initial_train_size</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">test_init</span> <span class="o">=</span> <span class="n">initial_train_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_init</span><span class="p">:],</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_init</span><span class="p">:]</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="n">is_fitted</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        Get parameters for this forecaster.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            deep: If True, will return the parameters for this forecaster and</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">                contained sub-objects that are estimators.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">            params: Dictionary of parameter names mapped to their values.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            &gt;&gt;&gt; forecaster.get_params()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">            {</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">                &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">                &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">                &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>            <span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>            <span class="s2">&quot;lags&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>            <span class="s2">&quot;window_features&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>            <span class="s2">&quot;transformer_y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>            <span class="s2">&quot;transformer_exog&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>            <span class="s2">&quot;weight_func&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="s2">&quot;differentiation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="s2">&quot;fit_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>            <span class="s2">&quot;binner_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>            <span class="s2">&quot;forecaster_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>        <span class="p">]:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">deep</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>            <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimator&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                    <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;estimator__</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        Set the parameters of this forecaster.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            params: Optional dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">                If provided, these parameters are set first.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            **kwargs: Dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">                Parameters can be for the forecaster itself or for the contained estimator (using the `estimator__` prefix).</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">            self: The forecaster instance with updated parameters.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_params(estimator__fit_intercept=False)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            &gt;&gt;&gt; forecaster.estimator.get_params()[&quot;fit_intercept&quot;]</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            False</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>        <span class="c1"># Merge params dict and kwargs</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="n">all_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_params</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>            <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="n">valid_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="n">nested_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">all_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_params</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                <span class="c1"># Relaxed check for now</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>            <span class="k">if</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>                <span class="n">obj_name</span><span class="p">,</span> <span class="n">param_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>                <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="p">:</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>                    <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>                <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>        <span class="k">for</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">obj_params</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">):</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>                <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;set_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                    <span class="n">obj</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">obj_params</span><span class="p">)</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>                    <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                        <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>        <span class="n">store_last_window</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">        Fit the forecaster to the training data.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            y:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">                  Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                  Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            store_last_window:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">                  Whether to store the last window of the training series for use in prediction. Defaults to True.</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            store_in_sample_residuals:</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">                  Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">                  Random seed for reproducibility when sampling residuals if `store_in_sample_residuals` is True. Defaults to 123.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            suppress_warnings:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">                  Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            None</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                 &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">                 &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                 &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">                 &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">                 &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">                 &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">                 &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">                 &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">                 ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">                 ...     lags=3,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">                 ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">                 ... )</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">                 &gt;&gt;&gt; forecaster.fit(y=y, exog=exog, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>        <span class="p">(</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>            <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>            <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>            <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                <span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>            <span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">exog_dtypes_in_</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">exog_dtypes_out_</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog_names_out_</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>                <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="p">)</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>        <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>                <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>                <span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>            <span class="p">)</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>        <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sample_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        Create weights for each observation according to the forecaster&#39;s attribute</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        `weight_func`.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            X_train: Dataframe created with the `create_train_X_y` method, first return.</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            Weights to use in `fit` method.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>            <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot have NaN values.&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>                <span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sample_weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot have negative values.&quot;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>                <span class="p">)</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot be normalized because &quot;</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>                    <span class="s2">&quot;the sum of the weights is zero.&quot;</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>                <span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="k">return</span> <span class="n">sample_weight</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="n">predict_probabilistic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">        Create the inputs needed for the first iteration of the prediction</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">        process. As this is a recursive process, the last window is updated at</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">        each iteration of the prediction process.</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            steps: Number of steps to predict.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">            last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">                right after training data.</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">            exog: Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">            predict_probabilistic: If `True`, the necessary checks for probabilistic predictions will be</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">                performed.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">            use_in_sample_residuals: If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">                `set_out_sample_residuals()` method.</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">            use_binned_residuals: If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">                If `False`, residuals are selected randomly.</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">            check_inputs: If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">                with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">                for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            - last_window_values:</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">                Numpy array of the last window values to use for prediction,</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">                transformed and ready for input into the prediction method.</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">            - exog_values:</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">                Numpy array of exogenous variable values for prediction,</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">                transformed and ready for input into the prediction method,</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">                or None if no exogenous variables are used.</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            - prediction_index:</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">                Pandas Index for the predicted values, constructed based on the</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">                last window index and the number of steps to predict.</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            - steps:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">                Number of future steps predicted.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>            <span class="n">steps</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>                <span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>                <span class="n">date_input</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>                <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>            <span class="p">)</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>        <span class="k">if</span> <span class="n">check_inputs</span><span class="p">:</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>            <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>                <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>                <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>                <span class="n">exog_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">,</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>                <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>                <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>                <span class="n">last_window_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>                <span class="n">exog_names_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>                <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>            <span class="p">)</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>            <span class="k">if</span> <span class="n">predict_probabilistic</span><span class="p">:</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>                <span class="n">check_residuals_input</span><span class="p">(</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                    <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>                    <span class="n">in_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>                    <span class="n">out_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>                    <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>                    <span class="n">in_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>                    <span class="n">out_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>                <span class="p">)</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>            <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>        <span class="p">)</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>            <span class="n">array</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>        <span class="p">)</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>            <span class="n">last_window_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">)</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>            <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">:</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">]</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>                <span class="n">df</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>            <span class="p">)</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">:</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>                <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>                <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>            <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>            <span class="n">exog_values</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>                <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>                <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>                <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>                <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>                <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>                <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>                <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>            <span class="p">)</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>        <span class="k">return</span> <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>        <span class="n">last_window_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>        <span class="n">exog_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        Predict n steps ahead. It is an iterative process in which, each prediction,</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">        is used as a predictor for the next step.</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">            last_window_values:</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">                Series values used to create the predictors needed in the first</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">                iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">            exog_values:</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><span class="sd">                Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">            Predicted values.</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>        <span class="n">original_device</span> <span class="o">=</span> <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>        <span class="n">n_lags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>        <span class="n">n_window_features</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>            <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>        <span class="p">)</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>        <span class="n">n_exog</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="o">+</span> <span class="n">n_exog</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>        <span class="p">)</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>        <span class="n">estimator_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>        <span class="n">is_linear</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">LinearModel</span><span class="p">)</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="n">is_lightgbm</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;LGBMRegressor&quot;</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>        <span class="n">is_xgboost</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;XGBRegressor&quot;</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>        <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>            <span class="n">coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">intercept_</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>        <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">booster_</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_booster</span><span class="p">()</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>        <span class="n">has_lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>        <span class="n">has_window_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="n">has_exog</span> <span class="o">=</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>            <span class="k">if</span> <span class="n">has_lags</span><span class="p">:</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>                <span class="n">X</span><span class="p">[:</span><span class="n">n_lags</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>            <span class="k">if</span> <span class="n">has_window_features</span><span class="p">:</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>                <span class="n">window_data</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>                <span class="n">X</span><span class="p">[</span><span class="n">n_lags</span> <span class="p">:</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>                    <span class="p">[</span><span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">window_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">]</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>                <span class="p">)</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>            <span class="k">if</span> <span class="n">has_exog</span><span class="p">:</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>                <span class="n">X</span><span class="p">[</span><span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>            <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>            <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>            <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">inplace_predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>            <span class="c1"># Update `last_window` values. The first position is discarded and</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>            <span class="c1"># the new prediction is added at the end.</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>            <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>        <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">original_device</span><span class="p">)</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>        <span class="n">last_window_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>        <span class="n">sampled_residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>        <span class="n">exog_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">        Vectorized bootstrap prediction - predict all n_boot iterations per step.</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">        Instead of running n_boot sequential predictions, this method predicts</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">        all bootstrap samples at once per step, significantly reducing overhead.</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">            last_window_values:</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">                Series values used to create the predictors needed in the first</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">                iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><span class="sd">            sampled_residuals:</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><span class="sd">                Pre-sampled residuals for all bootstrap iterations.</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">                - If `use_binned_residuals=True`: 3D array of shape (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">                - If `use_binned_residuals=False`: 2D array of shape (steps, n_boot)</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">                If `True`, residuals are selected based on the predicted values.</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">                If `False`, residuals are selected randomly.</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">                Number of bootstrap iterations.</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">            exog_values:</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">            Numpy ndarray with the predicted values. Shape (steps, n_boot).</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">                If `sampled_residuals` does not match the expected shape/dimensions.</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">            IndexError:</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">                If `last_window_values` or `exog_values` are not of expected lengths.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=2)</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=pd.Series(np.arange(10)))</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">            &gt;&gt;&gt; last_window = np.array([8, 9])</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">            &gt;&gt;&gt; residuals = np.random.normal(size=(3, 5)) # 3 steps, 5 boots</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">            &gt;&gt;&gt; preds = forecaster._recursive_predict_bootstrapping(</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">            ...     steps=3,</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">            ...     last_window_values=last_window,</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">            ...     sampled_residuals=residuals,</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">            ...     use_binned_residuals=False,</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">            ...     n_boot=5</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">            &gt;&gt;&gt; preds.shape</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">            (3, 5)</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>        <span class="n">original_device</span> <span class="o">=</span> <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>        <span class="n">n_lags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>        <span class="n">n_window_features</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>            <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>        <span class="p">)</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>        <span class="n">n_exog</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="o">+</span> <span class="n">n_exog</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>        <span class="c1"># Input matrix for prediction: shape (n_boot, n_features)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_boot</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>        <span class="c1"># Output predictions: shape (steps, n_boot)</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>        <span class="c1"># Expand last_window to 2D: (window_size + steps, n_boot)</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>        <span class="c1"># Each column represents a separate bootstrap trajectory</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">last_window</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)])</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>        <span class="n">estimator_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>        <span class="n">is_linear</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">LinearModel</span><span class="p">)</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="n">is_lightgbm</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;LGBMRegressor&quot;</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="n">is_xgboost</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;XGBRegressor&quot;</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">intercept_</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>        <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">booster_</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_booster</span><span class="p">()</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>        <span class="n">has_lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="n">has_window_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>        <span class="n">has_exog</span> <span class="o">=</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>            <span class="k">if</span> <span class="n">has_lags</span><span class="p">:</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">):</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>                    <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">lag</span> <span class="o">+</span> <span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>            <span class="k">if</span> <span class="n">has_window_features</span><span class="p">:</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>                <span class="n">window_data</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>                <span class="c1"># transform accepts 2D: (window_length, n_boot) -&gt; (n_boot, n_stats)</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>                <span class="c1"># and concatenate along axis=1: (n_boot, total_window_features)</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>                <span class="n">X</span><span class="p">[:,</span> <span class="n">n_lags</span> <span class="p">:</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>                    <span class="p">[</span><span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">window_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>                <span class="p">)</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>            <span class="k">if</span> <span class="n">has_exog</span><span class="p">:</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>                <span class="n">X</span><span class="p">[:,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>            <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>            <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>            <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">inplace_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>            <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                <span class="c1"># sampled_residuals is a 3D array: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>                <span class="n">boot_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>                <span class="n">pred_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>                <span class="n">pred</span> <span class="o">+=</span> <span class="n">sampled_residuals</span><span class="p">[</span><span class="n">pred_bins</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">boot_indices</span><span class="p">]</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>                <span class="n">pred</span> <span class="o">+=</span> <span class="n">sampled_residuals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>            <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>        <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">original_device</span><span class="p">)</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_predict_X</span><span class="p">(</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">        Create the predictors needed to predict `steps` ahead. As it is a recursive</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">        process, the predictors are created at each iteration of the prediction</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">        process.</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">            check_inputs:</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">                If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">                with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">                for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">                Defaults to True.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">            Pandas DataFrame with the predictors for each step. The index</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">            is the same as the prediction index.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>        <span class="p">(</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>            <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>            <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>            <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>            <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>        <span class="p">)</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>            <span class="p">)</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>            <span class="p">)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>        <span class="n">X_predict</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>        <span class="n">full_predictors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>            <span class="n">X_lags</span> <span class="o">=</span> <span class="n">full_predictors</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">)]</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_lags</span><span class="p">)</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>            <span class="n">X_window_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>                <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)),</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>                <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>                <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>                <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>            <span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>                <span class="n">X_window_features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>                    <span class="p">[</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                        <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)])</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                    <span class="p">]</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>                <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_window_features</span><span class="p">)</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>        <span class="n">X_predict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_predict</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>        <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>            <span class="n">categorical_features</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>                <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>                <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>                <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>            <span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>            <span class="k">if</span> <span class="n">categorical_features</span><span class="p">:</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>                <span class="n">X_predict</span> <span class="o">=</span> <span class="n">X_predict</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">)</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>                <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>                <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>                <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>            <span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="k">return</span> <span class="n">X_predict</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">        Predict future values recursively for the specified number of steps.</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">                Number of future steps to predict.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">                Optional last window of observed values to use for prediction. If None, uses the last window from training.</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">                Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">                Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">                Must have the same structure as the exogenous variables used in training. Defaults to None.</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">            check_inputs:</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">                Whether to perform input validation checks. Defaults to True.</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">            Pandas Series of predicted values for the specified number of steps,</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">            indexed according to the prediction index constructed from the last window and the number of steps.</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=y, exog=exog)</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">            &gt;&gt;&gt; last_window = y.iloc[-3:]</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">            &gt;&gt;&gt; exog_future = pd.DataFrame({&#39;temp&#39;: np.random.randn(5)}, index=pd.RangeIndex(start=30, stop=35))</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">            &gt;&gt;&gt; predictions = forecaster.predict(</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">            ...     steps=5, last_window=last_window, exog=exog_future, check_inputs=True</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">            &gt;&gt;&gt; isinstance(predictions, pd.Series)</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">            True</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>        <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>                <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>            <span class="p">)</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>        <span class="p">)</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>            <span class="p">)</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>            <span class="p">)</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>            <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>        <span class="p">)</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">        Generate multiple forecasting predictions using a bootstrapping process.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">        By sampling from a collection of past observed errors (the residuals),</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">        each iteration of bootstrapping generates a different set of predictions.</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">        See the References section for more information.</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">                Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">                intervals. Defaults to 250.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">                Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">            Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">                If `steps` is not an integer or a valid date.</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">                If `exog` is missing or has invalid shape.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">                If `n_boot` is not a positive integer.</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><span class="sd">                If `use_in_sample_residuals=True` and `in_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">                If `use_in_sample_residuals=False` and `out_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="sd">            &gt;&gt;&gt; boot_preds = forecaster.predict_bootstrapping(steps=3, n_boot=5)</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">            &gt;&gt;&gt; boot_preds.shape</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">            (3, 5)</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">        References:</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">            .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">                   https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>        <span class="p">(</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>            <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>            <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>            <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>            <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>            <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>        <span class="p">)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>        <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>            <span class="c1"># Create 3D array with sampled residuals: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>            <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">)</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>            <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>                <span class="p">[</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>                    <span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">][</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>                        <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>                            <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>                    <span class="p">]</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">)</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>                <span class="p">],</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>            <span class="p">)</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>            <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>                <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>            <span class="p">]</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>            <span class="p">)</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                <span class="n">sampled_residuals</span><span class="o">=</span><span class="n">sampled_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>                <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>            <span class="p">)</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>                <span class="n">boot_predictions</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>            <span class="p">)</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>                <span class="n">array</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>            <span class="p">)</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>        <span class="n">boot_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)]</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>            <span class="n">data</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">boot_columns</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>        <span class="p">)</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>        <span class="k">return</span> <span class="n">boot_predictions</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>        <span class="n">nominal_coverage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a><span class="sd">        Generate prediction intervals using the conformal prediction</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a><span class="sd">        split method [1]_.</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">                If `last_window = None`, the values stored in` self.last_window_` are</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">            nominal_coverage:</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a><span class="sd">                Nominal coverage, also known as expected coverage, of the prediction</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><span class="sd">                intervals. Must be between 0 and 1. Defaults to 0.95.</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><span class="sd">            Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a><span class="sd">            - pred: predictions.</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="sd">            - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="sd">            - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">                If `nominal_coverage` is not between 0 and 1.</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">                If inputs are invalid (checked by `_create_predict_inputs`).</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">            &gt;&gt;&gt; # Internal method, typically used via predict_interval(method=&#39;conformal&#39;)</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">            &gt;&gt;&gt; preds = forecaster._predict_interval_conformal(steps=3, nominal_coverage=0.9)</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">            &gt;&gt;&gt; preds.columns.tolist()</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">        References:</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">            .. [1] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">                   https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>        <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>                <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>                <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>            <span class="p">)</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>        <span class="p">)</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>        <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>            <span class="p">)</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>            <span class="p">)</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>            <span class="c1"># Fallback to global residuals if bin is empty</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>                <span class="n">global_cf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>                <span class="n">global_cf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>            <span class="n">correction_factor_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>                    <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>                        <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">nominal_coverage</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>                    <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">global_cf</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>            <span class="n">replace_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">correction_factor_by_bin</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">global_cf</span><span class="p">)</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>            <span class="p">)</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>            <span class="n">predictions_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">replace_func</span><span class="p">(</span><span class="n">predictions_bin</span><span class="p">)</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">-</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">+</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">predictions</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">])</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>                <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>            <span class="p">)</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>            <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">],</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>        <span class="p">)</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>        <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><span class="sd">        Predict n steps ahead and estimate prediction intervals using either</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="sd">        bootstrapping or conformal prediction methods. Refer to the References</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="sd">        section for additional details on these methods.</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">            method:</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">                Technique used to estimate prediction intervals. Available options:</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">                - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">                  intervals [1]_.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">                - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">                  interval estimation [2]_.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">                Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">            interval:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">                Confidence level of the prediction interval. Interpretation depends</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">                on the method used:</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">                - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">                  and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">                  percentiles.</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">                - If `list` or `tuple`, defines the exact percentiles to compute, which</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="sd">                  must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">                  of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">                - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="sd">                  a list/tuple defining a symmetric interval.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">                Defaults to [5, 95].</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">                Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">                intervals. Defaults to 250.</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">                Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="sd">            Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">            - pred: predictions.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">            - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">            - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">                If `method` is not &#39;bootstrapping&#39; or &#39;conformal&#39;.</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">                 If `interval` is invalid or not compatible with the chosen method.</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">                If inputs (`steps`, `exog`, etc.) are invalid.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">            &gt;&gt;&gt; # Bootstrapping method</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><span class="sd">            &gt;&gt;&gt; intervals_boot = forecaster.predict_interval(</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="sd">            ...     steps=3, method=&#39;bootstrapping&#39;, interval=[5, 95]</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">            &gt;&gt;&gt; intervals_boot.columns.tolist()</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">            &gt;&gt;&gt; # Conformal method</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">            &gt;&gt;&gt; intervals_conf = forecaster.predict_interval(</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">            ...     steps=3, method=&#39;conformal&#39;, interval=0.95</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">            &gt;&gt;&gt; intervals_conf.columns.tolist()</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="sd">        References:</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">            .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">                   https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="sd">            .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">                   https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>                <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>            <span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>            <span class="p">)</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>            <span class="n">predictions_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>                <span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>            <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>            <span class="n">predictions_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions_interval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>                <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>                <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>                <span class="n">nominal_coverage</span><span class="o">=</span><span class="n">nominal_coverage</span><span class="p">,</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>            <span class="p">)</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid `method` &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Choose &#39;bootstrapping&#39; or &#39;conformal&#39;.&quot;</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>            <span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">        Bin residuals according to the predicted value each residual is</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><span class="sd">        associated with. First a `skforecast.preprocessing.QuantileBinner` object</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">        is fitted to the predicted values. Then, residuals are binned according</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">        to the predicted value each residual is associated with. Residuals are</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="sd">        stored in the forecaster object as `in_sample_residuals_` and</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="sd">        `in_sample_residuals_by_bin_`.</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="sd">        `y_true` and `y_pred` assumed to be differentiated and or transformed</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><span class="sd">        according to the attributes `differentiation` and `transformer_y`.</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><span class="sd">        The number of residuals stored per bin is limited to</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><span class="sd">        `10_000 // self.binner.n_bins_`. The total number of residuals stored is</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="sd">        `10_000`.</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="sd">            y_true: True values of the time series.</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="sd">            y_pred: Predicted values of the time series.</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="sd">            store_in_sample_residuals: If `True`, in-sample residuals will be stored in the forecaster object</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a><span class="sd">                after fitting (`in_sample_residuals_` and `in_sample_residuals_by_bin_`</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="sd">                attributes). If `False`, only the intervals of the bins are stored.</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">            random_state: Set a seed for the random generator so that the stored sample</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><span class="sd">                residuals are always deterministic.</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">})</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">intervals_</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>        <span class="k">if</span> <span class="n">store_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>                    <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>                <span class="p">)</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>                <span class="n">max_sample</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins_</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_sample</span><span class="p">:</span>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a>                        <span class="n">sample</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">max_sample</span><span class="p">)]</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000</span><span class="p">:</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>                    <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>                <span class="p">]</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="sd">        Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="sd">        training process.</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>                <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="p">)</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>        <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>            <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>        <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>                <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>                <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>                <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>                <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>                <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>            <span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>        <span class="p">(</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>            <span class="o">*</span><span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">X_train_features_names_out_</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">:</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>                <span class="sa">f</span><span class="s2">&quot;Feature mismatch detected after matrix creation. The features &quot;</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>                <span class="sa">f</span><span class="s2">&quot;generated from the provided data do not match those used during &quot;</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                <span class="sa">f</span><span class="s2">&quot;the training process. To correctly set in-sample residuals, &quot;</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>                <span class="sa">f</span><span class="s2">&quot;ensure that the same data and preprocessing steps are applied.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>                <span class="sa">f</span><span class="s2">&quot;    Expected output : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>                <span class="sa">f</span><span class="s2">&quot;    Current output  : </span><span class="si">{</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="p">)</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>        <span class="p">)</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>        <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><span class="sd">        Set new values to the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>                <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>            <span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>            <span class="p">)</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>                <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>            <span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>            <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>                <span class="n">array</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>            <span class="p">)</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>                <span class="n">array</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>            <span class="p">)</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>            <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>            <span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>            <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>        <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>                <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>            <span class="p">)</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>        <span class="p">)</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>            <span class="p">{}</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>        <span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>                        <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>            <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>            <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>                        <span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>            <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>                <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>            <span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>            <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>                <span class="n">k</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>            <span class="p">]</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>            <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>                    <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>                    <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>                    <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>                    <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>                <span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>                <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>                        <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when a ForecasterRecursive object is printed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of the forecaster with key information about its configuration and state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">=========================</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">ForecasterRecursive</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">=========================</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">Estimator: LinearRegression</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">Lags: [1, 2, 3]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">Window features: []</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">Window size: 3</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">Series name: None</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">Exogenous included: False</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Exogenous names: None</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">Transformer for y: None</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">Transformer for exog: None</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">Weight function included: False</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">Differentiation order: None</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">Training range: None</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">Training index type: None</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">Training index frequency: None</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">Estimator parameters: {...}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">fit_kwargs: {...}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">Creation date: ...</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">Last fit date: None</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">spotforecast version: ...</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">Python version: ...</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">Forecaster id: None</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    Information displayed when a ForecasterRecursive object is printed.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        str: String representation of the forecaster with key information about its configuration and state.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        &gt;&gt;&gt; print(forecaster)  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        =========================</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        ForecasterRecursive</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        =========================</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        Estimator: LinearRegression</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Lags: [1, 2, 3]</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        Window features: []</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Window size: 3</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        Series name: None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        Exogenous included: False</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Exogenous names: None</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        Transformer for y: None</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Transformer for exog: None</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        Weight function included: False</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        Differentiation order: None</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        Training range: None</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Training index type: None</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        Training index frequency: None</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Estimator parameters: {...}</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        fit_kwargs: {...}</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Creation date: ...</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Last fit date: None</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        spotforecast version: ...</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Python version: ...</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        Forecaster id: None</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="sa">f</span><span class="s2">&quot;Estimator: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="sa">f</span><span class="s2">&quot;Lags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="sa">f</span><span class="s2">&quot;Window features: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="sa">f</span><span class="s2">&quot;Exogenous included: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="sa">f</span><span class="s2">&quot;Exogenous names: </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="sa">f</span><span class="s2">&quot;Transformer for y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="sa">f</span><span class="s2">&quot;Transformer for exog: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="sa">f</span><span class="s2">&quot;Weight function included: </span><span class="si">{</span><span class="kc">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">False</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation order: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="sa">f</span><span class="s2">&quot;Estimator parameters: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="sa">f</span><span class="s2">&quot;fit_kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Custom <strong>setstate</strong> to ensure backward compatibility when unpickling.
Only sets <strong>spotforecast_tags</strong> if not present, preserving custom tags.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    Only sets __spotforecast_tags__ if not present, preserving custom tags.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__spotforecast_tags__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.create_predict_X" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_predict_X</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create the predictors needed to predict <code>steps</code> ahead. As it is a recursive
process, the predictors are created at each iteration of the prediction
process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_inputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the input is checked for possible warnings and errors
with the <code>check_predict_input</code> function. This argument is created
for internal use and is not recommended to be changed.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with the predictors for each step. The index</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is the same as the prediction index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_predict_X</span><span class="p">(</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">    Create the predictors needed to predict `steps` ahead. As it is a recursive</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">    process, the predictors are created at each iteration of the prediction</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">    process.</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">        check_inputs:</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">            If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">            with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">            for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">        Pandas DataFrame with the predictors for each step. The index</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">        is the same as the prediction index.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>    <span class="p">(</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>        <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>        <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>        <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>        <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>        <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>    <span class="p">)</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>        <span class="p">)</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>        <span class="p">)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>    <span class="n">X_predict</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>    <span class="n">full_predictors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>        <span class="n">X_lags</span> <span class="o">=</span> <span class="n">full_predictors</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">)]</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_lags</span><span class="p">)</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="n">X_window_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)),</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>            <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>            <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="n">X_window_features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>                <span class="p">[</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                    <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)])</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                    <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                <span class="p">]</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_window_features</span><span class="p">)</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>    <span class="n">X_predict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_predict</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>        <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>        <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>    <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>            <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>            <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>            <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>        <span class="k">if</span> <span class="n">categorical_features</span><span class="p">:</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>            <span class="n">X_predict</span> <span class="o">=</span> <span class="n">X_predict</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">)</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>            <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>            <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>            <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>            <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>            <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>        <span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>    <span class="k">return</span> <span class="n">X_predict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.create_sample_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create weights for each observation according to the forecaster's attribute
<code>weight_func</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_train</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe created with the <code>create_train_X_y</code> method, first return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights to use in <code>fit</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_sample_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    Create weights for each observation according to the forecaster&#39;s attribute</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">    `weight_func`.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        X_train: Dataframe created with the `create_train_X_y` method, first return.</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        Weights to use in `fit` method.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot have NaN values.&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>            <span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sample_weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot have negative values.&quot;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>            <span class="p">)</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot be normalized because &quot;</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>                <span class="s2">&quot;the sum of the weights is zero.&quot;</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>            <span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="k">return</span> <span class="n">sample_weight</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.create_train_X_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Public method to create training predictors and target values.</p>
<p>This method is a public wrapper around the internal method <code>_create_train_X_y</code>,
which generates the training predictors and target values based on the provided time series and exogenous variables.
It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target series for training. Must be a pandas Series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as <code>y</code> and cover the same time range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing:
- X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).
- y_train: Series of target values aligned with the predictors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">True</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Public method to create training predictors and target values.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">    This method is a public wrapper around the internal method `_create_train_X_y`,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    which generates the training predictors and target values based on the provided time series and exogenous variables.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        exog: Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        Tuple containing:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        ...     lags=3,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        True</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        True</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="k">return</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_last_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the forecaster to the training data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target series for training. Must be a pandas Series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as <code>y</code> and cover the same time range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store_last_window</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to store the last window of the training series for use in prediction. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility when sampling residuals if <code>store_in_sample_residuals</code> is True. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>    <span class="n">store_last_window</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">    Fit the forecaster to the training data.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        y:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">              Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">              Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        store_last_window:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">              Whether to store the last window of the training series for use in prediction. Defaults to True.</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        store_in_sample_residuals:</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">              Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">              Random seed for reproducibility when sampling residuals if `store_in_sample_residuals` is True. Defaults to 123.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">        suppress_warnings:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">              Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        None</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">             &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">             &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">             &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">             &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">             &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">             &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">             &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">             &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">             ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">             ...     lags=3,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">             ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">             ... )</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">             &gt;&gt;&gt; forecaster.fit(y=y, exog=exog, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="p">(</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>        <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>        <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>            <span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>            <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">exog_dtypes_in_</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">exog_dtypes_out_</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog_names_out_</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>    <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>            <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>        <span class="p">)</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>    <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>            <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>            <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>            <span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>        <span class="p">)</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.get_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get parameters for this forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>deep</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will return the parameters for this forecaster and
contained sub-objects that are estimators.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>params</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of parameter names mapped to their values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">    &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">    &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">    &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">    Get parameters for this forecaster.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">        deep: If True, will return the parameters for this forecaster and</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            contained sub-objects that are estimators.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        params: Dictionary of parameter names mapped to their values.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        &gt;&gt;&gt; forecaster.get_params()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        {</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">            &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">            &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="s2">&quot;lags&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="s2">&quot;window_features&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="s2">&quot;transformer_y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="s2">&quot;transformer_exog&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="s2">&quot;weight_func&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="s2">&quot;differentiation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="s2">&quot;fit_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="s2">&quot;binner_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="s2">&quot;forecaster_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="p">]:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">deep</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimator&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;estimator__</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict future values recursively for the specified number of steps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional last window of observed values to use for prediction. If None, uses the last window from training.
Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.
Must have the same structure as the exogenous variables used in training. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_inputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to perform input validation checks. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas Series of predicted values for the specified number of steps,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indexed according to the prediction index constructed from the last window and the number of steps.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">last_window</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_future</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">35</span><span class="p">))</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog_future</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">    Predict future values recursively for the specified number of steps.</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">            Number of future steps to predict.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">            Optional last window of observed values to use for prediction. If None, uses the last window from training.</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">            Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">            Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">            Must have the same structure as the exogenous variables used in training. Defaults to None.</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">        check_inputs:</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">            Whether to perform input validation checks. Defaults to True.</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">        Pandas Series of predicted values for the specified number of steps,</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">        indexed according to the prediction index constructed from the last window and the number of steps.</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">        ...     lags=3,</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=y, exog=exog)</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">        &gt;&gt;&gt; last_window = y.iloc[-3:]</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">        &gt;&gt;&gt; exog_future = pd.DataFrame({&#39;temp&#39;: np.random.randn(5)}, index=pd.RangeIndex(start=30, stop=35))</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">        ...     steps=5, last_window=last_window, exog=exog_future, check_inputs=True</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">        &gt;&gt;&gt; isinstance(predictions, pd.Series)</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">        True</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>    <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>        <span class="p">)</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>    <span class="p">)</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>        <span class="p">)</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>        <span class="p">)</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>        <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>        <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>        <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>        <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>    <span class="p">)</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.predict_bootstrapping" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_bootstrapping</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate multiple forecasting predictions using a bootstrapping process.
By sampling from a collection of past observed errors (the residuals),
each iteration of bootstrapping generates a different set of predictions.
See the References section for more information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values
(binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>steps</code> is not an integer or a valid date.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>exog</code> is missing or has invalid shape.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>n_boot</code> is not a positive integer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>use_in_sample_residuals=True</code> and <code>in_sample_residuals_</code> are not available.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>use_in_sample_residuals=False</code> and <code>out_sample_residuals_</code> are not available.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">boot_preds</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">boot_preds</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">(3, 5)</span>
</code></pre></div>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.
       https://otexts.com/fpp3/prediction-intervals.html</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">    Generate multiple forecasting predictions using a bootstrapping process.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">    By sampling from a collection of past observed errors (the residuals),</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">    each iteration of bootstrapping generates a different set of predictions.</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">    See the References section for more information.</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">        n_boot:</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">            Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">            intervals. Defaults to 250.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">        use_in_sample_residuals:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">            If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">            prediction error to create predictions.</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">        use_binned_residuals:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">            If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">            (binned selection).</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">            Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">        Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">            If `steps` is not an integer or a valid date.</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">            If `exog` is missing or has invalid shape.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">            If `n_boot` is not a positive integer.</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><span class="sd">            If `use_in_sample_residuals=True` and `in_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">            If `use_in_sample_residuals=False` and `out_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><span class="sd">        &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="sd">        &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="sd">        &gt;&gt;&gt; boot_preds = forecaster.predict_bootstrapping(steps=3, n_boot=5)</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">        &gt;&gt;&gt; boot_preds.shape</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">        (3, 5)</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">    References:</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">        .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">               https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>    <span class="p">(</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>        <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>        <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>        <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>        <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>        <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>        <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>        <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>        <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>    <span class="p">)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>    <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>    <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>        <span class="c1"># Create 3D array with sampled residuals: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>        <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">)</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>        <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>            <span class="p">[</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>                <span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">][</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>                    <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>                        <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>                <span class="p">]</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">)</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>            <span class="p">],</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>        <span class="p">)</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>        <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>            <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>        <span class="p">]</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>        <span class="p">)</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>            <span class="n">sampled_residuals</span><span class="o">=</span><span class="n">sampled_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>            <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>        <span class="p">)</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>            <span class="n">boot_predictions</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>        <span class="p">)</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>            <span class="n">array</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>        <span class="p">)</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>    <span class="n">boot_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)]</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="n">data</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">boot_columns</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>    <span class="p">)</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>    <span class="k">return</span> <span class="n">boot_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.predict_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_interval</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead and estimate prediction intervals using either
bootstrapping or conformal prediction methods. Refer to the References
section for additional details on these methods.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:
- 'bootstrapping': Bootstrapping is used to generate prediction
  intervals [1]<em>.
- 'conformal': Employs the conformal prediction split method for
  interval estimation [2]</em>.
Defaults to 'bootstrapping'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="list">list</span>[<span title="float">float</span>] | <span title="tuple">tuple</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level of the prediction interval. Interpretation depends
on the method used:
- If <code>float</code>, represents the nominal (expected) coverage (between 0
  and 1). For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code>
  percentiles.
- If <code>list</code> or <code>tuple</code>, defines the exact percentiles to compute, which
  must be between 0 and 100 inclusive. For example, interval
  of 95% should be as <code>interval = [2.5, 97.5]</code>.
- When using <code>method='conformal'</code>, the interval must be a float or
  a list/tuple defining a symmetric interval.
Defaults to [5, 95].</p>
              </div>
            </td>
            <td>
                  <code>[5, 95]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values
(binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with values predicted by the forecaster and their estimated interval.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>pred: predictions.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>lower_bound: lower bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>method</code> is not 'bootstrapping' or 'conformal'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>interval</code> is invalid or not compatible with the chosen method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs (<code>steps</code>, <code>exog</code>, etc.) are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bootstrapping method</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_boot</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_boot</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">[&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Conformal method</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_conf</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conformal&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.95</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_conf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
</code></pre></div>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.
       https://otexts.com/fpp3/prediction-intervals.html
.. [2] MAPIE - Model Agnostic Prediction Interval Estimator.
       https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><span class="sd">    Predict n steps ahead and estimate prediction intervals using either</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="sd">    bootstrapping or conformal prediction methods. Refer to the References</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="sd">    section for additional details on these methods.</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">        method:</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">            Technique used to estimate prediction intervals. Available options:</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">            - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">              intervals [1]_.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">              interval estimation [2]_.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">            Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">        interval:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">            Confidence level of the prediction interval. Interpretation depends</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">            on the method used:</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">              and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">              percentiles.</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">            - If `list` or `tuple`, defines the exact percentiles to compute, which</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="sd">              must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">              of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">            - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="sd">              a list/tuple defining a symmetric interval.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">            Defaults to [5, 95].</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">        n_boot:</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">            Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">            intervals. Defaults to 250.</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">        use_in_sample_residuals:</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="sd">            If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">            prediction error to create predictions.</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        use_binned_residuals:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">            If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">            (binned selection).</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">            Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="sd">        Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">        - pred: predictions.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">        - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">        - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">            If `method` is not &#39;bootstrapping&#39; or &#39;conformal&#39;.</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">             If `interval` is invalid or not compatible with the chosen method.</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">            If inputs (`steps`, `exog`, etc.) are invalid.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">        &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">        &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">        &gt;&gt;&gt; # Bootstrapping method</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><span class="sd">        &gt;&gt;&gt; intervals_boot = forecaster.predict_interval(</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="sd">        ...     steps=3, method=&#39;bootstrapping&#39;, interval=[5, 95]</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">        &gt;&gt;&gt; intervals_boot.columns.tolist()</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">        [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">        &gt;&gt;&gt; # Conformal method</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">        &gt;&gt;&gt; intervals_conf = forecaster.predict_interval(</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">        ...     steps=3, method=&#39;conformal&#39;, interval=0.95</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">        &gt;&gt;&gt; intervals_conf.columns.tolist()</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">        [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="sd">    References:</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">        .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">               https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="sd">        .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">               https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>            <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>            <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>            <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>        <span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>        <span class="p">)</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>        <span class="n">predictions_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>            <span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>        <span class="n">predictions_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions_interval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>            <span class="n">nominal_coverage</span><span class="o">=</span><span class="n">nominal_coverage</span><span class="p">,</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>        <span class="p">)</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid `method` &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Choose &#39;bootstrapping&#39; or &#39;conformal&#39;.&quot;</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>        <span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.set_in_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_in_sample_residuals</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set in-sample residuals in case they were not calculated during the
training process.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="sd">    Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="sd">    training process.</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>            <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>        <span class="p">)</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>    <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>    <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>        <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>    <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>            <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>            <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>            <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>            <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>            <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>    <span class="p">(</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>        <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>        <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>        <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>        <span class="o">*</span><span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">X_train_features_names_out_</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">:</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>            <span class="sa">f</span><span class="s2">&quot;Feature mismatch detected after matrix creation. The features &quot;</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>            <span class="sa">f</span><span class="s2">&quot;generated from the provided data do not match those used during &quot;</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>            <span class="sa">f</span><span class="s2">&quot;the training process. To correctly set in-sample residuals, &quot;</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>            <span class="sa">f</span><span class="s2">&quot;ensure that the same data and preprocessing steps are applied.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>            <span class="sa">f</span><span class="s2">&quot;    Expected output : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>            <span class="sa">f</span><span class="s2">&quot;    Current output  : </span><span class="si">{</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>        <span class="p">)</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>        <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>        <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>        <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.set_out_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_out_sample_residuals</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new values to the attribute <code>out_sample_residuals_</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>    <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><span class="sd">    Set new values to the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>            <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>        <span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>        <span class="p">)</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>            <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>        <span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>            <span class="n">array</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>        <span class="p">)</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>            <span class="n">array</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>        <span class="p">)</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>        <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>        <span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>        <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>    <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>        <span class="p">)</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>    <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>    <span class="p">)</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>    <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>        <span class="p">{}</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>    <span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>                    <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>                <span class="p">)</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>                    <span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>                <span class="p">)</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>        <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>            <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>        <span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>        <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>            <span class="n">k</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>            <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>        <span class="p">]</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>                <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>                <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>                <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>                <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>            <span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>            <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>                    <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>                <span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.ForecasterRecursive.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set the parameters of this forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of parameter names mapped to their new values.
If provided, these parameters are set first.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of parameter names mapped to their new values.
Parameters can be for the forecaster itself or for the contained estimator (using the <code>estimator__</code> prefix).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code>&#39;ForecasterRecursive&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forecaster instance with updated parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">estimator__fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()[</span><span class="s2">&quot;fit_intercept&quot;</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">False</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">    Set the parameters of this forecaster.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        params: Optional dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">            If provided, these parameters are set first.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        **kwargs: Dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            Parameters can be for the forecaster itself or for the contained estimator (using the `estimator__` prefix).</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">        self: The forecaster instance with updated parameters.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_params(estimator__fit_intercept=False)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        &gt;&gt;&gt; forecaster.estimator.get_params()[&quot;fit_intercept&quot;]</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">        False</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="c1"># Merge params dict and kwargs</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">all_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>        <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_params</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>    <span class="n">valid_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>    <span class="n">nested_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">all_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_params</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="c1"># Relaxed check for now</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>            <span class="k">pass</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>        <span class="k">if</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>            <span class="n">obj_name</span><span class="p">,</span> <span class="n">param_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>            <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="p">:</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>                <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>            <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>    <span class="k">for</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">obj_params</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">):</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;set_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                <span class="n">obj</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">obj_params</span><span class="p">)</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>                <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="base-forecaster">Base Forecaster</h2>
<h3 id="base">base</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.forecaster.base" class="doc doc-heading">
            <code>spotforecast2_safe.forecaster.base</code>


</h2>

    <div class="doc doc-contents first">

        <p>ForecasterBase class.</p>
<p>This module contains the base class for all forecasters in spotforecast2_safe and spotforecast.
All forecasters should specify all the parameters that can be set at the
class level in their <strong>init</strong>.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a custom forecaster inheriting from ForecasterBase:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterBase</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">MyForecaster</span><span class="p">(</span><span class="n">ForecasterBase</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">estimator</span><span class="p">):</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">estimator</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hide_lags&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(),</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>        <span class="k">pass</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">steps</span><span class="p">))</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>        <span class="k">pass</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">MyForecaster</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">())</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">MyForecaster(estimator=Ridge())</span>
</code></pre></div>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.forecaster.base.ForecasterBase" class="doc doc-heading">
            <code>ForecasterBase</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>Base class for all forecasters in spotforecast2.</p>
<p>All forecasters should specify all the parameters that can be set at
the class level in their <strong>init</strong>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.base.ForecasterBase.__spotforecast_tags__">__spotforecast_tags__</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with forecaster tags that characterize
the behavior of the forecaster.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>To see all abstract methods that need to be implemented:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterBase</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">ForecasterBase</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">isabstract</span><span class="p">)]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[&#39;create_train_X_y&#39;, &#39;fit&#39;, &#39;predict&#39;, &#39;set_params&#39;]</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">class</span><span class="w"> </span><span class="nc">ForecasterBase</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all forecasters in spotforecast2.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    All forecasters should specify all the parameters that can be set at</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    the class level in their __init__.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        __spotforecast_tags__: Dictionary with forecaster tags that characterize</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            the behavior of the forecaster.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        To see all abstract methods that need to be implemented:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        &gt;&gt;&gt; import inspect</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.base import ForecasterBase</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        &gt;&gt;&gt; [m[0] for m in inspect.getmembers(ForecasterBase, predicate=inspect.isabstract)]</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        [&#39;create_train_X_y&#39;, &#39;fit&#39;, &#39;predict&#39;, &#39;set_params&#39;]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_preprocess_repr</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">training_range_</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">series_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">exog_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">transformer_series</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the information to be displayed when a Forecaster object is printed.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            estimator: Estimator object. Default is None.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            training_range_: Training range. Only used for ForecasterRecursiveMultiSeries.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            series_names_in_: Names of the series used in the forecaster.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                Only used for ForecasterRecursiveMultiSeries. Default is None.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            exog_names_in_: Names of the exogenous variables used in the forecaster.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            transformer_series: Transformer used in the series.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">                Only used for ForecasterRecursiveMultiSeries. Default is None.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            Tuple containing params (estimator parameters string), training_range_</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            (training range string representation), series_names_in_ (series names</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            string representation), exog_names_in_ (exogenous variable names string</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            representation), and transformer_series (transformer string representation).</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            &gt;&gt;&gt; estimator = Ridge(alpha=0.5)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=estimator, lags=3)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            &gt;&gt;&gt; params, tr, sn, en, ts = forecaster._preprocess_repr(estimator=estimator)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            &gt;&gt;&gt; params</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            &quot;{&#39;alpha&#39;: 0.5, &#39;copy_X&#39;: True, &#39;fit_intercept&#39;: True, &#39;max_iter&#39;: None, &#39;positive&#39;: False, &#39;random_state&#39;: None, &#39;solver&#39;: &#39;auto&#39;, &#39;tol&#39;: 0.0001}&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">if</span> <span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">name_pipe_steps</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;__&quot;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">named_steps</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name_pipe_steps</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="p">}</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="n">params</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="n">params</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">params</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">if</span> <span class="n">training_range_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">training_range_</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">training_range_</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_range_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">training_range_</span> <span class="o">=</span> <span class="n">training_range_</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">training_range_</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">training_range_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">training_range_</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">series_names_in_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="n">series_names_in_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                    <span class="n">series_names_in_</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">series_names_in_</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">:]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">if</span> <span class="n">exog_names_in_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">exog_names_in_</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">:]</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="n">transformer_series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transformer_series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="p">]</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                    <span class="n">transformer_series</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                        <span class="n">transformer_series</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;...&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">transformer_series</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                    <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="n">transformer_series</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">params</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">training_range_</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">series_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">transformer_series</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_text_repr</span><span class="p">(</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">max_text_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">indent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;    &quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format text for __repr__ method.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            text: Text to format.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            max_text_length: Maximum length of the text before wrapping. Default is 58.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            width: Maximum width of the text. Default is 80.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            indent: Indentation of the text. Default is four spaces.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            Formatted text string with proper wrapping and indentation.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            &gt;&gt;&gt; forecaster._format_text_repr(&quot;Short text&quot;)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            &#39;Short text&#39;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_text_length</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    &quot;</span> <span class="o">+</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">subsequent_indent</span><span class="o">=</span><span class="n">indent</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">return</span> <span class="n">text</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create training matrices from univariate time series and exogenous variables.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">                number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">                Default is None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            Tuple containing X_train (training values/predictors with shape</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            (len(y) - max_lag, len(lags))) and y_train (target values of the</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            time series related to each row of X_train with shape (len(y) - max_lag,)).</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            &gt;&gt;&gt; X_train.head(2)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">               lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            3    2.0    1.0    0.0</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            4    3.0    2.0    1.0</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            &gt;&gt;&gt; y_train.head(2)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            3    3</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            4    4</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            Name: y, dtype: int64</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">pass</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Training Forecaster.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">                number of observations as y and their indexes must be aligned so</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">                that y[i] is regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            None</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            &gt;&gt;&gt; forecaster.is_fitted</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            True</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="k">pass</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict n steps ahead.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            steps: Number of steps to predict.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">                first iteration of the prediction (t + 1). If None, the values stored in</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">                last_window are used to calculate the initial predictors, and the</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">                predictions start right after training data. Default is None.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            exog: Exogenous variable(s) included as predictor(s). Default is None.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            Predicted values as a pandas Series.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            10    9.5</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            11    9.0</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            12    8.5</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            Name: pred, dtype: float64</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">pass</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new values to the parameters of the scikit-learn model stored in the forecaster.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            params: Parameters values dictionary.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(alpha=1.0), lags=3)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_params({&#39;estimator__alpha&#39;: 0.5})</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            &gt;&gt;&gt; forecaster.estimator.alpha</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            0.5</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">pass</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_lags</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute lags.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        Attributes max_lag and window_size are also updated.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            lags: Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">                If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">                or range: include only lags present in lags, all elements must be int.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">                If None: no lags are included as predictors. Default is None.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            None</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_lags(lags=5)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            &gt;&gt;&gt; forecaster.lags</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            array([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">pass</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_window_features</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">window_features</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute window_features.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Attributes max_size_window_features, window_features_names,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        window_features_class_names and window_size are also updated.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            window_features: Instance or list of instances used to create window features.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">                Window features are created from the original time series and are</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                included as predictors. Default is None.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            &gt;&gt;&gt; window_feat = RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_window_features(window_features=window_feat)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            &gt;&gt;&gt; forecaster.window_features</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            [RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">pass</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">            Dictionary with forecaster tags describing behavior and capabilities.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            &gt;&gt;&gt; tags[&#39;forecaster_task&#39;]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            &#39;regression&#39;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Show forecaster information.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            None</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            &gt;&gt;&gt; forecaster.summary()</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            ForecasterRecursive</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            ===================</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            Estimator: Ridge()</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            Lags: [1 2 3]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            ...</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        This method is called when an object is unpickled (deserialized).</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        It handles the migration of deprecated attributes to their new names.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            state: The state dictionary from the pickled object.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            None</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            &gt;&gt;&gt; import pickle</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            &gt;&gt;&gt; pickled_forecaster = pickle.dumps(forecaster)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            &gt;&gt;&gt; unpickled_forecaster = pickle.loads(pickled_forecaster)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">if</span> <span class="s2">&quot;regressor&quot;</span> <span class="ow">in</span> <span class="n">state</span> <span class="ow">and</span> <span class="s2">&quot;estimator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;estimator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">regressor</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deprecated property. Use estimator instead.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            The estimator object.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            &gt;&gt;&gt; forecaster.regressor # Raises FutureWarning</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            Ridge()</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="s2">&quot;The `regressor` attribute is deprecated and will be removed in future &quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="s2">&quot;versions. Use `estimator` instead.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.regressor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">regressor</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Deprecated property. Use estimator instead.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The estimator object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">regressor</span> <span class="c1"># Raises FutureWarning</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Ridge()</span>
</code></pre></div>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Custom <strong>setstate</strong> to ensure backward compatibility when unpickling.</p>
<p>This method is called when an object is unpickled (deserialized).
It handles the migration of deprecated attributes to their new names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The state dictionary from the pickled object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">pickled_forecaster</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">unpickled_forecaster</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickled_forecaster</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    This method is called when an object is unpickled (deserialized).</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    It handles the migration of deprecated attributes to their new names.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        state: The state dictionary from the pickled object.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        None</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        &gt;&gt;&gt; import pickle</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        &gt;&gt;&gt; pickled_forecaster = pickle.dumps(forecaster)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        &gt;&gt;&gt; unpickled_forecaster = pickle.loads(pickled_forecaster)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">if</span> <span class="s2">&quot;regressor&quot;</span> <span class="ow">in</span> <span class="n">state</span> <span class="ow">and</span> <span class="s2">&quot;estimator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;estimator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.create_train_X_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create training matrices from univariate time series and exogenous variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Must have the same
number of observations as y and their indexes must be aligned.
Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing X_train (training values/predictors with shape</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(len(y) - max_lag, len(lags))) and y_train (target values of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>time series related to each row of X_train with shape (len(y) - max_lag,)).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">   lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">3    2.0    1.0    0.0</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">4    3.0    2.0    1.0</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">3    3</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">4    4</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">Name: y, dtype: int64</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create training matrices from univariate time series and exogenous variables.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        y: Training time series.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            Default is None.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        Tuple containing X_train (training values/predictors with shape</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        (len(y) - max_lag, len(lags))) and y_train (target values of the</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        time series related to each row of X_train with shape (len(y) - max_lag,)).</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        &gt;&gt;&gt; X_train.head(2)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">           lag_1  lag_2  lag_3</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        3    2.0    1.0    0.0</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        4    3.0    2.0    1.0</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        &gt;&gt;&gt; y_train.head(2)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        3    3</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        4    4</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        Name: y, dtype: int64</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Training Forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Must have the same
number of observations as y and their indexes must be aligned so
that y[i] is regressed on exog[i]. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">is_fitted</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Training Forecaster.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        y: Training time series.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Must have the same</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            number of observations as y and their indexes must be aligned so</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            that y[i] is regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        None</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &gt;&gt;&gt; forecaster.is_fitted</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        True</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.get_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tags</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the tags that characterize the behavior of the forecaster.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with forecaster tags describing behavior and capabilities.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;forecaster_task&#39;</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">&#39;regression&#39;</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        Dictionary with forecaster tags describing behavior and capabilities.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        &gt;&gt;&gt; tags[&#39;forecaster_task&#39;]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        &#39;regression&#39;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1). If None, the values stored in
last_window are used to calculate the initial predictors, and the
predictions start right after training data. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictor(s). Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values as a pandas Series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">10    9.5</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">11    9.0</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">12    8.5</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">Name: pred, dtype: float64</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Predict n steps ahead.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        steps: Number of steps to predict.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            first iteration of the prediction (t + 1). If None, the values stored in</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            last_window are used to calculate the initial predictors, and the</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            predictions start right after training data. Default is None.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        exog: Exogenous variable(s) included as predictor(s). Default is None.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        Predicted values as a pandas Series.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(10), name=&#39;y&#39;)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        10    9.5</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        11    9.0</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        12    8.5</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        Name: pred, dtype: float64</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.set_lags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_lags</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new value to the attribute lags.</p>
<p>Attributes max_lag and window_size are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.
If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,
or range: include only lags present in lags, all elements must be int.
If None: no lags are included as predictors. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_lags</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">array([1, 2, 3, 4, 5])</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_lags</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">lags</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute lags.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Attributes max_lag and window_size are also updated.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        lags: Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            If int: include lags from 1 to lags (included). If list, 1d numpy ndarray,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            or range: include only lags present in lags, all elements must be int.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            If None: no lags are included as predictors. Default is None.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        None</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_lags(lags=5)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        &gt;&gt;&gt; forecaster.lags</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        array([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Set new values to the parameters of the scikit-learn model stored in the forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameters values dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">({</span><span class="s1">&#39;estimator__alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">alpha</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">0.5</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new values to the parameters of the scikit-learn model stored in the forecaster.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        params: Parameters values dictionary.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        None</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(alpha=1.0), lags=3)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_params({&#39;estimator__alpha&#39;: 0.5})</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        &gt;&gt;&gt; forecaster.estimator.alpha</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        0.5</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.set_window_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new value to the attribute window_features.</p>
<p>Attributes max_size_window_features, window_features_names,
window_features_class_names and window_size are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>window_features</code>
            </td>
            <td>
                  <code><span title="object">object</span> | <span title="list">list</span>[<span title="object">object</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance or list of instances used to create window features.
Window features are created from the original time series and are
included as predictors. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">window_feat</span> <span class="o">=</span> <span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="o">=</span><span class="n">window_feat</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_window_features</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">window_features</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set new value to the attribute window_features.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    Attributes max_size_window_features, window_features_names,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    window_features_class_names and window_size are also updated.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        window_features: Instance or list of instances used to create window features.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            Window features are created from the original time series and are</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            included as predictors. Default is None.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        &gt;&gt;&gt; window_feat = RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_window_features(window_features=window_feat)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        &gt;&gt;&gt; forecaster.window_features</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        [RollingFeatures(stats=[&#39;mean&#39;], window_sizes=[3])]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.base.ForecasterBase.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Show forecaster information.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">ForecasterRecursive</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">===================</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">Estimator: Ridge()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">Lags: [1 2 3]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">...</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Show forecaster information.</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        None</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        &gt;&gt;&gt; forecaster.summary()</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        ForecasterRecursive</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        ===================</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        Estimator: Ridge()</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Lags: [1 2 3]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        ...</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="recursive-forecasting">Recursive Forecasting</h2>
<h3 id="recursive">recursive</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.forecaster.recursive" class="doc doc-heading">
            <code>spotforecast2_safe.forecaster.recursive</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate" class="doc doc-heading">
            <code>ForecasterEquivalentDate</code>


</h3>


    <div class="doc doc-contents ">



        <p>This forecaster predicts future values based on the most recent equivalent
date. It also allows to aggregate multiple past values of the equivalent
date using a function (e.g. mean, median, max, min, etc.). The equivalent
date is calculated by moving back in time a specified number of steps (offset).
The offset can be defined as an integer or as a pandas DateOffset. This
approach is useful as a baseline, but it is a simplistic method and may not
capture complex underlying patterns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>offset</code>
            </td>
            <td>
                  <code>(<span title="int">int</span>, <span title="pandas.tseries.offsets.DateOffset">DateOffset</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to go back
in time to find the most recent equivalent date to the target period.
If <code>offset</code> is an integer, it represents the number of steps to go back
in time. For example, if the frequency of the time series is daily,
<code>offset = 7</code> means that the most recent data similar to the target
period is the value observed 7 days ago.
Pandas DateOffsets can also be used to move forward a given number of
valid dates. For example, Bday(2) can be used to move back two business
days. If the date does not start on a valid date, it is first moved to a
valid date. For example, if the date is a Saturday, it is moved to the
previous Friday. Then, the offset is applied. If the result is a non-valid
date, it is moved to the next valid date. For example, if the date
is a Sunday, it is moved to the next Monday.
For more information about offsets, see
https://pandas.pydata.org/docs/reference/offset_frequency.html.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_offsets</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of equivalent dates (multiple of offset)
used in the prediction. Defaults to 1.
If <code>n_offsets</code> is greater than 1, the values at the equivalent dates are
aggregated using the <code>agg_func</code> function. For example, if the frequency
of the time series is daily, <code>offset = 7</code>, <code>n_offsets = 2</code> and
<code>agg_func = np.mean</code>, the predicted value will be the mean of the values
observed 7 and 14 days ago.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>agg_func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function used to aggregate the values of the
equivalent dates when the number of equivalent dates (<code>n_offsets</code>) is
greater than 1. Defaults to np.mean.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.mean">mean</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binner_kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the
<code>QuantileBinner</code> used to discretize the residuals into k bins according
to the predicted values associated with each residual. Available arguments
are: <code>n_bins</code>, <code>method</code>, <code>subsample</code>, <code>random_state</code> and <code>dtype</code>.
Argument <code>method</code> is passed internally to the function <code>numpy.percentile</code>.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_id</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="int">int</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name used as an identifier of the
forecaster. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.offset">offset</span></code></td>
            <td>
                  <code>(<span title="int">int</span>, <span title="pandas.tseries.offsets.DateOffset">DateOffset</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to go back
in time to find the most recent equivalent date to the target period.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.n_offsets">n_offsets</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of equivalent dates (multiple of offset) used in
the prediction.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.agg_func">agg_func</span></code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function used to aggregate the values of the equivalent
dates when the number of equivalent dates (<code>n_offsets</code>) is greater than 1.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.window_size">window_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of past values needed to include the last
equivalent dates according to the <code>offset</code> and <code>n_offsets</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.last_window_">last_window_</span></code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This window represents the most recent data
observed by the predictor during its training phase. It contains the
past values needed to include the last equivalent date according the
<code>offset</code> and <code>n_offsets</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.index_type_">index_type_</span></code></td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of index of the input used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.index_freq_">index_freq_</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency of Index of the input used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.training_range_">training_range_</span></code></td>
            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First and last values of index of the data
used during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.series_name_in_">series_name_in_</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series provided by the user during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.in_sample_residuals_">in_sample_residuals_</span></code></td>
            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals of the model when predicting
training data. Only stored up to 10_000 values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.in_sample_residuals_by_bin_">in_sample_residuals_by_bin_</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In sample residuals binned according to
the predicted value each residual is associated with. The number of
residuals stored per bin is limited to <code>10_000 // self.binner.n_bins_</code>
in the form <code>{bin: residuals}</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.out_sample_residuals_">out_sample_residuals_</span></code></td>
            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals of the model when predicting
non-training data. Only stored up to 10_000 values. Use
<code>set_out_sample_residuals()</code> method to set values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.out_sample_residuals_by_bin_">out_sample_residuals_by_bin_</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Out of sample residuals binned
according to the predicted value each residual is associated with.
The number of residuals stored per bin is limited to
<code>10_000 // self.binner.n_bins_</code> in the form <code>{bin: residuals}</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.binner">binner</span></code></td>
            <td>
                  <code><span title="spotforecast.preprocessing.QuantileBinner">QuantileBinner</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>QuantileBinner</code> used to
discretize residuals into k bins according to the predicted values
associated with each residual.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.binner_intervals_">binner_intervals_</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intervals used to discretize residuals into k bins
according to the predicted values associated with each residual.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.binner_kwargs">binner_kwargs</span></code></td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to the <code>QuantileBinner</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.creation_date">creation_date</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date of creation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.is_fitted">is_fitted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag to identify if the estimator has been fitted (trained).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.fit_date">fit_date</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date of last fit.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.spotforecast_version">spotforecast_version</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of spotforecast library used to create
the forecaster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.python_version">python_version</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of python used to create the forecaster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.forecaster_id">forecaster_id</span></code></td>
            <td>
                  <code>(<span title="str">str</span>, <span title="int">int</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name used as an identifier of the forecaster.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Series with daily frequency</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Forecast based on the value 7 days ago</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">2022-01-15    7</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">2022-01-16    8</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">2022-01-17    9</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">Freq: D, Name: pred, dtype: int64</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-32">  32</a></span>
<span class="normal"><a href="#__codelineno-0-33">  33</a></span>
<span class="normal"><a href="#__codelineno-0-34">  34</a></span>
<span class="normal"><a href="#__codelineno-0-35">  35</a></span>
<span class="normal"><a href="#__codelineno-0-36">  36</a></span>
<span class="normal"><a href="#__codelineno-0-37">  37</a></span>
<span class="normal"><a href="#__codelineno-0-38">  38</a></span>
<span class="normal"><a href="#__codelineno-0-39">  39</a></span>
<span class="normal"><a href="#__codelineno-0-40">  40</a></span>
<span class="normal"><a href="#__codelineno-0-41">  41</a></span>
<span class="normal"><a href="#__codelineno-0-42">  42</a></span>
<span class="normal"><a href="#__codelineno-0-43">  43</a></span>
<span class="normal"><a href="#__codelineno-0-44">  44</a></span>
<span class="normal"><a href="#__codelineno-0-45">  45</a></span>
<span class="normal"><a href="#__codelineno-0-46">  46</a></span>
<span class="normal"><a href="#__codelineno-0-47">  47</a></span>
<span class="normal"><a href="#__codelineno-0-48">  48</a></span>
<span class="normal"><a href="#__codelineno-0-49">  49</a></span>
<span class="normal"><a href="#__codelineno-0-50">  50</a></span>
<span class="normal"><a href="#__codelineno-0-51">  51</a></span>
<span class="normal"><a href="#__codelineno-0-52">  52</a></span>
<span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="k">class</span><span class="w"> </span><span class="nc">ForecasterEquivalentDate</span><span class="p">:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    This forecaster predicts future values based on the most recent equivalent</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    date. It also allows to aggregate multiple past values of the equivalent</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    date using a function (e.g. mean, median, max, min, etc.). The equivalent</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    date is calculated by moving back in time a specified number of steps (offset).</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    The offset can be defined as an integer or as a pandas DateOffset. This</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    approach is useful as a baseline, but it is a simplistic method and may not</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    capture complex underlying patterns.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        offset (int, pandas.tseries.offsets.DateOffset): Number of steps to go back</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            in time to find the most recent equivalent date to the target period.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            If `offset` is an integer, it represents the number of steps to go back</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            in time. For example, if the frequency of the time series is daily,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            `offset = 7` means that the most recent data similar to the target</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            period is the value observed 7 days ago.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            Pandas DateOffsets can also be used to move forward a given number of</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            valid dates. For example, Bday(2) can be used to move back two business</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            days. If the date does not start on a valid date, it is first moved to a</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            valid date. For example, if the date is a Saturday, it is moved to the</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            previous Friday. Then, the offset is applied. If the result is a non-valid</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            date, it is moved to the next valid date. For example, if the date</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            is a Sunday, it is moved to the next Monday.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            For more information about offsets, see</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            https://pandas.pydata.org/docs/reference/offset_frequency.html.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        n_offsets (int, optional): Number of equivalent dates (multiple of offset)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            used in the prediction. Defaults to 1.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            If `n_offsets` is greater than 1, the values at the equivalent dates are</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            aggregated using the `agg_func` function. For example, if the frequency</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            of the time series is daily, `offset = 7`, `n_offsets = 2` and</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            `agg_func = np.mean`, the predicted value will be the mean of the values</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            observed 7 and 14 days ago.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        agg_func (Callable, optional): Function used to aggregate the values of the</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            equivalent dates when the number of equivalent dates (`n_offsets`) is</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            greater than 1. Defaults to np.mean.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        binner_kwargs (dict, optional): Additional arguments to pass to the</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            `QuantileBinner` used to discretize the residuals into k bins according</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            to the predicted values associated with each residual. Available arguments</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            are: `n_bins`, `method`, `subsample`, `random_state` and `dtype`.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            Argument `method` is passed internally to the function `numpy.percentile`.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        forecaster_id (str, int, optional): Name used as an identifier of the</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            forecaster. Defaults to None.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        offset (int, pandas.tseries.offsets.DateOffset): Number of steps to go back</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            in time to find the most recent equivalent date to the target period.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        n_offsets (int): Number of equivalent dates (multiple of offset) used in</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            the prediction.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        agg_func (Callable): Function used to aggregate the values of the equivalent</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            dates when the number of equivalent dates (`n_offsets`) is greater than 1.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        window_size (int): Number of past values needed to include the last</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            equivalent dates according to the `offset` and `n_offsets`.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        last_window_ (pandas Series): This window represents the most recent data</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            observed by the predictor during its training phase. It contains the</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            past values needed to include the last equivalent date according the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            `offset` and `n_offsets`.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        index_type_ (type): Type of index of the input used in training.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        index_freq_ (str): Frequency of Index of the input used in training.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        training_range_ (pandas Index): First and last values of index of the data</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            used during training.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        series_name_in_ (str): Names of the series provided by the user during training.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        in_sample_residuals_ (numpy ndarray): Residuals of the model when predicting</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            training data. Only stored up to 10_000 values.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        in_sample_residuals_by_bin_ (dict): In sample residuals binned according to</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            the predicted value each residual is associated with. The number of</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            residuals stored per bin is limited to `10_000 // self.binner.n_bins_`</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            in the form `{bin: residuals}`.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        out_sample_residuals_ (numpy ndarray): Residuals of the model when predicting</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            non-training data. Only stored up to 10_000 values. Use</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            `set_out_sample_residuals()` method to set values.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        out_sample_residuals_by_bin_ (dict): Out of sample residuals binned</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            according to the predicted value each residual is associated with.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            The number of residuals stored per bin is limited to</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            `10_000 // self.binner.n_bins_` in the form `{bin: residuals}`.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        binner (spotforecast.preprocessing.QuantileBinner): `QuantileBinner` used to</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            discretize residuals into k bins according to the predicted values</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            associated with each residual.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        binner_intervals_ (dict): Intervals used to discretize residuals into k bins</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            according to the predicted values associated with each residual.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        binner_kwargs (dict): Additional arguments to pass to the `QuantileBinner`.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        creation_date (str): Date of creation.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        is_fitted (bool): Tag to identify if the estimator has been fitted (trained).</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        fit_date (str): Date of last fit.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        spotforecast_version (str): Version of spotforecast library used to create</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            the forecaster.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        python_version (str): Version of python used to create the forecaster.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        forecaster_id (str, int): Name used as an identifier of the forecaster.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        &gt;&gt;&gt; # Series with daily frequency</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ...     data = np.arange(14),</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; # Forecast based on the value 7 days ago</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        2022-01-15    7</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        2022-01-16    8</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        2022-01-17    9</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Freq: D, Name: pred, dtype: int64</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">n_offsets</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">agg_func</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">binner_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">forecaster_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">=</span> <span class="n">n_offsets</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span> <span class="o">=</span> <span class="n">agg_func</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="n">__version__</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span> <span class="o">=</span> <span class="n">forecaster_id</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">=</span> <span class="s2">&quot;binned&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Defaults to None, validated later</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">)):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="s2">&quot;`offset` must be an integer greater than 0 or a &quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="s2">&quot;pandas.tseries.offsets. Find more information about offsets in &quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="s2">&quot;https://pandas.pydata.org/docs/reference/offset_frequency.html&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="n">binner_kwargs</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">if</span> <span class="n">binner_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="s2">&quot;subsample&quot;</span><span class="p">:</span> <span class="mi">200000</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">789654</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="p">}</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="o">=</span> <span class="n">QuantileBinner</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>  <span class="c1"># single-series | global</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>  <span class="c1"># recursive | direct | deep_learning</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;point&quot;</span><span class="p">,</span> <span class="s2">&quot;interval&quot;</span><span class="p">],</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="p">}</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Information displayed when a Forecaster object is printed.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            str: Information about the forecaster. It contains the following information:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            - Offset: Value of the `offset` argument.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            - Number of offsets: Value of the `n_offsets` argument.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            - Aggregation function: Name of the `agg_func` function.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            - Window size: Value of the `window_size` attribute.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            - Series name: Name of the series provided by the user during training.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            - Training range: First and last values of index of the data used during training.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            - Training index type: Type of index of the data used during training.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            - Training index frequency: Frequency of index of the data used during training.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            - Creation date: Date of creation of the forecaster object.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            - Last fit date: Date of last fit of the forecaster object.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            - spotforecast version: Version of spotforecast library used to create the forecaster.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            - Python version: Version of python used to create the forecaster.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            - Forecaster id: Name used as an identifier of the forecaster.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            ...     data = np.arange(14),</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            &gt;&gt;&gt; print(forecaster)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            ============================</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            ForecasterEquivalentDate</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            ============================</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            Offset: 7</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            Number of offsets: 1</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            Aggregation function: mean</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            Window size: 7</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            Series name: y</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">            Training range: [Timestamp(&#39;2022-01-01 00:00:00&#39;), Timestamp(&#39;2022-01-14 00:00:00&#39;)]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            Training index type: DatetimeIndex</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            Training index frequency: D</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">            Creation date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            Last fit date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            spotforecast version: 1.0.0</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            Python version: 3.8.10</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            Forecaster id: None</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="sa">f</span><span class="s2">&quot;Offset: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="sa">f</span><span class="s2">&quot;Number of offsets: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="sa">f</span><span class="s2">&quot;Aggregation function: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        HTML representation of the object.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            str: HTML representation of the forecaster object. It contains the same</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            information as the `__repr__` method, but in a more structured way.</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            In detail, it contains the following information:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            - Offset: Value of the `offset` argument.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            - Number of offsets: Value of the `n_offsets` argument.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            - Aggregation function: Name of the `agg_func` function.</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            - Window size: Value of the `window_size` attribute.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            - Series name: Name of the series provided by the user during training.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            - Training range: First and last values of index of the data used during training.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            - Training index type: Type of index of the data used during training.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            - Training index frequency: Frequency of index of the data used during training.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            - Creation date: Date of creation of the forecaster object.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            - Last fit date: Date of last fit of the forecaster object.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            - spotforecast version: Version of spotforecast library used to create the forecaster.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            - Python version: Version of python used to create the forecaster.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            - Forecaster id: Name used as an identifier of the forecaster.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            ...     data = np.arange(14),</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            &gt;&gt;&gt; forecaster._repr_html_()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            &#39;&lt;style&gt;...&lt;/style&gt;&lt;div class=&quot;container-...&quot;&gt;...&lt;/div&gt;&#39;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Estimator:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Offset:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Number of offsets:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Aggregation function:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Creation date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Last fit date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;spotforecast version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Python version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Forecaster id:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="s2">                &lt;summary&gt;Training Information&lt;/summary&gt;</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training range:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index type:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index frequency:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Training Forecaster.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            y (pandas Series): Training time series.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            store_in_sample_residuals (bool, optional): If `True`, in-sample</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">                residuals will be stored in the forecaster object after fitting</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">                (`in_sample_residuals_` and `in_sample_residuals_by_bin_` attributes).</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">                If `False`, only the intervals of the bins are stored. Defaults to False.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            random_state (int, optional): Set a seed for the random generator so</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">                that the stored sample residuals are always deterministic. Defaults to 123.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">            None</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            ...     data = np.arange(14),</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="sa">f</span><span class="s2">&quot;`y` must be a pandas Series with a DatetimeIndex or a RangeIndex. &quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                    <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="k">elif</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                    <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                        <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                        <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                        <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                        <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                    <span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">_</span><span class="p">,</span> <span class="n">y_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="c1"># Calculate the window_size in steps for compatibility with the</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="c1"># check_predict_input function. This is not a exact calculation</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="c1"># because the offset follows the calendar rules and the distance</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="c1"># between two dates may not be constant.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">y_index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">y_index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">y_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                    <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                    <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                    <span class="sa">f</span><span class="s2">&quot;the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) is larger than the available &quot;</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                    <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                <span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                    <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                    <span class="sa">f</span><span class="s2">&quot;needed by the forecaster. This is because  &quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="sa">f</span><span class="s2">&quot;the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) is larger than the available &quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                    <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `y`.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                    <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                    <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>                <span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y_index</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="n">y_index</span><span class="o">.</span><span class="n">freq</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="k">else</span> <span class="n">y_index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="c1"># The last time window of training data is stored so that equivalent</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="c1"># dates are available when calling the `predict` method.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="c1"># Store the whole series to avoid errors when the offset is larger</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="c1"># than the data available.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        Bin residuals according to the predicted value each residual is</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        associated with. First a `spotforecast.preprocessing.QuantileBinner` object</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        is fitted to the predicted values. Then, residuals are binned according</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        to the predicted value each residual is associated with. Residuals are</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        stored in the forecaster object as `in_sample_residuals_` and</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        `in_sample_residuals_by_bin_`.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        The number of residuals stored per bin is limited to</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        `10_000 // self.binner.n_bins_`. The total number of residuals stored is</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        `10_000`.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            y (pandas Series): Training time series.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            store_in_sample_residuals (bool, optional): If `True`, in-sample</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">                residuals will be stored in the forecaster object after fitting</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">                (`in_sample_residuals_` and `in_sample_residuals_by_bin_` attributes).</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">                If `False`, only the intervals of the bins are stored. Defaults to False.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            random_state (int, optional): Set a seed for the random generator so</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">                that the stored sample residuals are always deterministic. Defaults to 123.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            None</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">            ...     data = np.arange(21, dtype=float),</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=21, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            ...     offset=7,</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            ...     binner_kwargs={&#39;n_bins&#39;: 2, &#39;random_state&#39;: 123}</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            &gt;&gt;&gt; forecaster.in_sample_residuals_</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            array([7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7., 7.])</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            &gt;&gt;&gt; forecaster.in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            {0: array([7., 7., 7., 7., 7., 7., 7.]), 1: array([7., 7., 7., 7., 7., 7., 7.])}</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="n">y_preds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="k">for</span> <span class="n">n_off</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">n_off</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">mask</span><span class="p">]]</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                <span class="n">y_pred</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="p">:]</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                <span class="n">y_preds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="n">y_preds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">y_preds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span> <span class="p">:]</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="n">y_preds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                <span class="n">y</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="n">n_off</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="k">for</span> <span class="n">n_off</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="p">]</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">y_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">(</span><span class="n">y_preds</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">y_preds</span><span class="p">)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">})</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">intervals_</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="k">if</span> <span class="n">store_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>                    <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>                <span class="p">)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>                <span class="n">max_sample</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins_</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_sample</span><span class="p">:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                        <span class="n">sample</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">max_sample</span><span class="p">)]</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                    <span class="n">k</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>                    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="p">]</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>                    <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_sample</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">))</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                            <span class="n">a</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                        <span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000</span><span class="p">:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                    <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="p">]</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        Predict n steps ahead.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            steps (int): Number of steps to predict.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            last_window (pandas Series, optional): Past values needed to select the</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">                last equivalent dates according to the offset. If `last_window = None`,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">                the values stored in `self.last_window_` are used and the predictions</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">                start immediately after the training data. Defaults to None.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            check_inputs (bool, optional): If `True`, the input is checked for</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">                possible warnings and errors with the `check_predict_input` function.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">                This argument is created for internal use and is not recommended to</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">                be changed. Defaults to True.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            pd.Series: Predicted values.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">                If all equivalent values are missing when using a pandas DateOffset as offset.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">                This can be caused by using an offset larger than the available data.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">                To avoid this, try to decrease the size of the offset, the number of `n_offsets` or increase the size of `last_window`.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">                In backtesting, this error may be caused by using an `initial_train_size` too small.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            Warning:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">                If some equivalent values are missing when using a pandas DateOffset as offset.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">                This can be caused by using an offset larger than the available data or by using an `initial_train_size` too small in backtesting.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">                To avoid this, increase the `last_window` size or decrease the number of `n_offsets`.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            ...     data = np.arange(14),</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">            &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">            2022-01-15    7</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">            2022-01-16    8</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">            2022-01-17    9</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">            Freq: D, Name: pred, dtype: int64</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="k">if</span> <span class="n">check_inputs</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="n">exog_in_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="c1"># Initialize to prevent use-before-initialization warnings</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>            <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">steps</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="p">)</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">equivalent_indexes</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                <span class="n">predictions</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                    <span class="n">equivalent_indexes</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                <span class="p">]</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">equivalent_indexes</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">equivalent_values</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>                <span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="n">max_allowed_date</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="c1"># For every date in prediction_index, calculate the n offsets</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="n">offset_dates</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">prediction_index</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="n">selected_offsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                    <span class="n">offset_date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                    <span class="k">if</span> <span class="n">offset_date</span> <span class="o">&lt;=</span> <span class="n">max_allowed_date</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                        <span class="n">selected_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_date</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                    <span class="n">date</span> <span class="o">=</span> <span class="n">offset_date</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                <span class="n">offset_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="n">offset_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_dates</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="c1"># Select the values of the time series corresponding to the each</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="c1"># offset date. If the offset date is not in the time series, the</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="c1"># value is set to NaN.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                <span class="n">last_window</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">offset_dates</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="p">)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                <span class="n">data</span><span class="o">=</span><span class="n">equivalent_values</span><span class="p">,</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;offset_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)],</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>            <span class="c1"># Error if all values are missing</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>            <span class="k">if</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                    <span class="sa">f</span><span class="s2">&quot;All equivalent values are missing. This is caused by using &quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                    <span class="sa">f</span><span class="s2">&quot;an offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) larger than the available data. &quot;</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                    <span class="sa">f</span><span class="s2">&quot;Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `last_window`. In backtesting, this error may be &quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                    <span class="sa">f</span><span class="s2">&quot;caused by using an `initial_train_size` too small.&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="c1"># Warning if equivalent values are missing</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>            <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">incomplete_offsets</span><span class="p">[</span><span class="n">incomplete_offsets</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                    <span class="sa">f</span><span class="s2">&quot;Steps: </span><span class="si">{</span><span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                    <span class="sa">f</span><span class="s2">&quot;are calculated with less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> `n_offsets`. &quot;</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                    <span class="sa">f</span><span class="s2">&quot;To avoid this, increase the `last_window` size or decrease &quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets`. The current configuration requires &quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="sa">f</span><span class="s2">&quot;a total offset of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                    <span class="n">MissingValuesWarning</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                <span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="n">aggregate_values</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">aggregate_values</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conformal&quot;</span><span class="p">,</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        Predict n steps ahead and estimate prediction intervals using conformal</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        prediction method. Refer to the References section for additional</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        details on this method.</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">            steps (int): Number of steps to predict.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">            last_window (pandas Series, optional): Past values needed to select the</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">                last equivalent dates according to the offset. If `last_window = None`,</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">                the values stored in `self.last_window_` are used and the predictions</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">                start immediately after the training data. Defaults to None.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">            method (str, optional): Technique used to estimate prediction intervals.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">                Available options:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">                - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">                interval estimation [1]_. Defaults to &#39;conformal&#39;.</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            interval (float, list, tuple, optional): Confidence level of the</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">                prediction interval. Interpretation depends on the method used:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">                - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">                and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">                percentiles.</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">                - If `list` or `tuple`, defines the exact percentiles to compute,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">                which must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">                of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">                - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">                a list/tuple defining a symmetric interval. Defaults to [5, 95].</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            use_in_sample_residuals (bool, optional): If `True`, residuals from the</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">                training data are used as proxy of prediction error to create predictions.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            use_binned_residuals (bool, optional): If `True`, residuals are selected</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">                based on the predicted values (binned selection).</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            random_state (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">            n_boot (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">            pd.DataFrame: Values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">                - pred: predictions.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">                - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">                - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">            ValueError: If `method` is not &#39;conformal&#39;.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">            ValueError: If `interval` is not a float or a list/tuple defining a symmetric interval when using `method=&#39;conformal&#39;`.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">        References:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">            .. [1] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">                https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">            ...     data = np.arange(14, dtype=float),</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">            ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">            &gt;&gt;&gt; forecaster.predict_interval(steps=3, interval=0.8)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                        pred  lower_bound  upper_bound</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">            2022-01-15   7.0          6.0          8.0</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">            2022-01-16   8.0          7.0          9.0</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">            2022-01-17   9.0          8.0         10.0</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="sa">f</span><span class="s2">&quot;Method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; is not supported. Only &#39;conformal&#39; is available.&quot;</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="p">)</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>        <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>            <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>            <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="n">exog_in_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>            <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>            <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>            <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="p">)</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>        <span class="n">check_residuals_input</span><span class="p">(</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>            <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="n">in_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>            <span class="n">out_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="n">in_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>            <span class="n">out_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>        <span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="c1"># Initialize to prevent use-before-initialization warnings</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>            <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">steps</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>            <span class="p">)</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">equivalent_indexes</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>                <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>                <span class="n">predictions</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>                <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>                    <span class="n">equivalent_indexes</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>                <span class="p">]</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>                <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">equivalent_indexes</span><span class="p">)</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>                <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>                <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">equivalent_values</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>                <span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="n">max_allowed_date</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>            <span class="c1"># For every date in prediction_index, calculate the n offsets</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>            <span class="n">offset_dates</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">prediction_index</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>                <span class="n">selected_offsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                    <span class="n">offset_date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>                    <span class="k">if</span> <span class="n">offset_date</span> <span class="o">&lt;=</span> <span class="n">max_allowed_date</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>                        <span class="n">selected_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_date</span><span class="p">)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>                    <span class="n">date</span> <span class="o">=</span> <span class="n">offset_date</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>                <span class="n">offset_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="n">offset_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_dates</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>            <span class="c1"># Select the values of the time series corresponding to the each</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="c1"># offset date. If the offset date is not in the time series, the</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>            <span class="c1"># value is set to NaN.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>                <span class="n">last_window</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">offset_dates</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>                <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>                <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>            <span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>                <span class="n">data</span><span class="o">=</span><span class="n">equivalent_values</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;offset_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)],</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="p">)</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>            <span class="c1"># Error if all values are missing</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>            <span class="k">if</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                    <span class="sa">f</span><span class="s2">&quot;All equivalent values are missing. This is caused by using &quot;</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                    <span class="sa">f</span><span class="s2">&quot;an offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) larger than the available data. &quot;</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                    <span class="sa">f</span><span class="s2">&quot;Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `last_window`. In backtesting, this error may be &quot;</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                    <span class="sa">f</span><span class="s2">&quot;caused by using an `initial_train_size` too small.&quot;</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="p">)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="c1"># Warning if equivalent values are missing</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>            <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>            <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">incomplete_offsets</span><span class="p">[</span><span class="n">incomplete_offsets</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                    <span class="sa">f</span><span class="s2">&quot;Steps: </span><span class="si">{</span><span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                    <span class="sa">f</span><span class="s2">&quot;are calculated with less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> `n_offsets`. &quot;</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                    <span class="sa">f</span><span class="s2">&quot;To avoid this, increase the `last_window` size or decrease &quot;</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets`. The current configuration requires &quot;</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>                    <span class="sa">f</span><span class="s2">&quot;a total offset of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>                    <span class="n">MissingValuesWarning</span><span class="p">,</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>                <span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>            <span class="n">aggregate_values</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">aggregate_values</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>            <span class="n">correction_factor_by_bin</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>                <span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="p">}</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>            <span class="n">replace_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>            <span class="n">predictions_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">replace_func</span><span class="p">(</span><span class="n">predictions_bin</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">-</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">+</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">predictions</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">])</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">        Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        training process.</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        In-sample residuals are calculated as the difference between the true</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">        values and the predictions made by the forecaster using the training</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        data. The following internal attributes are updated:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        + `in_sample_residuals_`: residuals stored in a numpy ndarray.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">        + `binner_intervals_`: intervals used to bin the residuals are calculated</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        using the quantiles of the predicted values.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">        + `in_sample_residuals_by_bin_`: residuals are binned according to the</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        predicted value they are associated with and stored in a dictionary, where</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">        the keys are the intervals of the predicted values and the values are</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        the residuals associated with that range.</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        A total of 10_000 residuals are stored in the attribute `in_sample_residuals_`.</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        If the number of residuals is greater than 10_000, a random sample of</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        10_000 residuals is stored. The number of residuals stored per bin is</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        limited to `10_000 // self.binner.n_bins_`.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">            y (pandas Series): Training time series.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">            random_state (int, optional): Sets a seed to the random sampling for</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">                reproducible output. Defaults to 123.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">            None</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">            NotFittedError: If the forecaster has not been fitted.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            IndexError: If the index range of `y` does not match the training range.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">            ...     data=np.arange(14, dtype=float),</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">            ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=14, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">            &gt;&gt;&gt; # Recompute and store residuals if needed</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_in_sample_residuals(y=data, random_state=123)</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">            &gt;&gt;&gt; forecaster.in_sample_residuals_.shape</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            (7,)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>                <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>            <span class="p">)</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>        <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>            <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>        <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>                <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>                <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>                <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>                <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>                <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>            <span class="p">)</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>        <span class="p">)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">        Set new values to the attribute `out_sample_residuals_`. Out of sample</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        residuals are meant to be calculated using observations that did not</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">        participate in the training process. Two internal attributes are updated:</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">        + `out_sample_residuals_`: residuals stored in a numpy ndarray.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        + `out_sample_residuals_by_bin_`: residuals are binned according to the</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">        predicted value they are associated with and stored in a dictionary, where</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        the keys are the  intervals of the predicted values and the values are</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        the residuals associated with that range. If a bin binning is empty, it</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">        is filled with a random sample of residuals from other bins. This is done</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">        to ensure that all bins have at least one residual and can be used in the</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">        prediction process.</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">        A total of 10_000 residuals are stored in the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">        If the number of residuals is greater than 10_000, a random sample of</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">        10_000 residuals is stored. The number of residuals stored per bin is</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">        limited to `10_000 // self.binner.n_bins_`.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">            y_true (numpy ndarray, pandas Series): True values of the time series</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">                from which the residuals have been calculated.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            y_pred (numpy ndarray, pandas Series): Predicted values of the time series.</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            append (bool, optional): If `True`, new residuals are added to the once</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">                already stored in the forecaster. If after appending the new</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">                residuals, the limit of `10_000 // self.binner.n_bins_` values per</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">                bin is reached, a random sample of residuals is stored. Defaults</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">                to False.</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            random_state (int, optional): Sets a seed to the random sampling for</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">                reproducible output. Defaults to 123.</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            None</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">            NotFittedError: If the forecaster has not been fitted.</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">            TypeError: If `y_true` or `y_pred` are not numpy arrays or pandas Series.</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            ValueError: If `y_true` and `y_pred` have different lengths.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            ValueError: If `y_true` and `y_pred` are pandas Series with different indexes.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            ...     data=np.arange(21, dtype=float),</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">            ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=21, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            &gt;&gt;&gt; preds = forecaster.predict(steps=7)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            &gt;&gt;&gt; y_true = pd.Series(data[-7:].to_numpy(), index=preds.index)</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_out_sample_residuals(y_true=y_true, y_pred=preds)</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            &gt;&gt;&gt; forecaster.out_sample_residuals_.shape</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">            (7,)</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>                <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>            <span class="p">)</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>            <span class="p">)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>                <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>            <span class="p">)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>            <span class="p">)</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>            <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>        <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>        <span class="p">)</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>            <span class="p">{}</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>        <span class="p">)</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                        <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>            <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>                <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>            <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>        <span class="p">)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span><span class="p">:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>                <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>                <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>                <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>                <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>            <span class="p">)</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>            <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                    <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                <span class="p">)</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000</span><span class="p">:</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>                <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>            <span class="p">)</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">        Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            dict: Dictionary with forecaster tags.</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">            &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            &gt;&gt;&gt; sorted(tags.keys())[:3]</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            [&#39;allowed_input_types_exog&#39;, &#39;allowed_input_types_series&#39;, &#39;forecaster_name&#39;]</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        Show forecaster information.</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">            None</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">            &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">            ...     data=np.arange(14, dtype=float),</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">            ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=14, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">            &gt;&gt;&gt; forecaster.summary()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">            ============================</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when a Forecaster object is printed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Information about the forecaster. It contains the following information:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Offset: Value of the <code>offset</code> argument.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Number of offsets: Value of the <code>n_offsets</code> argument.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Aggregation function: Name of the <code>agg_func</code> function.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Window size: Value of the <code>window_size</code> attribute.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Series name: Name of the series provided by the user during training.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Training range: First and last values of index of the data used during training.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Training index type: Type of index of the data used during training.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Training index frequency: Frequency of index of the data used during training.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Creation date: Date of creation of the forecaster object.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Last fit date: Date of last fit of the forecaster object.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>spotforecast version: Version of spotforecast library used to create the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Python version: Version of python used to create the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>Forecaster id: Name used as an identifier of the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">============================</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">ForecasterEquivalentDate</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">============================</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Offset: 7</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">Number of offsets: 1</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">Aggregation function: mean</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">Window size: 7</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">Series name: y</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">Training range: [Timestamp(&#39;2022-01-01 00:00:00&#39;), Timestamp(&#39;2022-01-14 00:00:00&#39;)]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">Training index type: DatetimeIndex</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">Training index frequency: D</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">Creation date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">Last fit date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">spotforecast version: 1.0.0</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">Python version: 3.8.10</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">Forecaster id: None</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    Information displayed when a Forecaster object is printed.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        str: Information about the forecaster. It contains the following information:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        - Offset: Value of the `offset` argument.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        - Number of offsets: Value of the `n_offsets` argument.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        - Aggregation function: Name of the `agg_func` function.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        - Window size: Value of the `window_size` attribute.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        - Series name: Name of the series provided by the user during training.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        - Training range: First and last values of index of the data used during training.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        - Training index type: Type of index of the data used during training.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        - Training index frequency: Frequency of index of the data used during training.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        - Creation date: Date of creation of the forecaster object.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        - Last fit date: Date of last fit of the forecaster object.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        - spotforecast version: Version of spotforecast library used to create the forecaster.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        - Python version: Version of python used to create the forecaster.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        - Forecaster id: Name used as an identifier of the forecaster.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        ...     data = np.arange(14),</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &gt;&gt;&gt; print(forecaster)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        ============================</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        ForecasterEquivalentDate</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        ============================</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Offset: 7</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        Number of offsets: 1</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Aggregation function: mean</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        Window size: 7</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Series name: y</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        Training range: [Timestamp(&#39;2022-01-01 00:00:00&#39;), Timestamp(&#39;2022-01-14 00:00:00&#39;)]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        Training index type: DatetimeIndex</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        Training index frequency: D</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Creation date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        Last fit date: 2023-11-19 12:00:00</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        spotforecast version: 1.0.0</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        Python version: 3.8.10</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        Forecaster id: None</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="sa">f</span><span class="s2">&quot;Offset: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="sa">f</span><span class="s2">&quot;Number of offsets: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="sa">f</span><span class="s2">&quot;Aggregation function: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Training Forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, in-sample
residuals will be stored in the forecaster object after fitting
(<code>in_sample_residuals_</code> and <code>in_sample_residuals_by_bin_</code> attributes).
If <code>False</code>, only the intervals of the bins are stored. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set a seed for the random generator so
that the stored sample residuals are always deterministic. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Training Forecaster.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        y (pandas Series): Training time series.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        store_in_sample_residuals (bool, optional): If `True`, in-sample</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">            residuals will be stored in the forecaster object after fitting</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            (`in_sample_residuals_` and `in_sample_residuals_by_bin_` attributes).</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">            If `False`, only the intervals of the bins are stored. Defaults to False.</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        random_state (int, optional): Set a seed for the random generator so</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            that the stored sample residuals are always deterministic. Defaults to 123.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        None</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        ...     data = np.arange(14),</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="sa">f</span><span class="s2">&quot;`y` must be a pandas Series with a DatetimeIndex or a RangeIndex. &quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">elif</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="s2">&quot;If `offset` is a pandas DateOffset, the index of `y` must be a &quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                    <span class="s2">&quot;pandas DatetimeIndex with frequency.&quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                <span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">y_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="c1"># Calculate the window_size in steps for compatibility with the</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="c1"># check_predict_input function. This is not a exact calculation</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="c1"># because the offset follows the calendar rules and the distance</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="c1"># between two dates may not be constant.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">y_index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">y_index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">y_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="sa">f</span><span class="s2">&quot;the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) is larger than the available &quot;</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>                <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="sa">f</span><span class="s2">&quot;needed by the forecaster. This is because  &quot;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                <span class="sa">f</span><span class="s2">&quot;the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) is larger than the available &quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="sa">f</span><span class="s2">&quot;size of `y`.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>                <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y_index</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">y_index</span><span class="o">.</span><span class="n">freq</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="k">else</span> <span class="n">y_index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="c1"># The last time window of training data is stored so that equivalent</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="c1"># dates are available when calling the `predict` method.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="c1"># Store the whole series to avoid errors when the offset is larger</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="c1"># than the data available.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.get_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tags</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return the tags that characterize the behavior of the forecaster.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with forecaster tags.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">tags</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">[&#39;allowed_input_types_exog&#39;, &#39;allowed_input_types_series&#39;, &#39;forecaster_name&#39;]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    Return the tags that characterize the behavior of the forecaster.</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">        dict: Dictionary with forecaster tags.</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        &gt;&gt;&gt; tags = forecaster.get_tags()</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        &gt;&gt;&gt; sorted(tags.keys())[:3]</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        [&#39;allowed_input_types_exog&#39;, &#39;allowed_input_types_series&#39;, &#39;forecaster_name&#39;]</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Past values needed to select the
last equivalent dates according to the offset. If <code>last_window = None</code>,
the values stored in <code>self.last_window_</code> are used and the predictions
start immediately after the training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_inputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the input is checked for
possible warnings and errors with the <code>check_predict_input</code> function.
This argument is created for internal use and is not recommended to
be changed. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.Series: Predicted values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If all equivalent values are missing when using a pandas DateOffset as offset.
This can be caused by using an offset larger than the available data.
To avoid this, try to decrease the size of the offset, the number of <code>n_offsets</code> or increase the size of <code>last_window</code>.
In backtesting, this error may be caused by using an <code>initial_train_size</code> too small.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Warning">Warning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If some equivalent values are missing when using a pandas DateOffset as offset.
This can be caused by using an offset larger than the available data or by using an <code>initial_train_size</code> too small in backtesting.
To avoid this, increase the <code>last_window</code> size or decrease the number of <code>n_offsets</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">2022-01-15    7</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">2022-01-16    8</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">2022-01-17    9</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Freq: D, Name: pred, dtype: int64</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    Predict n steps ahead.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        steps (int): Number of steps to predict.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        last_window (pandas Series, optional): Past values needed to select the</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">            last equivalent dates according to the offset. If `last_window = None`,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            the values stored in `self.last_window_` are used and the predictions</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            start immediately after the training data. Defaults to None.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        check_inputs (bool, optional): If `True`, the input is checked for</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            possible warnings and errors with the `check_predict_input` function.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            This argument is created for internal use and is not recommended to</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            be changed. Defaults to True.</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">        exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        pd.Series: Predicted values.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            If all equivalent values are missing when using a pandas DateOffset as offset.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            This can be caused by using an offset larger than the available data.</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            To avoid this, try to decrease the size of the offset, the number of `n_offsets` or increase the size of `last_window`.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            In backtesting, this error may be caused by using an `initial_train_size` too small.</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        Warning:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            If some equivalent values are missing when using a pandas DateOffset as offset.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            This can be caused by using an offset larger than the available data or by using an `initial_train_size` too small in backtesting.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            To avoid this, increase the `last_window` size or decrease the number of `n_offsets`.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        ...     data = np.arange(14),</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">        &gt;&gt;&gt; forecaster.predict(steps=3)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        2022-01-15    7</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        2022-01-16    8</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        2022-01-17    9</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">        Freq: D, Name: pred, dtype: int64</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="k">if</span> <span class="n">check_inputs</span><span class="p">:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>            <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">exog_in_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="c1"># Initialize to prevent use-before-initialization warnings</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">steps</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="p">)</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">equivalent_indexes</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                <span class="n">equivalent_indexes</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="p">]</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">equivalent_indexes</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">equivalent_values</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="n">max_allowed_date</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="c1"># For every date in prediction_index, calculate the n offsets</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="n">offset_dates</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">prediction_index</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="n">selected_offsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="n">offset_date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="k">if</span> <span class="n">offset_date</span> <span class="o">&lt;=</span> <span class="n">max_allowed_date</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                    <span class="n">selected_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_date</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                <span class="n">date</span> <span class="o">=</span> <span class="n">offset_date</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="n">offset_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="n">offset_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_dates</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="c1"># Select the values of the time series corresponding to the each</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="c1"># offset date. If the offset date is not in the time series, the</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="c1"># value is set to NaN.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="n">equivalent_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="n">last_window</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">offset_dates</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>            <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="p">)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>            <span class="n">data</span><span class="o">=</span><span class="n">equivalent_values</span><span class="p">,</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;offset_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)],</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="c1"># Error if all values are missing</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="k">if</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                <span class="sa">f</span><span class="s2">&quot;All equivalent values are missing. This is caused by using &quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                <span class="sa">f</span><span class="s2">&quot;an offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) larger than the available data. &quot;</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="sa">f</span><span class="s2">&quot;Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="sa">f</span><span class="s2">&quot;size of `last_window`. In backtesting, this error may be &quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="sa">f</span><span class="s2">&quot;caused by using an `initial_train_size` too small.&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="p">)</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="c1"># Warning if equivalent values are missing</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">incomplete_offsets</span><span class="p">[</span><span class="n">incomplete_offsets</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                <span class="sa">f</span><span class="s2">&quot;Steps: </span><span class="si">{</span><span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                <span class="sa">f</span><span class="s2">&quot;are calculated with less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> `n_offsets`. &quot;</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                <span class="sa">f</span><span class="s2">&quot;To avoid this, increase the `last_window` size or decrease &quot;</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets`. The current configuration requires &quot;</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                <span class="sa">f</span><span class="s2">&quot;a total offset of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="n">MissingValuesWarning</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="p">)</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>        <span class="n">aggregate_values</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">aggregate_values</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.predict_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_interval</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conformal&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead and estimate prediction intervals using conformal
prediction method. Refer to the References section for additional
details on this method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Past values needed to select the
last equivalent dates according to the offset. If <code>last_window = None</code>,
the values stored in <code>self.last_window_</code> are used and the predictions
start immediately after the training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals.
Available options:
- 'conformal': Employs the conformal prediction split method for
interval estimation [1]_. Defaults to 'conformal'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;conformal&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code>(<span title="float">float</span>, <span title="list">list</span>, <span title="tuple">tuple</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level of the
prediction interval. Interpretation depends on the method used:
- If <code>float</code>, represents the nominal (expected) coverage (between 0
and 1). For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code>
percentiles.
- If <code>list</code> or <code>tuple</code>, defines the exact percentiles to compute,
which must be between 0 and 100 inclusive. For example, interval
of 95% should be as <code>interval = [2.5, 97.5]</code>.
- When using <code>method='conformal'</code>, the interval must be a float or
a list/tuple defining a symmetric interval. Defaults to [5, 95].</p>
              </div>
            </td>
            <td>
                  <code>[5, 95]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the
training data are used as proxy of prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected
based on the predicted values (binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Values predicted by the forecaster and their estimated interval.
- pred: predictions.
- lower_bound: lower bound of the interval.
- upper_bound: upper bound of the interval.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>method</code> is not 'conformal'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>interval</code> is not a float or a list/tuple defining a symmetric interval when using <code>method='conformal'</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] MAPIE - Model Agnostic Prediction Interval Estimator.
    https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">            pred  lower_bound  upper_bound</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">2022-01-15   7.0          6.0          8.0</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">2022-01-16   8.0          7.0          9.0</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">2022-01-17   9.0          8.0         10.0</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;conformal&quot;</span><span class="p">,</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">    Predict n steps ahead and estimate prediction intervals using conformal</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">    prediction method. Refer to the References section for additional</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">    details on this method.</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        steps (int): Number of steps to predict.</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        last_window (pandas Series, optional): Past values needed to select the</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">            last equivalent dates according to the offset. If `last_window = None`,</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">            the values stored in `self.last_window_` are used and the predictions</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">            start immediately after the training data. Defaults to None.</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        method (str, optional): Technique used to estimate prediction intervals.</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            Available options:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            interval estimation [1]_. Defaults to &#39;conformal&#39;.</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">        interval (float, list, tuple, optional): Confidence level of the</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">            prediction interval. Interpretation depends on the method used:</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">            percentiles.</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">            - If `list` or `tuple`, defines the exact percentiles to compute,</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            which must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">            of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">            - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">            a list/tuple defining a symmetric interval. Defaults to [5, 95].</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        use_in_sample_residuals (bool, optional): If `True`, residuals from the</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">            training data are used as proxy of prediction error to create predictions.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        use_binned_residuals (bool, optional): If `True`, residuals are selected</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            based on the predicted values (binned selection).</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        random_state (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        n_boot (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        pd.DataFrame: Values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            - pred: predictions.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">            - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">            - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        ValueError: If `method` is not &#39;conformal&#39;.</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        ValueError: If `interval` is not a float or a list/tuple defining a symmetric interval when using `method=&#39;conformal&#39;`.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a><span class="sd">    References:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        .. [1] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">            https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">        ...     data = np.arange(14, dtype=float),</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        ...     index = pd.date_range(start=&#39;2022-01-01&#39;, periods=14, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">        &gt;&gt;&gt; forecaster.predict_interval(steps=3, interval=0.8)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">                    pred  lower_bound  upper_bound</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">        2022-01-15   7.0          6.0          8.0</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">        2022-01-16   8.0          7.0          9.0</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="sd">        2022-01-17   9.0          8.0         10.0</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="sa">f</span><span class="s2">&quot;Method &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; is not supported. Only &#39;conformal&#39; is available.&quot;</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="p">)</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>    <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>        <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>        <span class="n">exog_in_</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="p">)</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="n">check_residuals_input</span><span class="p">(</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>        <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="n">in_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>        <span class="n">out_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>        <span class="n">in_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="n">out_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>    <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="c1"># Initialize to prevent use-before-initialization warnings</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">steps</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="p">)</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">equivalent_indexes</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>                <span class="n">equivalent_indexes</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="p">]</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>            <span class="n">equivalent_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">equivalent_indexes</span><span class="p">)</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>            <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">last_window_values</span><span class="p">[</span><span class="n">equivalent_indexes</span><span class="p">]</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">equivalent_values</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>            <span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">):</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>        <span class="n">max_allowed_date</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>        <span class="c1"># For every date in prediction_index, calculate the n offsets</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="n">offset_dates</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>        <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">prediction_index</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>            <span class="n">selected_offsets</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                <span class="n">offset_date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>                <span class="k">if</span> <span class="n">offset_date</span> <span class="o">&lt;=</span> <span class="n">max_allowed_date</span><span class="p">:</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>                    <span class="n">selected_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offset_date</span><span class="p">)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>                <span class="n">date</span> <span class="o">=</span> <span class="n">offset_date</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="n">offset_dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selected_offsets</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>        <span class="n">offset_dates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">offset_dates</span><span class="p">)</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="c1"># Select the values of the time series corresponding to the each</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="c1"># offset date. If the offset date is not in the time series, the</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="c1"># value is set to NaN.</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="n">equivalent_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>            <span class="n">last_window</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">offset_dates</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>            <span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>            <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="p">)</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">equivalent_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="n">data</span><span class="o">=</span><span class="n">equivalent_values</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;offset_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="p">)],</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="p">)</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="c1"># Error if all values are missing</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="k">if</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                <span class="sa">f</span><span class="s2">&quot;All equivalent values are missing. This is caused by using &quot;</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="sa">f</span><span class="s2">&quot;an offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">) larger than the available data. &quot;</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                <span class="sa">f</span><span class="s2">&quot;Try to decrease the size of the offset (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">) or increase the &quot;</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                <span class="sa">f</span><span class="s2">&quot;size of `last_window`. In backtesting, this error may be &quot;</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="sa">f</span><span class="s2">&quot;caused by using an `initial_train_size` too small.&quot;</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="p">)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="c1"># Warning if equivalent values are missing</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="n">incomplete_offsets</span> <span class="o">=</span> <span class="n">incomplete_offsets</span><span class="p">[</span><span class="n">incomplete_offsets</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                <span class="sa">f</span><span class="s2">&quot;Steps: </span><span class="si">{</span><span class="n">incomplete_offsets</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                <span class="sa">f</span><span class="s2">&quot;are calculated with less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2"> `n_offsets`. &quot;</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                <span class="sa">f</span><span class="s2">&quot;To avoid this, increase the `last_window` size or decrease &quot;</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets`. The current configuration requires &quot;</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>                <span class="sa">f</span><span class="s2">&quot;a total offset of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">n_offsets</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>                <span class="n">MissingValuesWarning</span><span class="p">,</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>            <span class="p">)</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>        <span class="n">aggregate_values</span> <span class="o">=</span> <span class="n">equivalent_values</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agg_func</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">aggregate_values</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>        <span class="n">correction_factor_by_bin</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>            <span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="p">}</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>        <span class="n">replace_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">predictions_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>        <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">replace_func</span><span class="p">(</span><span class="n">predictions_bin</span><span class="p">)</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">-</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">+</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">predictions</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">])</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>    <span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_in_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_in_sample_residuals</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set in-sample residuals in case they were not calculated during the
training process.</p>
<p>In-sample residuals are calculated as the difference between the true
values and the predictions made by the forecaster using the training
data. The following internal attributes are updated:</p>
<ul>
<li><code>in_sample_residuals_</code>: residuals stored in a numpy ndarray.</li>
<li><code>binner_intervals_</code>: intervals used to bin the residuals are calculated
using the quantiles of the predicted values.</li>
<li><code>in_sample_residuals_by_bin_</code>: residuals are binned according to the
predicted value they are associated with and stored in a dictionary, where
the keys are the intervals of the predicted values and the values are
the residuals associated with that range.</li>
</ul>
<p>A total of 10_000 residuals are stored in the attribute <code>in_sample_residuals_</code>.
If the number of residuals is greater than 10_000, a random sample of
10_000 residuals is stored. The number of residuals stored per bin is
limited to <code>10_000 // self.binner.n_bins_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for
reproducible output. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="Ignored">Ignored</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Not used, present here for API consistency by convention.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="sklearn.exceptions.NotFittedError">NotFittedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster has not been fitted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="IndexError">IndexError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the index range of <code>y</code> does not match the training range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2022-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Recompute and store residuals if needed</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_in_sample_residuals</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">(7,)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a><span class="sd">    Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">    training process.</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">    In-sample residuals are calculated as the difference between the true</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">    values and the predictions made by the forecaster using the training</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">    data. The following internal attributes are updated:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">    + `in_sample_residuals_`: residuals stored in a numpy ndarray.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    + `binner_intervals_`: intervals used to bin the residuals are calculated</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">    using the quantiles of the predicted values.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">    + `in_sample_residuals_by_bin_`: residuals are binned according to the</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">    predicted value they are associated with and stored in a dictionary, where</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">    the keys are the intervals of the predicted values and the values are</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">    the residuals associated with that range.</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">    A total of 10_000 residuals are stored in the attribute `in_sample_residuals_`.</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    If the number of residuals is greater than 10_000, a random sample of</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">    10_000 residuals is stored. The number of residuals stored per bin is</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">    limited to `10_000 // self.binner.n_bins_`.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        y (pandas Series): Training time series.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        random_state (int, optional): Sets a seed to the random sampling for</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">            reproducible output. Defaults to 123.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">        exog (Ignored): Not used, present here for API consistency by convention.</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        None</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        NotFittedError: If the forecaster has not been fitted.</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        IndexError: If the index range of `y` does not match the training range.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        ...     data=np.arange(14, dtype=float),</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=14, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        &gt;&gt;&gt; # Recompute and store residuals if needed</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_in_sample_residuals(y=data, random_state=123)</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        &gt;&gt;&gt; forecaster.in_sample_residuals_.shape</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">        (7,)</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>            <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>        <span class="p">)</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>    <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>    <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>        <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>    <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>            <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>            <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>            <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>            <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>            <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>        <span class="p">)</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.set_out_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_out_sample_residuals</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new values to the attribute <code>out_sample_residuals_</code>. Out of sample
residuals are meant to be calculated using observations that did not
participate in the training process. Two internal attributes are updated:</p>
<ul>
<li><code>out_sample_residuals_</code>: residuals stored in a numpy ndarray.</li>
<li><code>out_sample_residuals_by_bin_</code>: residuals are binned according to the
predicted value they are associated with and stored in a dictionary, where
the keys are the  intervals of the predicted values and the values are
the residuals associated with that range. If a bin binning is empty, it
is filled with a random sample of residuals from other bins. This is done
to ensure that all bins have at least one residual and can be used in the
prediction process.</li>
</ul>
<p>A total of 10_000 residuals are stored in the attribute <code>out_sample_residuals_</code>.
If the number of residuals is greater than 10_000, a random sample of
10_000 residuals is stored. The number of residuals stored per bin is
limited to <code>10_000 // self.binner.n_bins_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td>
                  <code>numpy ndarray, pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True values of the time series
from which the residuals have been calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td>
                  <code>numpy ndarray, pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values of the time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>append</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, new residuals are added to the once
already stored in the forecaster. If after appending the new
residuals, the limit of <code>10_000 // self.binner.n_bins_</code> values per
bin is reached, a random sample of residuals is stored. Defaults
to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for
reproducible output. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="sklearn.exceptions.NotFittedError">NotFittedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster has not been fitted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>y_true</code> or <code>y_pred</code> are not numpy arrays or pandas Series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>y_true</code> and <code>y_pred</code> have different lengths.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>y_true</code> and <code>y_pred</code> are pandas Series with different indexes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2022-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">preds</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_out_sample_residuals</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">preds</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">(7,)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">    Set new values to the attribute `out_sample_residuals_`. Out of sample</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">    residuals are meant to be calculated using observations that did not</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">    participate in the training process. Two internal attributes are updated:</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">    + `out_sample_residuals_`: residuals stored in a numpy ndarray.</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">    + `out_sample_residuals_by_bin_`: residuals are binned according to the</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">    predicted value they are associated with and stored in a dictionary, where</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    the keys are the  intervals of the predicted values and the values are</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">    the residuals associated with that range. If a bin binning is empty, it</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">    is filled with a random sample of residuals from other bins. This is done</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">    to ensure that all bins have at least one residual and can be used in the</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">    prediction process.</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">    A total of 10_000 residuals are stored in the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">    If the number of residuals is greater than 10_000, a random sample of</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    10_000 residuals is stored. The number of residuals stored per bin is</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">    limited to `10_000 // self.binner.n_bins_`.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        y_true (numpy ndarray, pandas Series): True values of the time series</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            from which the residuals have been calculated.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        y_pred (numpy ndarray, pandas Series): Predicted values of the time series.</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">        append (bool, optional): If `True`, new residuals are added to the once</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            already stored in the forecaster. If after appending the new</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            residuals, the limit of `10_000 // self.binner.n_bins_` values per</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">            bin is reached, a random sample of residuals is stored. Defaults</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">            to False.</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">        random_state (int, optional): Sets a seed to the random sampling for</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">            reproducible output. Defaults to 123.</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        None</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        NotFittedError: If the forecaster has not been fitted.</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        TypeError: If `y_true` or `y_pred` are not numpy arrays or pandas Series.</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        ValueError: If `y_true` and `y_pred` have different lengths.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        ValueError: If `y_true` and `y_pred` are pandas Series with different indexes.</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        ...     data=np.arange(21, dtype=float),</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">        ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=21, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">        &gt;&gt;&gt; preds = forecaster.predict(steps=7)</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        &gt;&gt;&gt; y_true = pd.Series(data[-7:].to_numpy(), index=preds.index)</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_out_sample_residuals(y_true=y_true, y_pred=preds)</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        &gt;&gt;&gt; forecaster.out_sample_residuals_.shape</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">        (7,)</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>            <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>        <span class="p">)</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>        <span class="p">)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>            <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>        <span class="p">)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="p">)</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>    <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>    <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>    <span class="p">)</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>    <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="p">{}</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>    <span class="p">)</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                    <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                <span class="p">)</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>            <span class="n">sample</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>            <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>    <span class="p">)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span><span class="p">:</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>            <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>    <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>    <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>            <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>            <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>        <span class="p">)</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>        <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>            <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>                <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>            <span class="p">)</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000</span><span class="p">:</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>        <span class="p">)</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterEquivalentDate.summary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">summary</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Show forecaster information.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterEquivalentDate</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2022-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterEquivalentDate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">============================</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_equivalent_date.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">    Show forecaster information.</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        None</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterEquivalentDate</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">        &gt;&gt;&gt; data = pd.Series(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        ...     data=np.arange(14, dtype=float),</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">        ...     index=pd.date_range(start=&quot;2022-01-01&quot;, periods=14, freq=&quot;D&quot;),</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterEquivalentDate(offset=7)</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=data)</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">        &gt;&gt;&gt; forecaster.summary()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">        ============================</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive" class="doc doc-heading">
            <code>ForecasterRecursive</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ForecasterBase (spotforecast2_safe.forecaster.base.ForecasterBase)" href="#spotforecast2_safe.forecaster.base.ForecasterBase">ForecasterBase</a></code></p>



        <p>Recursive autoregressive forecaster for scikit-learn compatible estimators.</p>
<p>This class turns any estimator compatible with the scikit-learn API into a
recursive autoregressive (multi-step) forecaster. The forecaster learns to predict
future values by using lagged values of the target variable and optional exogenous
features. Predictions are made iteratively, where each step uses previous predictions
as input for the next step (recursive strategy).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn compatible estimator for regression. If None, a default
estimator will be initialized. Can also be passed via regressor parameter.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="typing.List">List</span>[<span title="int">int</span>], <span title="numpy.ndarray">ndarray</span>, <span title="range">range</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lagged values of the target variable to use as predictors. Can be an
integer (uses lags from 1 to lags), list of integers, numpy array, or range.
At least one of lags or window_features must be provided. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_features</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="object">object</span>, <span title="typing.List">List</span>[<span title="object">object</span>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of window feature objects to compute features from the
target variable. Each object must implement transform_batch() method.
At least one of lags or window_features must be provided. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer_y</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer object for the target variable. Must implement fit()
and transform() methods. Applied before training and predictions.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer_exog</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer object for exogenous variables. Must implement
fit() and transform() methods. Applied before training and predictions.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weight_func</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to compute sample weights for training. Must accept an
index and return an array of weights. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing to apply to the target variable.
Must be a positive integer. Differencing is applied before creating lags.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of additional keyword arguments to pass to the estimator's
fit() method. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>binner_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of keyword arguments for QuantileBinner used in
probabilistic predictions. Defaults to {'n_bins': 10, 'method': 'linear'}.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_id</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="int">int</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier for the forecaster instance. Can be a string or
integer. Used for tracking and logging purposes. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regressor</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative parameter name for estimator. If provided, used instead
of estimator. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.estimator">estimator</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted scikit-learn estimator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.lags">lags</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lag indices used in the model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.lags_names">lags_names</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of lag features (e.g., ['lag_1', 'lag_2']).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.window_features">window_features</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of window feature transformers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.window_features_names">window_features_names</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.window_size">window_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum window size needed (max of lags and window features).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.transformer_y">transformer_y</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer for target variable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.transformer_exog">transformer_exog</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer for exogenous variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.weight_func">weight_func</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function for sample weighting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.differentiation">differentiation</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing applied.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.differentiator">differentiator</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesDifferentiator instance if differencing is used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.is_fitted">is_fitted</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if forecaster has been fitted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.fit_date">fit_date</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp of the last fit operation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.last_window_">last_window_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last window_size observations from training data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.index_type_">index_type_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of index in training data (RangeIndex or DatetimeIndex).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.index_freq_">index_freq_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency of DatetimeIndex if applicable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.training_range_">training_range_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First and last index values of training data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.series_name_in_">series_name_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the target series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.exog_in_">exog_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean indicating if exogenous variables were used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.exog_names_in_">exog_names_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of exogenous variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.exog_type_in_">exog_type_in_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of exogenous input (Series or DataFrame).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.X_train_features_names_out_">X_train_features_names_out_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of all training features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.in_sample_residuals_">in_sample_residuals_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals from training set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.in_sample_residuals_by_bin_">in_sample_residuals_by_bin_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals grouped by bins for probabilistic pred.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.forecaster_id">forecaster_id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier for the forecaster instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Either lags or window_features (or both) must be provided during initialization.</li>
<li>The forecaster uses a recursive strategy where each multi-step prediction
  depends on previous predictions within the same forecast horizon.</li>
<li>Exogenous variables must have the same index as the target variable and must
  be available for the entire prediction horizon.</li>
<li>The forecaster supports point predictions, prediction intervals, bootstrapping,
  quantile predictions, and probabilistic forecasts via conformal methods.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a basic forecaster with lags:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with window features and transformations:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">7</span><span class="p">)],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">transformer_y</span><span class="o">=</span><span class="n">StandardScaler</span><span class="p">(),</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">differentiation</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with exogenous variables:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">forecaster_id</span><span class="o">=</span><span class="s1">&#39;my_forecaster&#39;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_future</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">105</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog_future</span><span class="p">)</span>
</code></pre></div>
    <p>Create a forecaster with probabilistic prediction configuration:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">GradientBoostingRegressor</span><span class="p">(),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">binner_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_bins&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">}</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">  50</a></span>
<span class="normal"><a href="#__codelineno-0-51">  51</a></span>
<span class="normal"><a href="#__codelineno-0-52">  52</a></span>
<span class="normal"><a href="#__codelineno-0-53">  53</a></span>
<span class="normal"><a href="#__codelineno-0-54">  54</a></span>
<span class="normal"><a href="#__codelineno-0-55">  55</a></span>
<span class="normal"><a href="#__codelineno-0-56">  56</a></span>
<span class="normal"><a href="#__codelineno-0-57">  57</a></span>
<span class="normal"><a href="#__codelineno-0-58">  58</a></span>
<span class="normal"><a href="#__codelineno-0-59">  59</a></span>
<span class="normal"><a href="#__codelineno-0-60">  60</a></span>
<span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span>
<span class="normal"><a href="#__codelineno-0-2015">2015</a></span>
<span class="normal"><a href="#__codelineno-0-2016">2016</a></span>
<span class="normal"><a href="#__codelineno-0-2017">2017</a></span>
<span class="normal"><a href="#__codelineno-0-2018">2018</a></span>
<span class="normal"><a href="#__codelineno-0-2019">2019</a></span>
<span class="normal"><a href="#__codelineno-0-2020">2020</a></span>
<span class="normal"><a href="#__codelineno-0-2021">2021</a></span>
<span class="normal"><a href="#__codelineno-0-2022">2022</a></span>
<span class="normal"><a href="#__codelineno-0-2023">2023</a></span>
<span class="normal"><a href="#__codelineno-0-2024">2024</a></span>
<span class="normal"><a href="#__codelineno-0-2025">2025</a></span>
<span class="normal"><a href="#__codelineno-0-2026">2026</a></span>
<span class="normal"><a href="#__codelineno-0-2027">2027</a></span>
<span class="normal"><a href="#__codelineno-0-2028">2028</a></span>
<span class="normal"><a href="#__codelineno-0-2029">2029</a></span>
<span class="normal"><a href="#__codelineno-0-2030">2030</a></span>
<span class="normal"><a href="#__codelineno-0-2031">2031</a></span>
<span class="normal"><a href="#__codelineno-0-2032">2032</a></span>
<span class="normal"><a href="#__codelineno-0-2033">2033</a></span>
<span class="normal"><a href="#__codelineno-0-2034">2034</a></span>
<span class="normal"><a href="#__codelineno-0-2035">2035</a></span>
<span class="normal"><a href="#__codelineno-0-2036">2036</a></span>
<span class="normal"><a href="#__codelineno-0-2037">2037</a></span>
<span class="normal"><a href="#__codelineno-0-2038">2038</a></span>
<span class="normal"><a href="#__codelineno-0-2039">2039</a></span>
<span class="normal"><a href="#__codelineno-0-2040">2040</a></span>
<span class="normal"><a href="#__codelineno-0-2041">2041</a></span>
<span class="normal"><a href="#__codelineno-0-2042">2042</a></span>
<span class="normal"><a href="#__codelineno-0-2043">2043</a></span>
<span class="normal"><a href="#__codelineno-0-2044">2044</a></span>
<span class="normal"><a href="#__codelineno-0-2045">2045</a></span>
<span class="normal"><a href="#__codelineno-0-2046">2046</a></span>
<span class="normal"><a href="#__codelineno-0-2047">2047</a></span>
<span class="normal"><a href="#__codelineno-0-2048">2048</a></span>
<span class="normal"><a href="#__codelineno-0-2049">2049</a></span>
<span class="normal"><a href="#__codelineno-0-2050">2050</a></span>
<span class="normal"><a href="#__codelineno-0-2051">2051</a></span>
<span class="normal"><a href="#__codelineno-0-2052">2052</a></span>
<span class="normal"><a href="#__codelineno-0-2053">2053</a></span>
<span class="normal"><a href="#__codelineno-0-2054">2054</a></span>
<span class="normal"><a href="#__codelineno-0-2055">2055</a></span>
<span class="normal"><a href="#__codelineno-0-2056">2056</a></span>
<span class="normal"><a href="#__codelineno-0-2057">2057</a></span>
<span class="normal"><a href="#__codelineno-0-2058">2058</a></span>
<span class="normal"><a href="#__codelineno-0-2059">2059</a></span>
<span class="normal"><a href="#__codelineno-0-2060">2060</a></span>
<span class="normal"><a href="#__codelineno-0-2061">2061</a></span>
<span class="normal"><a href="#__codelineno-0-2062">2062</a></span>
<span class="normal"><a href="#__codelineno-0-2063">2063</a></span>
<span class="normal"><a href="#__codelineno-0-2064">2064</a></span>
<span class="normal"><a href="#__codelineno-0-2065">2065</a></span>
<span class="normal"><a href="#__codelineno-0-2066">2066</a></span>
<span class="normal"><a href="#__codelineno-0-2067">2067</a></span>
<span class="normal"><a href="#__codelineno-0-2068">2068</a></span>
<span class="normal"><a href="#__codelineno-0-2069">2069</a></span>
<span class="normal"><a href="#__codelineno-0-2070">2070</a></span>
<span class="normal"><a href="#__codelineno-0-2071">2071</a></span>
<span class="normal"><a href="#__codelineno-0-2072">2072</a></span>
<span class="normal"><a href="#__codelineno-0-2073">2073</a></span>
<span class="normal"><a href="#__codelineno-0-2074">2074</a></span>
<span class="normal"><a href="#__codelineno-0-2075">2075</a></span>
<span class="normal"><a href="#__codelineno-0-2076">2076</a></span>
<span class="normal"><a href="#__codelineno-0-2077">2077</a></span>
<span class="normal"><a href="#__codelineno-0-2078">2078</a></span>
<span class="normal"><a href="#__codelineno-0-2079">2079</a></span>
<span class="normal"><a href="#__codelineno-0-2080">2080</a></span>
<span class="normal"><a href="#__codelineno-0-2081">2081</a></span>
<span class="normal"><a href="#__codelineno-0-2082">2082</a></span>
<span class="normal"><a href="#__codelineno-0-2083">2083</a></span>
<span class="normal"><a href="#__codelineno-0-2084">2084</a></span>
<span class="normal"><a href="#__codelineno-0-2085">2085</a></span>
<span class="normal"><a href="#__codelineno-0-2086">2086</a></span>
<span class="normal"><a href="#__codelineno-0-2087">2087</a></span>
<span class="normal"><a href="#__codelineno-0-2088">2088</a></span>
<span class="normal"><a href="#__codelineno-0-2089">2089</a></span>
<span class="normal"><a href="#__codelineno-0-2090">2090</a></span>
<span class="normal"><a href="#__codelineno-0-2091">2091</a></span>
<span class="normal"><a href="#__codelineno-0-2092">2092</a></span>
<span class="normal"><a href="#__codelineno-0-2093">2093</a></span>
<span class="normal"><a href="#__codelineno-0-2094">2094</a></span>
<span class="normal"><a href="#__codelineno-0-2095">2095</a></span>
<span class="normal"><a href="#__codelineno-0-2096">2096</a></span>
<span class="normal"><a href="#__codelineno-0-2097">2097</a></span>
<span class="normal"><a href="#__codelineno-0-2098">2098</a></span>
<span class="normal"><a href="#__codelineno-0-2099">2099</a></span>
<span class="normal"><a href="#__codelineno-0-2100">2100</a></span>
<span class="normal"><a href="#__codelineno-0-2101">2101</a></span>
<span class="normal"><a href="#__codelineno-0-2102">2102</a></span>
<span class="normal"><a href="#__codelineno-0-2103">2103</a></span>
<span class="normal"><a href="#__codelineno-0-2104">2104</a></span>
<span class="normal"><a href="#__codelineno-0-2105">2105</a></span>
<span class="normal"><a href="#__codelineno-0-2106">2106</a></span>
<span class="normal"><a href="#__codelineno-0-2107">2107</a></span>
<span class="normal"><a href="#__codelineno-0-2108">2108</a></span>
<span class="normal"><a href="#__codelineno-0-2109">2109</a></span>
<span class="normal"><a href="#__codelineno-0-2110">2110</a></span>
<span class="normal"><a href="#__codelineno-0-2111">2111</a></span>
<span class="normal"><a href="#__codelineno-0-2112">2112</a></span>
<span class="normal"><a href="#__codelineno-0-2113">2113</a></span>
<span class="normal"><a href="#__codelineno-0-2114">2114</a></span>
<span class="normal"><a href="#__codelineno-0-2115">2115</a></span>
<span class="normal"><a href="#__codelineno-0-2116">2116</a></span>
<span class="normal"><a href="#__codelineno-0-2117">2117</a></span>
<span class="normal"><a href="#__codelineno-0-2118">2118</a></span>
<span class="normal"><a href="#__codelineno-0-2119">2119</a></span>
<span class="normal"><a href="#__codelineno-0-2120">2120</a></span>
<span class="normal"><a href="#__codelineno-0-2121">2121</a></span>
<span class="normal"><a href="#__codelineno-0-2122">2122</a></span>
<span class="normal"><a href="#__codelineno-0-2123">2123</a></span>
<span class="normal"><a href="#__codelineno-0-2124">2124</a></span>
<span class="normal"><a href="#__codelineno-0-2125">2125</a></span>
<span class="normal"><a href="#__codelineno-0-2126">2126</a></span>
<span class="normal"><a href="#__codelineno-0-2127">2127</a></span>
<span class="normal"><a href="#__codelineno-0-2128">2128</a></span>
<span class="normal"><a href="#__codelineno-0-2129">2129</a></span>
<span class="normal"><a href="#__codelineno-0-2130">2130</a></span>
<span class="normal"><a href="#__codelineno-0-2131">2131</a></span>
<span class="normal"><a href="#__codelineno-0-2132">2132</a></span>
<span class="normal"><a href="#__codelineno-0-2133">2133</a></span>
<span class="normal"><a href="#__codelineno-0-2134">2134</a></span>
<span class="normal"><a href="#__codelineno-0-2135">2135</a></span>
<span class="normal"><a href="#__codelineno-0-2136">2136</a></span>
<span class="normal"><a href="#__codelineno-0-2137">2137</a></span>
<span class="normal"><a href="#__codelineno-0-2138">2138</a></span>
<span class="normal"><a href="#__codelineno-0-2139">2139</a></span>
<span class="normal"><a href="#__codelineno-0-2140">2140</a></span>
<span class="normal"><a href="#__codelineno-0-2141">2141</a></span>
<span class="normal"><a href="#__codelineno-0-2142">2142</a></span>
<span class="normal"><a href="#__codelineno-0-2143">2143</a></span>
<span class="normal"><a href="#__codelineno-0-2144">2144</a></span>
<span class="normal"><a href="#__codelineno-0-2145">2145</a></span>
<span class="normal"><a href="#__codelineno-0-2146">2146</a></span>
<span class="normal"><a href="#__codelineno-0-2147">2147</a></span>
<span class="normal"><a href="#__codelineno-0-2148">2148</a></span>
<span class="normal"><a href="#__codelineno-0-2149">2149</a></span>
<span class="normal"><a href="#__codelineno-0-2150">2150</a></span>
<span class="normal"><a href="#__codelineno-0-2151">2151</a></span>
<span class="normal"><a href="#__codelineno-0-2152">2152</a></span>
<span class="normal"><a href="#__codelineno-0-2153">2153</a></span>
<span class="normal"><a href="#__codelineno-0-2154">2154</a></span>
<span class="normal"><a href="#__codelineno-0-2155">2155</a></span>
<span class="normal"><a href="#__codelineno-0-2156">2156</a></span>
<span class="normal"><a href="#__codelineno-0-2157">2157</a></span>
<span class="normal"><a href="#__codelineno-0-2158">2158</a></span>
<span class="normal"><a href="#__codelineno-0-2159">2159</a></span>
<span class="normal"><a href="#__codelineno-0-2160">2160</a></span>
<span class="normal"><a href="#__codelineno-0-2161">2161</a></span>
<span class="normal"><a href="#__codelineno-0-2162">2162</a></span>
<span class="normal"><a href="#__codelineno-0-2163">2163</a></span>
<span class="normal"><a href="#__codelineno-0-2164">2164</a></span>
<span class="normal"><a href="#__codelineno-0-2165">2165</a></span>
<span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">class</span><span class="w"> </span><span class="nc">ForecasterRecursive</span><span class="p">(</span><span class="n">ForecasterBase</span><span class="p">):</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Recursive autoregressive forecaster for scikit-learn compatible estimators.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    This class turns any estimator compatible with the scikit-learn API into a</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    recursive autoregressive (multi-step) forecaster. The forecaster learns to predict</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    future values by using lagged values of the target variable and optional exogenous</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    features. Predictions are made iteratively, where each step uses previous predictions</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    as input for the next step (recursive strategy).</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        estimator: Scikit-learn compatible estimator for regression. If None, a default</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            estimator will be initialized. Can also be passed via regressor parameter.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        lags: Lagged values of the target variable to use as predictors. Can be an</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            integer (uses lags from 1 to lags), list of integers, numpy array, or range.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            At least one of lags or window_features must be provided. Defaults to None.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        window_features: List of window feature objects to compute features from the</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            target variable. Each object must implement transform_batch() method.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            At least one of lags or window_features must be provided. Defaults to None.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        transformer_y: Transformer object for the target variable. Must implement fit()</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            and transform() methods. Applied before training and predictions.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        transformer_exog: Transformer object for exogenous variables. Must implement</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            fit() and transform() methods. Applied before training and predictions.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        weight_func: Function to compute sample weights for training. Must accept an</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            index and return an array of weights. Defaults to None.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        differentiation: Order of differencing to apply to the target variable.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            Must be a positive integer. Differencing is applied before creating lags.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        fit_kwargs: Dictionary of additional keyword arguments to pass to the estimator&#39;s</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            fit() method. Defaults to None.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        binner_kwargs: Dictionary of keyword arguments for QuantileBinner used in</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            probabilistic predictions. Defaults to {&#39;n_bins&#39;: 10, &#39;method&#39;: &#39;linear&#39;}.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        forecaster_id: Identifier for the forecaster instance. Can be a string or</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">            integer. Used for tracking and logging purposes. Defaults to None.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        regressor: Alternative parameter name for estimator. If provided, used instead</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            of estimator. Defaults to None.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        estimator: Fitted scikit-learn estimator.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        lags: Lag indices used in the model.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        lags_names: Names of lag features (e.g., [&#39;lag_1&#39;, &#39;lag_2&#39;]).</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        window_features: List of window feature transformers.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        window_features_names: Names of window features.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        window_size: Maximum window size needed (max of lags and window features).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        transformer_y: Transformer for target variable.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        transformer_exog: Transformer for exogenous variables.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        weight_func: Function for sample weighting.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        differentiation: Order of differencing applied.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        differentiator: TimeSeriesDifferentiator instance if differencing is used.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        is_fitted: Boolean indicating if forecaster has been fitted.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        fit_date: Timestamp of the last fit operation.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        last_window_: Last window_size observations from training data.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        index_type_: Type of index in training data (RangeIndex or DatetimeIndex).</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        index_freq_: Frequency of DatetimeIndex if applicable.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        training_range_: First and last index values of training data.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        series_name_in_: Name of the target series.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        exog_in_: Boolean indicating if exogenous variables were used in training.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        exog_names_in_: Names of exogenous variables.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        exog_type_in_: Type of exogenous input (Series or DataFrame).</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        X_train_features_names_out_: Names of all training features.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        in_sample_residuals_: Residuals from training set.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        in_sample_residuals_by_bin_: Residuals grouped by bins for probabilistic pred.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        forecaster_id: Identifier for the forecaster instance.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        - Either lags or window_features (or both) must be provided during initialization.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        - The forecaster uses a recursive strategy where each multi-step prediction</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">          depends on previous predictions within the same forecast horizon.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        - Exogenous variables must have the same index as the target variable and must</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">          be available for the entire prediction horizon.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        - The forecaster supports point predictions, prediction intervals, bootstrapping,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">          quantile predictions, and probabilistic forecasts via conformal methods.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Create a basic forecaster with lags:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        ...     lags=10</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Create a forecaster with window features and transformations:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        &gt;&gt;&gt; from sklearn.preprocessing import StandardScaler</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        ...     estimator=RandomForestRegressor(n_estimators=100),</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        ...     lags=[1, 7, 30],</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=7)],</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        ...     transformer_y=StandardScaler(),</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        ...     differentiation=1</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=10)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Create a forecaster with exogenous variables:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;target&#39;)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(100)}, index=y.index)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        ...     estimator=Ridge(),</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        ...     lags=7,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        ...     forecaster_id=&#39;my_forecaster&#39;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y, exog)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        &gt;&gt;&gt; exog_future = pd.DataFrame(</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        ...     {&#39;temp&#39;: np.random.randn(5)},</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        ...     index=pd.RangeIndex(start=100, stop=105)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5, exog=exog_future)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        Create a forecaster with probabilistic prediction configuration:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import GradientBoostingRegressor</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        ...     estimator=GradientBoostingRegressor(),</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ...     lags=14,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        ...     binner_kwargs={&#39;n_bins&#39;: 15, &#39;method&#39;: &#39;linear&#39;}</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(steps=5)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">lags</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">window_features</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">transformer_y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">transformer_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">weight_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">binner_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">forecaster_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">initialize_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">regressor</span><span class="p">))</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="o">=</span> <span class="n">transformer_y</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span> <span class="o">=</span> <span class="n">transformer_exog</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="o">=</span> <span class="n">weight_func</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe</span><span class="w"> </span><span class="kn">import</span> <span class="n">__version__</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="n">__version__</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span> <span class="o">=</span> <span class="n">forecaster_id</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">=</span> <span class="s2">&quot;binned&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="p">(</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">initialize_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="s2">&quot;At least one of the arguments `lags` or `window_features` &quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="s2">&quot;must be different from None. This is required to create the &quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="s2">&quot;predictors used in training the forecaster.&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="p">[</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="n">ws</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">]</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                <span class="k">if</span> <span class="n">ws</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="p">]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="p">]</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">initialize_weights</span><span class="p">(</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">weight_func</span><span class="o">=</span><span class="n">weight_func</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">series_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="sa">f</span><span class="s2">&quot;Argument `differentiation` must be an integer equal to or &quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="sa">f</span><span class="s2">&quot;greater than 1. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="n">TimeSeriesDifferentiator</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>                <span class="n">order</span><span class="o">=</span><span class="n">differentiation</span>  <span class="c1"># , window_size=self.window_size # TODO: TimeSeriesDifferentiator in preprocessing created only takes order, add window_size if needed</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="n">fit_kwargs</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="n">binner_kwargs</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="k">if</span> <span class="n">binner_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>                <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">}</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="o">=</span> <span class="n">QuantileBinner</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>  <span class="c1"># single-series | global</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>  <span class="c1"># recursive | direct | deep_learning</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="p">],</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="p">}</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Information displayed when a ForecasterRecursive object is printed.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            str: String representation of the forecaster with key information about its configuration and state.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            &gt;&gt;&gt; print(forecaster)  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            =========================</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">            ForecasterRecursive</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            =========================</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            Estimator: LinearRegression</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            Lags: [1, 2, 3]</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            Window features: []</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">            Window size: 3</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            Series name: None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            Exogenous included: False</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            Exogenous names: None</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            Transformer for y: None</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            Transformer for exog: None</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            Weight function included: False</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            Differentiation order: None</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            Training range: None</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            Training index type: None</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            Training index frequency: None</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            Estimator parameters: {...}</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            fit_kwargs: {...}</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            Creation date: ...</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            Last fit date: None</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            spotforecast version: ...</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            Python version: ...</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            Forecaster id: None</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="sa">f</span><span class="s2">&quot;Estimator: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="sa">f</span><span class="s2">&quot;Lags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="sa">f</span><span class="s2">&quot;Window features: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="sa">f</span><span class="s2">&quot;Exogenous included: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="sa">f</span><span class="s2">&quot;Exogenous names: </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="sa">f</span><span class="s2">&quot;Transformer for y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="sa">f</span><span class="s2">&quot;Transformer for exog: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="sa">f</span><span class="s2">&quot;Weight function included: </span><span class="si">{</span><span class="kc">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">False</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation order: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="sa">f</span><span class="s2">&quot;Estimator parameters: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="sa">f</span><span class="s2">&quot;fit_kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        HTML representation of the object.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            HTML string representation of the forecaster.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            &gt;&gt;&gt; forecaster._repr_html_()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            &#39;&lt;div class=&quot;container-...&quot;&gt;...&lt;/div&gt;&#39;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Estimator:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Lags:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window features:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Series name:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Exogenous included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Weight function included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation order:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Creation date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Last fit date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;spotforecast version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Python version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Forecaster id:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="s2">                &lt;summary&gt;Exogenous Variables&lt;/summary&gt;</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="s2">                    </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="s2">                &lt;summary&gt;Data Transformations&lt;/summary&gt;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Transformer for y:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Transformer for exog:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="s2">                &lt;summary&gt;Training Information&lt;/summary&gt;</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training range:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index type:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Training index frequency:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="s2">                &lt;summary&gt;Estimator Parameters&lt;/summary&gt;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="s2">                    </span><span class="si">{</span><span class="n">params</span><span class="si">}</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="s2">            &lt;details&gt;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="s2">                &lt;summary&gt;Fit Kwargs&lt;/summary&gt;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="s2">                    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        Only sets __spotforecast_tags__ if not present, preserving custom tags.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__spotforecast_tags__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                    <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                    <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                    <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                    <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                    <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="p">}</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_lags</span><span class="p">(</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">train_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        Create lagged predictors and aligned target values.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            y: Target values used to build lag features. Expected shape is</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">                (n_samples,) or (n_samples, 1).</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">            X_as_pandas: If True, returns lagged features as a pandas DataFrame.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            train_index: Index to use for the lagged feature DataFrame when</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">                `X_as_pandas` is True.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">                - X_data: Lagged predictors with shape (n_rows, n_lags) or None</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">                  if no lags are configured.</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">                - y_data: Target values aligned to the lagged predictors with</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">                  shape (n_rows,).</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            ValueError: If `X_as_pandas` is True but `train_index` is not provided.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">            ValueError: If the length of `y` is not sufficient to create the</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">                specified lags.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(lags=3)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">            &gt;&gt;&gt; y = np.arange(10)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            &gt;&gt;&gt; train_index = pd.RangeIndex(start=3, stop=10)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            &gt;&gt;&gt; X_data, y_data = forecaster._create_lags(y=y, X_as_pandas=True, train_index=train_index)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_data, pd.DataFrame)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">            True</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">            &gt;&gt;&gt; X_data.shape</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">            (7, 3)</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            &gt;&gt;&gt; y_data.shape</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">            (7,)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">if</span> <span class="n">X_as_pandas</span> <span class="ow">and</span> <span class="n">train_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                <span class="s2">&quot;If `X_as_pandas` is True, `train_index` must be provided.&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="p">)</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>                <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>                <span class="sa">f</span><span class="s2">&quot;needed by the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>                <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>                <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="p">)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">X_data</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="c1"># y = y.ravel() # Assuming y is already raveled</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="c1"># Using stride_tricks for sliding window</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="n">y_strided</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">sliding_window_view</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">)[</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="p">:</span><span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="p">]</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="n">X_data</span> <span class="o">=</span> <span class="n">y_strided</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                <span class="n">X_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">X_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                <span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">y_data</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="k">return</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_window_features</span><span class="p">(</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">train_index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        Generate window features from the target series.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">            y: Target series used to compute window features. Must be a pandas</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">                Series with an index aligned to `train_index` after trimming.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">            train_index: Index for the training rows to align the window features.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">            X_as_pandas: If True, keeps each window feature matrix as a pandas</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">                DataFrame; otherwise converts to NumPy arrays.</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">                - X_train_window_features: List of window feature matrices, one</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">                  per window feature transformer.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">                - X_train_window_features_names_out_: List of feature names for</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">                  all generated window features.</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            TypeError: If any window feature&#39;s `transform_batch` method does not</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">                return a pandas DataFrame.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">            ValueError: If the output DataFrame from any window feature does not</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">                have the same number of rows as `train_index` or if the index</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">                does not match `train_index`.</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">            &gt;&gt;&gt; train_index = y.index[3:]  # Assuming window_size is 3</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">            &gt;&gt;&gt; X_train_window_features, feature_names = forecaster._create_window_features(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">            ...     y=y,</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">            ...     train_index=train_index,</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">            ...     X_as_pandas=True</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train_window_features[0], pd.DataFrame)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">            True</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">            &gt;&gt;&gt; X_train_window_features[0].shape[0] == len(train_index)</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">            True</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">            &gt;&gt;&gt; (X_train_window_features[0].index == train_index).all()</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">            True</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">len_train_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_index</span><span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">X_train_window_features</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">:</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">transform_batch</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a pandas DataFrame.&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>                <span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">len_train_index</span><span class="p">:]</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span> <span class="o">==</span> <span class="n">len_train_index</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same number of rows as &quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`: </span><span class="si">{</span><span class="n">len_train_index</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">train_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                    <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same index as &quot;</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                    <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`.&quot;</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="n">X_train_window_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">X_train_window_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">return</span> <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="p">]:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create training predictors and target values.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">            y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">                Optional exogenous variables for training. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">                Must have the same index as `y` and cover the same time range.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">                - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">                - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">                - X_train_features_names_out_: List of all predictor feature names.</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">                - lags_names: List of lag feature names.</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">                - window_features_names: List of window feature names.</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">                - exog_names_in_: List of exogenous variable names (if exogenous variables are used).</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">                - exog_dtypes_in_: Dictionary of input data types for exogenous variables.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">                - exog_dtypes_out_: Dictionary of output data types for exogenous variables after transformation (if exogenous variables are used).</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">            ValueError: If the length of `y` is not sufficient to create the specified lags and window features.</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">            ValueError: If `exog` is provided but does not have the same index as `y` or does not cover the same time range.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">            ValueError: If `exog` is provided but contains data types that are not supported after transformation.</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">            &gt;&gt;&gt; (X_train, y_train, exog_names_in_, window_features_names,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            ...  exog_names_out, feature_names, exog_dtypes_in_,</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">            ...  exog_dtypes_out_) = forecaster._create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            True</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">            True</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            &gt;&gt;&gt; feature_names == forecaster.lags_names + window_features_names + exog_names_out</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">            True</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="sa">f</span><span class="s2">&quot;Length of `y` must be greater than the maximum window size &quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                <span class="sa">f</span><span class="s2">&quot;needed by the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                <span class="sa">f</span><span class="s2">&quot;    Length `y`: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="sa">f</span><span class="s2">&quot;    Lags window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="sa">f</span><span class="s2">&quot;    Window features window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">fit_transformer</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">df</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">fit</span><span class="o">=</span><span class="n">fit_transformer</span><span class="p">,</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>        <span class="p">)</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="n">y_values</span><span class="p">,</span> <span class="n">y_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="k">if</span> <span class="n">y_values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="n">y_values</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="n">train_index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                <span class="n">y_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                <span class="n">y_values</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>        <span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="n">X_as_pandas</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>            <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>            <span class="n">_</span><span class="p">,</span> <span class="n">exog_index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>                <span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`exog`&quot;</span><span class="p">,</span> <span class="n">ignore_freq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>            <span class="p">)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>            <span class="n">len_y_original</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>            <span class="n">len_train</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_index</span><span class="p">)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="n">len_exog</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_y_original</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_train</span><span class="p">:</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                    <span class="sa">f</span><span class="s2">&quot;Length mismatch for exogenous variables. Expected either:</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                    <span class="sa">f</span><span class="s2">&quot;  - Full length matching `y`: </span><span class="si">{</span><span class="n">len_y_original</span><span class="si">}</span><span class="s2"> observations, OR</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                    <span class="sa">f</span><span class="s2">&quot;  - Pre-aligned length: </span><span class="si">{</span><span class="n">len_train</span><span class="si">}</span><span class="s2"> observations (y length - window_size)</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                    <span class="sa">f</span><span class="s2">&quot;Got: </span><span class="si">{</span><span class="n">len_exog</span><span class="si">}</span><span class="s2"> observations.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                    <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="p">)</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>            <span class="k">if</span> <span class="n">len_exog</span> <span class="o">==</span> <span class="n">len_y_original</span><span class="p">:</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span> <span class="o">==</span> <span class="n">y_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>                        <span class="s2">&quot;When `exog` has the same length as `y`, the index of &quot;</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>                        <span class="s2">&quot;`exog` must be aligned with the index of `y` &quot;</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>                        <span class="s2">&quot;to ensure the correct alignment of values.&quot;</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>                    <span class="p">)</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>                <span class="c1"># Standard case: exog covers full y range, trim by window_size</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:,</span> <span class="p">:]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">exog_index</span> <span class="o">==</span> <span class="n">train_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>                        <span class="s2">&quot;When `exog` already starts after the first `window_size` &quot;</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>                        <span class="s2">&quot;observations, its index must be aligned with the index &quot;</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>                        <span class="s2">&quot;of `y` starting from `window_size`.&quot;</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>                    <span class="p">)</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>            <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>            <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="n">df</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                <span class="n">fit</span><span class="o">=</span><span class="n">fit_transformer</span><span class="p">,</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>            <span class="p">)</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>            <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>            <span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>            <span class="n">X_as_pandas</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>                <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="c1"># Create lags</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="c1"># Note: y_values might have NaNs from differentiation.</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="c1"># TODO: check if _create_lags handles this!</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="n">X_train_lags</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_lags</span><span class="p">(</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="n">X_as_pandas</span><span class="p">,</span> <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="p">)</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="k">if</span> <span class="n">X_train_lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_lags</span><span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>        <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>            <span class="n">n_diff</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>                <span class="n">y_vals_for_wf</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                <span class="n">y_index_for_wf</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                <span class="n">y_vals_for_wf</span> <span class="o">=</span> <span class="n">y_values</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                <span class="n">y_index_for_wf</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:]</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="n">y_window_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_vals_for_wf</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">y_index_for_wf</span><span class="p">)</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>            <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_create_window_features</span><span class="p">(</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="n">y</span><span class="o">=</span><span class="n">y_window_features</span><span class="p">,</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                    <span class="n">X_as_pandas</span><span class="o">=</span><span class="n">X_as_pandas</span><span class="p">,</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                    <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>            <span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_window_features</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>            <span class="n">X_train_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_exog_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                <span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>            <span class="n">X_train</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">train_index</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>                <span class="n">data</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="p">)</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">train_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Public method to create training predictors and target values.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        This method is a public wrapper around the internal method `_create_train_X_y`,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        which generates the training predictors and target values based on the provided time series and exogenous variables.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">            y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">            exog: Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">                - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">                - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">            True</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            True</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="k">return</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_train_test_split_one_step_ahead</span><span class="p">(</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        Create matrices needed to train and test the forecaster for one-step-ahead</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        predictions.</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">            y: Training time series.</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a><span class="sd">            initial_train_size: Initial size of the training set. It is the number of</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="sd">                observations used to train the forecaster before making the first</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a><span class="sd">                prediction.</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a><span class="sd">            exog: Exogenous variable/s included as predictor/s. Must have the same</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a><span class="sd">                number of observations as y and their indexes must be aligned.</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a><span class="sd">                Defaults to None.</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a><span class="sd">            Tuple containing:</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="sd">                - X_train: Predictor values used to train the model as pandas DataFrame.</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="sd">                - y_train: Target values related to each row of X_train as pandas Series.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a><span class="sd">                - X_test: Predictor values used to test the model as pandas DataFrame.</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">                - y_test: Target values related to each row of X_test as pandas Series.</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">            &gt;&gt;&gt; X_train, y_train, X_test, y_test = forecaster._train_test_split_one_step_ahead(y=y, initial_train_size=20, exog=exog)</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            True</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            True</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">            &gt;&gt;&gt; isinstance(X_test, pd.DataFrame)</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">            True</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">            &gt;&gt;&gt; isinstance(y_test, pd.Series)</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">            True</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="n">is_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">initial_train_size</span><span class="p">],</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">initial_train_size</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="p">)</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">test_init</span> <span class="o">=</span> <span class="n">initial_train_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_init</span><span class="p">:],</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_init</span><span class="p">:]</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="p">)</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="n">is_fitted</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>        <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">        Get parameters for this forecaster.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            deep: If True, will return the parameters for this forecaster and</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">                contained sub-objects that are estimators.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">            params: Dictionary of parameter names mapped to their values.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            &gt;&gt;&gt; forecaster.get_params()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">            {</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">                &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">                &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">                &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>            <span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>            <span class="s2">&quot;lags&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>            <span class="s2">&quot;window_features&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>            <span class="s2">&quot;transformer_y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>            <span class="s2">&quot;transformer_exog&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>            <span class="s2">&quot;weight_func&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="s2">&quot;differentiation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>            <span class="s2">&quot;fit_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>            <span class="s2">&quot;binner_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>            <span class="s2">&quot;forecaster_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>        <span class="p">]:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">deep</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>            <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimator&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                    <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;estimator__</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        Set the parameters of this forecaster.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            params: Optional dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">                If provided, these parameters are set first.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">            **kwargs: Dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">                Parameters can be for the forecaster itself or for the contained estimator (using the `estimator__` prefix).</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">            self: The forecaster instance with updated parameters.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            &gt;&gt;&gt; forecaster.set_params(estimator__fit_intercept=False)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            &gt;&gt;&gt; forecaster.estimator.get_params()[&quot;fit_intercept&quot;]</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            False</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>        <span class="c1"># Merge params dict and kwargs</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>        <span class="n">all_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>        <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_params</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>            <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="n">valid_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>        <span class="n">nested_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">all_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_params</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>                <span class="c1"># Relaxed check for now</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>            <span class="k">if</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>                <span class="n">obj_name</span><span class="p">,</span> <span class="n">param_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>                <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="p">:</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>                    <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>                <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>        <span class="k">for</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">obj_params</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">):</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>                <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;set_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                    <span class="n">obj</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">obj_params</span><span class="p">)</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>                    <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                        <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>        <span class="n">store_last_window</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>        <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">        Fit the forecaster to the training data.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            y:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">                  Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                  Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            store_last_window:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">                  Whether to store the last window of the training series for use in prediction. Defaults to True.</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            store_in_sample_residuals:</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">                  Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">                  Random seed for reproducibility when sampling residuals if `store_in_sample_residuals` is True. Defaults to 123.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            suppress_warnings:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">                  Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">            None</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                 &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">                 &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                 &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">                 &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">                 &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">                 &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">                 &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">                 &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">                 ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">                 ...     lags=3,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">                 ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">                 ... )</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">                 &gt;&gt;&gt; forecaster.fit(y=y, exog=exog, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>        <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>        <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>        <span class="p">(</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>            <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>            <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>            <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>                <span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>                <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>            <span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">exog_dtypes_in_</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">exog_dtypes_out_</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog_names_out_</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>        <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>                <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>                <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>                <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>            <span class="p">)</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>        <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>                <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>                <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>                <span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>            <span class="p">)</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>        <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_sample_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">        Create weights for each observation according to the forecaster&#39;s attribute</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        `weight_func`.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            X_train: Dataframe created with the `create_train_X_y` method, first return.</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            Weights to use in `fit` method.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>            <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot have NaN values.&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>                <span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sample_weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot have negative values.&quot;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>                <span class="p">)</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>                    <span class="s2">&quot;The resulting `sample_weight` cannot be normalized because &quot;</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>                    <span class="s2">&quot;the sum of the weights is zero.&quot;</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>                <span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="k">return</span> <span class="n">sample_weight</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>        <span class="n">predict_probabilistic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a><span class="sd">        Create the inputs needed for the first iteration of the prediction</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a><span class="sd">        process. As this is a recursive process, the last window is updated at</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a><span class="sd">        each iteration of the prediction process.</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a><span class="sd">            steps: Number of steps to predict.</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a><span class="sd">            last_window: Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a><span class="sd">                right after training data.</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a><span class="sd">            exog: Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a><span class="sd">            predict_probabilistic: If `True`, the necessary checks for probabilistic predictions will be</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a><span class="sd">                performed.</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a><span class="sd">            use_in_sample_residuals: If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a><span class="sd">                `set_out_sample_residuals()` method.</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a><span class="sd">            use_binned_residuals: If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a><span class="sd">                If `False`, residuals are selected randomly.</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a><span class="sd">            check_inputs: If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a><span class="sd">                with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a><span class="sd">                for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a><span class="sd">            - last_window_values:</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a><span class="sd">                Numpy array of the last window values to use for prediction,</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a><span class="sd">                transformed and ready for input into the prediction method.</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a><span class="sd">            - exog_values:</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a><span class="sd">                Numpy array of exogenous variable values for prediction,</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a><span class="sd">                transformed and ready for input into the prediction method,</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a><span class="sd">                or None if no exogenous variables are used.</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a><span class="sd">            - prediction_index:</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a><span class="sd">                Pandas Index for the predicted values, constructed based on the</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a><span class="sd">                last window index and the number of steps to predict.</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a><span class="sd">            - steps:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a><span class="sd">                Number of future steps predicted.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="n">last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>            <span class="n">steps</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>                <span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>                <span class="n">date_input</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>                <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>            <span class="p">)</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>        <span class="k">if</span> <span class="n">check_inputs</span><span class="p">:</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>            <span class="n">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>                <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>                <span class="n">is_fitted</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>                <span class="n">exog_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">,</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                <span class="n">index_type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>                <span class="n">index_freq_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>                <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>                <span class="n">last_window_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>                <span class="n">exog_names_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>                <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>            <span class="p">)</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>            <span class="k">if</span> <span class="n">predict_probabilistic</span><span class="p">:</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>                <span class="n">check_residuals_input</span><span class="p">(</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                    <span class="n">forecaster_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>                    <span class="n">in_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>                    <span class="n">out_sample_residuals_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">,</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>                    <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>                    <span class="n">in_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>                    <span class="n">out_sample_residuals_by_bin_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span><span class="p">,</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>                <span class="p">)</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>            <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>        <span class="p">)</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>        <span class="n">last_window_values</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>            <span class="n">array</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>        <span class="p">)</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>            <span class="n">last_window_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">)</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>            <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">:</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">]</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>                <span class="n">df</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>            <span class="p">)</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">:</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>                <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>                <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>            <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:</span><span class="n">steps</span><span class="p">]</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>            <span class="n">exog_values</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">last_window</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>                <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>                <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>                <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>                <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>                <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>                <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>                <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>            <span class="p">)</span>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>        <span class="k">return</span> <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>        <span class="n">last_window_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>        <span class="n">exog_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a><span class="sd">        Predict n steps ahead. It is an iterative process in which, each prediction,</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a><span class="sd">        is used as a predictor for the next step.</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a><span class="sd">            last_window_values:</span>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">                Series values used to create the predictors needed in the first</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">                iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">            exog_values:</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a><span class="sd">                Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">            Predicted values.</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a>        <span class="n">original_device</span> <span class="o">=</span> <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a>        <span class="n">n_lags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a>        <span class="n">n_window_features</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a>            <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a>        <span class="p">)</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a>        <span class="n">n_exog</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a>            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="o">+</span> <span class="n">n_exog</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a>        <span class="p">)</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a>        <span class="n">estimator_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a>        <span class="n">is_linear</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">LinearModel</span><span class="p">)</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a>        <span class="n">is_lightgbm</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;LGBMRegressor&quot;</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a>        <span class="n">is_xgboost</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;XGBRegressor&quot;</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a>        <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a>            <span class="n">coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">intercept_</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a>        <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">booster_</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a>        <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_booster</span><span class="p">()</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a>        <span class="n">has_lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a>        <span class="n">has_window_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>        <span class="n">has_exog</span> <span class="o">=</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a>            <span class="k">if</span> <span class="n">has_lags</span><span class="p">:</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a>                <span class="n">X</span><span class="p">[:</span><span class="n">n_lags</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a>            <span class="k">if</span> <span class="n">has_window_features</span><span class="p">:</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a>                <span class="n">window_data</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a>                <span class="n">X</span><span class="p">[</span><span class="n">n_lags</span> <span class="p">:</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a>                    <span class="p">[</span><span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">window_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">]</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a>                <span class="p">)</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a>            <span class="k">if</span> <span class="n">has_exog</span><span class="p">:</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a>                <span class="n">X</span><span class="p">[</span><span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a>            <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a>            <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a>            <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">inplace_predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a>            <span class="c1"># Update `last_window` values. The first position is discarded and</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a>            <span class="c1"># the new prediction is added at the end.</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a>            <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a>        <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">original_device</span><span class="p">)</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a>        <span class="n">last_window_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a>        <span class="n">sampled_residuals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a>        <span class="n">exog_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">        Vectorized bootstrap prediction - predict all n_boot iterations per step.</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">        Instead of running n_boot sequential predictions, this method predicts</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">        all bootstrap samples at once per step, significantly reducing overhead.</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">            last_window_values:</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">                Series values used to create the predictors needed in the first</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">                iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><span class="sd">            sampled_residuals:</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a><span class="sd">                Pre-sampled residuals for all bootstrap iterations.</span>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">                - If `use_binned_residuals=True`: 3D array of shape (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">                - If `use_binned_residuals=False`: 2D array of shape (steps, n_boot)</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">                If `True`, residuals are selected based on the predicted values.</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">                If `False`, residuals are selected randomly.</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">                Number of bootstrap iterations.</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">            exog_values:</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">            Numpy ndarray with the predicted values. Shape (steps, n_boot).</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a><span class="sd">                If `sampled_residuals` does not match the expected shape/dimensions.</span>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">            IndexError:</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">                If `last_window_values` or `exog_values` are not of expected lengths.</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=2)</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=pd.Series(np.arange(10)))</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">            &gt;&gt;&gt; last_window = np.array([8, 9])</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">            &gt;&gt;&gt; residuals = np.random.normal(size=(3, 5)) # 3 steps, 5 boots</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">            &gt;&gt;&gt; preds = forecaster._recursive_predict_bootstrapping(</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a><span class="sd">            ...     steps=3,</span>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">            ...     last_window_values=last_window,</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">            ...     sampled_residuals=residuals,</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">            ...     use_binned_residuals=False,</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">            ...     n_boot=5</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a><span class="sd">            &gt;&gt;&gt; preds.shape</span>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">            (3, 5)</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a>        <span class="n">original_device</span> <span class="o">=</span> <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a>        <span class="n">n_lags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a>        <span class="n">n_window_features</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a>            <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a>        <span class="p">)</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a>        <span class="n">n_exog</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="o">+</span> <span class="n">n_exog</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a>        <span class="c1"># Input matrix for prediction: shape (n_boot, n_features)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n_boot</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>        <span class="c1"># Output predictions: shape (steps, n_boot)</span>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a>        <span class="c1"># Expand last_window to 2D: (window_size + steps, n_boot)</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a>        <span class="c1"># Each column represents a separate bootstrap trajectory</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">last_window_values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a>        <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">last_window</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)])</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>        <span class="n">estimator_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a>        <span class="n">is_linear</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">LinearModel</span><span class="p">)</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a>        <span class="n">is_lightgbm</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;LGBMRegressor&quot;</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a>        <span class="n">is_xgboost</span> <span class="o">=</span> <span class="n">estimator_name</span> <span class="o">==</span> <span class="s2">&quot;XGBRegressor&quot;</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a>        <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a>            <span class="n">coef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a>            <span class="n">intercept</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">intercept_</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a>        <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">booster_</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a>        <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a>            <span class="n">booster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_booster</span><span class="p">()</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a>        <span class="n">has_lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>        <span class="n">has_window_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a>        <span class="n">has_exog</span> <span class="o">=</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a>            <span class="k">if</span> <span class="n">has_lags</span><span class="p">:</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a>                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">):</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a>                    <span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">lag</span> <span class="o">+</span> <span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a>            <span class="k">if</span> <span class="n">has_window_features</span><span class="p">:</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>                <span class="n">window_data</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a>                <span class="c1"># transform accepts 2D: (window_length, n_boot) -&gt; (n_boot, n_stats)</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a>                <span class="c1"># and concatenate along axis=1: (n_boot, total_window_features)</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>                <span class="n">X</span><span class="p">[:,</span> <span class="n">n_lags</span> <span class="p">:</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a>                    <span class="p">[</span><span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">window_data</span><span class="p">)</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a>                <span class="p">)</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a>            <span class="k">if</span> <span class="n">has_exog</span><span class="p">:</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a>                <span class="n">X</span><span class="p">[:,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>            <span class="k">if</span> <span class="n">is_linear</span><span class="p">:</span>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">coef</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a>            <span class="k">elif</span> <span class="n">is_lightgbm</span><span class="p">:</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>            <span class="k">elif</span> <span class="n">is_xgboost</span><span class="p">:</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">booster</span><span class="o">.</span><span class="n">inplace_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>            <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                <span class="c1"># sampled_residuals is a 3D array: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>                <span class="n">boot_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>                <span class="n">pred_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>                <span class="n">pred</span> <span class="o">+=</span> <span class="n">sampled_residuals</span><span class="p">[</span><span class="n">pred_bins</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">boot_indices</span><span class="p">]</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>                <span class="n">pred</span> <span class="o">+=</span> <span class="n">sampled_residuals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>            <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>        <span class="n">set_cpu_gpu_device</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">original_device</span><span class="p">)</span>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_predict_X</span><span class="p">(</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">        Create the predictors needed to predict `steps` ahead. As it is a recursive</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">        process, the predictors are created at each iteration of the prediction</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">        process.</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">            check_inputs:</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">                If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">                with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">                for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">                Defaults to True.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">            Pandas DataFrame with the predictors for each step. The index</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">            is the same as the prediction index.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>        <span class="p">(</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>            <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>            <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>            <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>            <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>        <span class="p">)</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>            <span class="p">)</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>            <span class="p">)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>        <span class="n">X_predict</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>        <span class="n">full_predictors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>            <span class="n">X_lags</span> <span class="o">=</span> <span class="n">full_predictors</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">)]</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_lags</span><span class="p">)</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>            <span class="n">X_window_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>                <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)),</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>                <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>                <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>                <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>            <span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>                <span class="n">X_window_features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>                    <span class="p">[</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                        <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)])</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                    <span class="p">]</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>                <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_window_features</span><span class="p">)</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>            <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>        <span class="n">X_predict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_predict</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>        <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>            <span class="n">categorical_features</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>                <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>                <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>                <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>            <span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>            <span class="k">if</span> <span class="n">categorical_features</span><span class="p">:</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>                <span class="n">X_predict</span> <span class="o">=</span> <span class="n">X_predict</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">)</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>                <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>                <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>                <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>            <span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>        <span class="k">return</span> <span class="n">X_predict</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>        <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">        Predict future values recursively for the specified number of steps.</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">                Number of future steps to predict.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">                Optional last window of observed values to use for prediction. If None, uses the last window from training.</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">                Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">                Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">                Must have the same structure as the exogenous variables used in training. Defaults to None.</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">            check_inputs:</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">                Whether to perform input validation checks. Defaults to True.</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">            Pandas Series of predicted values for the specified number of steps,</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">            indexed according to the prediction index constructed from the last window and the number of steps.</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">            &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">            ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">            ...     lags=3,</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">            ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">            &gt;&gt;&gt; forecaster.fit(y=y, exog=exog)</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">            &gt;&gt;&gt; last_window = y.iloc[-3:]</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">            &gt;&gt;&gt; exog_future = pd.DataFrame({&#39;temp&#39;: np.random.randn(5)}, index=pd.RangeIndex(start=30, stop=35))</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">            &gt;&gt;&gt; predictions = forecaster.predict(</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">            ...     steps=5, last_window=last_window, exog=exog_future, check_inputs=True</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">            &gt;&gt;&gt; isinstance(predictions, pd.Series)</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">            True</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>        <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>                <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>            <span class="p">)</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>        <span class="p">)</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>            <span class="p">)</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>            <span class="p">)</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>            <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>        <span class="p">)</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">        Generate multiple forecasting predictions using a bootstrapping process.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">        By sampling from a collection of past observed errors (the residuals),</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">        each iteration of bootstrapping generates a different set of predictions.</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">        See the References section for more information.</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">                Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">                intervals. Defaults to 250.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">                Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">            Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">                If `steps` is not an integer or a valid date.</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">                If `exog` is missing or has invalid shape.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">                If `n_boot` is not a positive integer.</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><span class="sd">                If `use_in_sample_residuals=True` and `in_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">                If `use_in_sample_residuals=False` and `out_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="sd">            &gt;&gt;&gt; boot_preds = forecaster.predict_bootstrapping(steps=3, n_boot=5)</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">            &gt;&gt;&gt; boot_preds.shape</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">            (3, 5)</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">        References:</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">            .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">                   https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>        <span class="p">(</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>            <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>            <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>            <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>            <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>            <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>        <span class="p">)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>        <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>            <span class="c1"># Create 3D array with sampled residuals: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>            <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">)</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>            <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>                <span class="p">[</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>                    <span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">][</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>                        <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>                            <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                        <span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>                    <span class="p">]</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">)</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>                <span class="p">],</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>                <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>            <span class="p">)</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>            <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>                <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>            <span class="p">]</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>            <span class="p">)</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>                <span class="n">sampled_residuals</span><span class="o">=</span><span class="n">sampled_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>                <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>            <span class="p">)</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>                <span class="n">boot_predictions</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>            <span class="p">)</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>                <span class="n">array</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>            <span class="p">)</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>        <span class="n">boot_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)]</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>            <span class="n">data</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">boot_columns</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>        <span class="p">)</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>        <span class="k">return</span> <span class="n">boot_predictions</span>
<a id="__codelineno-0-2015" name="__codelineno-0-2015"></a>
<a id="__codelineno-0-2016" name="__codelineno-0-2016"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2017" name="__codelineno-0-2017"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2018" name="__codelineno-0-2018"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2019" name="__codelineno-0-2019"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2020" name="__codelineno-0-2020"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2021" name="__codelineno-0-2021"></a>        <span class="n">nominal_coverage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
<a id="__codelineno-0-2022" name="__codelineno-0-2022"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2023" name="__codelineno-0-2023"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2024" name="__codelineno-0-2024"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2025" name="__codelineno-0-2025"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2026" name="__codelineno-0-2026"></a><span class="sd">        Generate prediction intervals using the conformal prediction</span>
<a id="__codelineno-0-2027" name="__codelineno-0-2027"></a><span class="sd">        split method [1]_.</span>
<a id="__codelineno-0-2028" name="__codelineno-0-2028"></a>
<a id="__codelineno-0-2029" name="__codelineno-0-2029"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2030" name="__codelineno-0-2030"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-2031" name="__codelineno-0-2031"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-2032" name="__codelineno-0-2032"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2033" name="__codelineno-0-2033"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2034" name="__codelineno-0-2034"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-2035" name="__codelineno-0-2035"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2036" name="__codelineno-0-2036"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2037" name="__codelineno-0-2037"></a><span class="sd">                If `last_window = None`, the values stored in` self.last_window_` are</span>
<a id="__codelineno-0-2038" name="__codelineno-0-2038"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2039" name="__codelineno-0-2039"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-2040" name="__codelineno-0-2040"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-2041" name="__codelineno-0-2041"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2042" name="__codelineno-0-2042"></a><span class="sd">            nominal_coverage:</span>
<a id="__codelineno-0-2043" name="__codelineno-0-2043"></a><span class="sd">                Nominal coverage, also known as expected coverage, of the prediction</span>
<a id="__codelineno-0-2044" name="__codelineno-0-2044"></a><span class="sd">                intervals. Must be between 0 and 1. Defaults to 0.95.</span>
<a id="__codelineno-0-2045" name="__codelineno-0-2045"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-2046" name="__codelineno-0-2046"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2047" name="__codelineno-0-2047"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-2048" name="__codelineno-0-2048"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2049" name="__codelineno-0-2049"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2050" name="__codelineno-0-2050"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2051" name="__codelineno-0-2051"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-2052" name="__codelineno-0-2052"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2053" name="__codelineno-0-2053"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-2054" name="__codelineno-0-2054"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2055" name="__codelineno-0-2055"></a>
<a id="__codelineno-0-2056" name="__codelineno-0-2056"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-2057" name="__codelineno-0-2057"></a><span class="sd">            Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2058" name="__codelineno-0-2058"></a><span class="sd">            - pred: predictions.</span>
<a id="__codelineno-0-2059" name="__codelineno-0-2059"></a><span class="sd">            - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2060" name="__codelineno-0-2060"></a><span class="sd">            - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2061" name="__codelineno-0-2061"></a>
<a id="__codelineno-0-2062" name="__codelineno-0-2062"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-2063" name="__codelineno-0-2063"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2064" name="__codelineno-0-2064"></a><span class="sd">                If `nominal_coverage` is not between 0 and 1.</span>
<a id="__codelineno-0-2065" name="__codelineno-0-2065"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2066" name="__codelineno-0-2066"></a><span class="sd">                If inputs are invalid (checked by `_create_predict_inputs`).</span>
<a id="__codelineno-0-2067" name="__codelineno-0-2067"></a>
<a id="__codelineno-0-2068" name="__codelineno-0-2068"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-2069" name="__codelineno-0-2069"></a><span class="sd">            &gt;&gt;&gt; # Internal method, typically used via predict_interval(method=&#39;conformal&#39;)</span>
<a id="__codelineno-0-2070" name="__codelineno-0-2070"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2071" name="__codelineno-0-2071"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2072" name="__codelineno-0-2072"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2073" name="__codelineno-0-2073"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2074" name="__codelineno-0-2074"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2075" name="__codelineno-0-2075"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2076" name="__codelineno-0-2076"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2077" name="__codelineno-0-2077"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2078" name="__codelineno-0-2078"></a><span class="sd">            &gt;&gt;&gt; preds = forecaster._predict_interval_conformal(steps=3, nominal_coverage=0.9)</span>
<a id="__codelineno-0-2079" name="__codelineno-0-2079"></a><span class="sd">            &gt;&gt;&gt; preds.columns.tolist()</span>
<a id="__codelineno-0-2080" name="__codelineno-0-2080"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2081" name="__codelineno-0-2081"></a>
<a id="__codelineno-0-2082" name="__codelineno-0-2082"></a><span class="sd">        References:</span>
<a id="__codelineno-0-2083" name="__codelineno-0-2083"></a><span class="sd">            .. [1] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2084" name="__codelineno-0-2084"></a><span class="sd">                   https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2085" name="__codelineno-0-2085"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2086" name="__codelineno-0-2086"></a>
<a id="__codelineno-0-2087" name="__codelineno-0-2087"></a>        <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2088" name="__codelineno-0-2088"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-2089" name="__codelineno-0-2089"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2090" name="__codelineno-0-2090"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2091" name="__codelineno-0-2091"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2092" name="__codelineno-0-2092"></a>                <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2093" name="__codelineno-0-2093"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2094" name="__codelineno-0-2094"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2095" name="__codelineno-0-2095"></a>                <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2096" name="__codelineno-0-2096"></a>            <span class="p">)</span>
<a id="__codelineno-0-2097" name="__codelineno-0-2097"></a>        <span class="p">)</span>
<a id="__codelineno-0-2098" name="__codelineno-0-2098"></a>
<a id="__codelineno-0-2099" name="__codelineno-0-2099"></a>        <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2100" name="__codelineno-0-2100"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-2101" name="__codelineno-0-2101"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2102" name="__codelineno-0-2102"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2103" name="__codelineno-0-2103"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2104" name="__codelineno-0-2104"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2105" name="__codelineno-0-2105"></a>
<a id="__codelineno-0-2106" name="__codelineno-0-2106"></a>        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-2107" name="__codelineno-0-2107"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-2108" name="__codelineno-0-2108"></a>                <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2109" name="__codelineno-0-2109"></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2110" name="__codelineno-0-2110"></a>                <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-2111" name="__codelineno-0-2111"></a>            <span class="p">)</span>
<a id="__codelineno-0-2112" name="__codelineno-0-2112"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-2113" name="__codelineno-0-2113"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2114" name="__codelineno-0-2114"></a>                <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-2115" name="__codelineno-0-2115"></a>                <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-2116" name="__codelineno-0-2116"></a>            <span class="p">)</span>
<a id="__codelineno-0-2117" name="__codelineno-0-2117"></a>
<a id="__codelineno-0-2118" name="__codelineno-0-2118"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2119" name="__codelineno-0-2119"></a>            <span class="c1"># Fallback to global residuals if bin is empty</span>
<a id="__codelineno-0-2120" name="__codelineno-0-2120"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2121" name="__codelineno-0-2121"></a>                <span class="n">global_cf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-2122" name="__codelineno-0-2122"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2123" name="__codelineno-0-2123"></a>                <span class="n">global_cf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-2124" name="__codelineno-0-2124"></a>
<a id="__codelineno-0-2125" name="__codelineno-0-2125"></a>            <span class="n">correction_factor_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2126" name="__codelineno-0-2126"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2127" name="__codelineno-0-2127"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-2128" name="__codelineno-0-2128"></a>                    <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2129" name="__codelineno-0-2129"></a>                        <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">nominal_coverage</span>
<a id="__codelineno-0-2130" name="__codelineno-0-2130"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2131" name="__codelineno-0-2131"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2132" name="__codelineno-0-2132"></a>                    <span class="n">correction_factor_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">global_cf</span>
<a id="__codelineno-0-2133" name="__codelineno-0-2133"></a>
<a id="__codelineno-0-2134" name="__codelineno-0-2134"></a>            <span class="n">replace_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span>
<a id="__codelineno-0-2135" name="__codelineno-0-2135"></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">correction_factor_by_bin</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">global_cf</span><span class="p">)</span>
<a id="__codelineno-0-2136" name="__codelineno-0-2136"></a>            <span class="p">)</span>
<a id="__codelineno-0-2137" name="__codelineno-0-2137"></a>
<a id="__codelineno-0-2138" name="__codelineno-0-2138"></a>            <span class="n">predictions_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-2139" name="__codelineno-0-2139"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">replace_func</span><span class="p">(</span><span class="n">predictions_bin</span><span class="p">)</span>
<a id="__codelineno-0-2140" name="__codelineno-0-2140"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2141" name="__codelineno-0-2141"></a>            <span class="n">correction_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">nominal_coverage</span><span class="p">)</span>
<a id="__codelineno-0-2142" name="__codelineno-0-2142"></a>
<a id="__codelineno-0-2143" name="__codelineno-0-2143"></a>        <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">-</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-2144" name="__codelineno-0-2144"></a>        <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">predictions</span> <span class="o">+</span> <span class="n">correction_factor</span>
<a id="__codelineno-0-2145" name="__codelineno-0-2145"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">predictions</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">])</span>
<a id="__codelineno-0-2146" name="__codelineno-0-2146"></a>
<a id="__codelineno-0-2147" name="__codelineno-0-2147"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2148" name="__codelineno-0-2148"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-2149" name="__codelineno-0-2149"></a>
<a id="__codelineno-0-2150" name="__codelineno-0-2150"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2151" name="__codelineno-0-2151"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2152" name="__codelineno-0-2152"></a>                <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-2153" name="__codelineno-0-2153"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2154" name="__codelineno-0-2154"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2155" name="__codelineno-0-2155"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2156" name="__codelineno-0-2156"></a>            <span class="p">)</span>
<a id="__codelineno-0-2157" name="__codelineno-0-2157"></a>
<a id="__codelineno-0-2158" name="__codelineno-0-2158"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2159" name="__codelineno-0-2159"></a>            <span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-2160" name="__codelineno-0-2160"></a>            <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-2161" name="__codelineno-0-2161"></a>            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred&quot;</span><span class="p">,</span> <span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">],</span>
<a id="__codelineno-0-2162" name="__codelineno-0-2162"></a>        <span class="p">)</span>
<a id="__codelineno-0-2163" name="__codelineno-0-2163"></a>
<a id="__codelineno-0-2164" name="__codelineno-0-2164"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-2165" name="__codelineno-0-2165"></a>
<a id="__codelineno-0-2166" name="__codelineno-0-2166"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>        <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>        <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>        <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>        <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>        <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><span class="sd">        Predict n steps ahead and estimate prediction intervals using either</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="sd">        bootstrapping or conformal prediction methods. Refer to the References</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="sd">        section for additional details on these methods.</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">            steps:</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">                Number of steps to predict.</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">                - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">                - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">            last_window:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">                Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="sd">                first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">                If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">                used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="sd">                right after training data. Defaults to None.</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">            exog:</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">                Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">            method:</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">                Technique used to estimate prediction intervals. Available options:</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">                - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">                  intervals [1]_.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">                - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">                  interval estimation [2]_.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">                Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">            interval:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">                Confidence level of the prediction interval. Interpretation depends</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">                on the method used:</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">                - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">                  and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">                  percentiles.</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">                - If `list` or `tuple`, defines the exact percentiles to compute, which</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="sd">                  must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">                  of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">                - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="sd">                  a list/tuple defining a symmetric interval.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">                Defaults to [5, 95].</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">            n_boot:</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">                Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">                intervals. Defaults to 250.</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">            use_in_sample_residuals:</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="sd">                If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">                prediction error to create predictions.</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">                If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">                Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">                `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">            use_binned_residuals:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">                If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">                (binned selection).</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">                If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">            random_state:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">                Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="sd">            Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">            - pred: predictions.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">            - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">            - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">                If `method` is not &#39;bootstrapping&#39; or &#39;conformal&#39;.</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">                 If `interval` is invalid or not compatible with the chosen method.</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="sd">            ValueError:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">                If inputs (`steps`, `exog`, etc.) are invalid.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">            &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">            &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">            &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">            &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">            &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">            &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">            &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">            &gt;&gt;&gt; # Bootstrapping method</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><span class="sd">            &gt;&gt;&gt; intervals_boot = forecaster.predict_interval(</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="sd">            ...     steps=3, method=&#39;bootstrapping&#39;, interval=[5, 95]</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">            &gt;&gt;&gt; intervals_boot.columns.tolist()</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">            &gt;&gt;&gt; # Conformal method</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">            &gt;&gt;&gt; intervals_conf = forecaster.predict_interval(</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">            ...     steps=3, method=&#39;conformal&#39;, interval=0.95</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">            &gt;&gt;&gt; intervals_conf.columns.tolist()</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">            [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="sd">        References:</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">            .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">                   https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="sd">            .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">                   https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>            <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>                <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>                <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>            <span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>            <span class="p">)</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>            <span class="n">predictions_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>                <span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>            <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>            <span class="n">predictions_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions_interval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>                <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>                <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>                <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>                <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>                <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>                <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>                <span class="n">nominal_coverage</span><span class="o">=</span><span class="n">nominal_coverage</span><span class="p">,</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>                <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>                <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>            <span class="p">)</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid `method` &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Choose &#39;bootstrapping&#39; or &#39;conformal&#39;.&quot;</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>            <span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>        <span class="k">return</span> <span class="n">predictions</span>
<a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>
<a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2329" name="__codelineno-0-2329"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2330" name="__codelineno-0-2330"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-2331" name="__codelineno-0-2331"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-2332" name="__codelineno-0-2332"></a>        <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2333" name="__codelineno-0-2333"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2334" name="__codelineno-0-2334"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="sd">        Bin residuals according to the predicted value each residual is</span>
<a id="__codelineno-0-2337" name="__codelineno-0-2337"></a><span class="sd">        associated with. First a `skforecast.preprocessing.QuantileBinner` object</span>
<a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="sd">        is fitted to the predicted values. Then, residuals are binned according</span>
<a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="sd">        to the predicted value each residual is associated with. Residuals are</span>
<a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="sd">        stored in the forecaster object as `in_sample_residuals_` and</span>
<a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="sd">        `in_sample_residuals_by_bin_`.</span>
<a id="__codelineno-0-2342" name="__codelineno-0-2342"></a>
<a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="sd">        `y_true` and `y_pred` assumed to be differentiated and or transformed</span>
<a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><span class="sd">        according to the attributes `differentiation` and `transformer_y`.</span>
<a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><span class="sd">        The number of residuals stored per bin is limited to</span>
<a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><span class="sd">        `10_000 // self.binner.n_bins_`. The total number of residuals stored is</span>
<a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="sd">        `10_000`.</span>
<a id="__codelineno-0-2348" name="__codelineno-0-2348"></a>
<a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="sd">            y_true: True values of the time series.</span>
<a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="sd">            y_pred: Predicted values of the time series.</span>
<a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="sd">            store_in_sample_residuals: If `True`, in-sample residuals will be stored in the forecaster object</span>
<a id="__codelineno-0-2353" name="__codelineno-0-2353"></a><span class="sd">                after fitting (`in_sample_residuals_` and `in_sample_residuals_by_bin_`</span>
<a id="__codelineno-0-2354" name="__codelineno-0-2354"></a><span class="sd">                attributes). If `False`, only the intervals of the bins are stored.</span>
<a id="__codelineno-0-2355" name="__codelineno-0-2355"></a><span class="sd">            random_state: Set a seed for the random generator so that the stored sample</span>
<a id="__codelineno-0-2356" name="__codelineno-0-2356"></a><span class="sd">                residuals are always deterministic.</span>
<a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2358" name="__codelineno-0-2358"></a>
<a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span>
<a id="__codelineno-0-2360" name="__codelineno-0-2360"></a>
<a id="__codelineno-0-2361" name="__codelineno-0-2361"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2362" name="__codelineno-0-2362"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">})</span>
<a id="__codelineno-0-2363" name="__codelineno-0-2363"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-2364" name="__codelineno-0-2364"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">intervals_</span>
<a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>
<a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>        <span class="k">if</span> <span class="n">store_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-2367" name="__codelineno-0-2367"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2368" name="__codelineno-0-2368"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="o">==</span> <span class="s2">&quot;binned&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2369" name="__codelineno-0-2369"></a>                <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2370" name="__codelineno-0-2370"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2371" name="__codelineno-0-2371"></a>                    <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2372" name="__codelineno-0-2372"></a>                <span class="p">)</span>
<a id="__codelineno-0-2373" name="__codelineno-0-2373"></a>
<a id="__codelineno-0-2374" name="__codelineno-0-2374"></a>                <span class="n">max_sample</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins_</span>
<a id="__codelineno-0-2375" name="__codelineno-0-2375"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2376" name="__codelineno-0-2376"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_sample</span><span class="p">:</span>
<a id="__codelineno-0-2377" name="__codelineno-0-2377"></a>                        <span class="n">sample</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">max_sample</span><span class="p">)]</span>
<a id="__codelineno-0-2378" name="__codelineno-0-2378"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-0-2379" name="__codelineno-0-2379"></a>
<a id="__codelineno-0-2380" name="__codelineno-0-2380"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10_000</span><span class="p">:</span>
<a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>                <span class="n">residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>                    <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>
<a id="__codelineno-0-2383" name="__codelineno-0-2383"></a>                <span class="p">]</span>
<a id="__codelineno-0-2384" name="__codelineno-0-2384"></a>
<a id="__codelineno-0-2385" name="__codelineno-0-2385"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2386" name="__codelineno-0-2386"></a>
<a id="__codelineno-0-2387" name="__codelineno-0-2387"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>        <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>        <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="sd">        Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="sd">        training process.</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>                <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="p">)</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>        <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>        <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>            <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>        <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>                <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>                <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>                <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>                <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>                <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>            <span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>        <span class="p">(</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>            <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>            <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>            <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>            <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>            <span class="o">*</span><span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">X_train_features_names_out_</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">:</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>                <span class="sa">f</span><span class="s2">&quot;Feature mismatch detected after matrix creation. The features &quot;</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>                <span class="sa">f</span><span class="s2">&quot;generated from the provided data do not match those used during &quot;</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>                <span class="sa">f</span><span class="s2">&quot;the training process. To correctly set in-sample residuals, &quot;</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>                <span class="sa">f</span><span class="s2">&quot;ensure that the same data and preprocessing steps are applied.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>                <span class="sa">f</span><span class="s2">&quot;    Expected output : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>                <span class="sa">f</span><span class="s2">&quot;    Current output  : </span><span class="si">{</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>            <span class="p">)</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>            <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>        <span class="p">)</span>
<a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>
<a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>        <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>        <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>        <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><span class="sd">        Set new values to the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>            <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>                <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>                <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>            <span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>            <span class="p">)</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>                <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>            <span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>                <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>            <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>                <span class="n">array</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>            <span class="p">)</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>                <span class="n">array</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>                <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>                <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>                <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>            <span class="p">)</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>            <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>            <span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>            <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>        <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>                <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>            <span class="p">)</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>            <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>        <span class="p">)</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>            <span class="p">{}</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>        <span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>                        <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>            <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>            <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>            <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>            <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>                        <span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>            <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>                <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>            <span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>            <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>                <span class="n">k</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>            <span class="p">]</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>            <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>                    <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>                    <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>                    <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>                    <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>                <span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>                <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>                    <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>                        <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>                    <span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when a ForecasterRecursive object is printed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of the forecaster with key information about its configuration and state.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">=========================</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">ForecasterRecursive</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">=========================</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">Estimator: LinearRegression</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">Lags: [1, 2, 3]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">Window features: []</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">Window size: 3</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">Series name: None</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">Exogenous included: False</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Exogenous names: None</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">Transformer for y: None</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">Transformer for exog: None</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">Weight function included: False</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">Differentiation order: None</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">Training range: None</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">Training index type: None</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">Training index frequency: None</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">Estimator parameters: {...}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">fit_kwargs: {...}</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">Creation date: ...</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">Last fit date: None</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">spotforecast version: ...</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">Python version: ...</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">Forecaster id: None</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    Information displayed when a ForecasterRecursive object is printed.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        str: String representation of the forecaster with key information about its configuration and state.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        &gt;&gt;&gt; print(forecaster)  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        =========================</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        ForecasterRecursive</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        =========================</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        Estimator: LinearRegression</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Lags: [1, 2, 3]</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        Window features: []</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        Window size: 3</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        Series name: None</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        Exogenous included: False</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Exogenous names: None</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        Transformer for y: None</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Transformer for exog: None</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        Weight function included: False</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        Differentiation order: None</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        Training range: None</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Training index type: None</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        Training index frequency: None</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Estimator parameters: {...}</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        fit_kwargs: {...}</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Creation date: ...</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Last fit date: None</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        spotforecast version: ...</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Python version: ...</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        Forecaster id: None</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="sa">f</span><span class="s2">&quot;Estimator: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="sa">f</span><span class="s2">&quot;Lags: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="sa">f</span><span class="s2">&quot;Window features: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="sa">f</span><span class="s2">&quot;Window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="sa">f</span><span class="s2">&quot;Series name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="sa">f</span><span class="s2">&quot;Exogenous included: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="sa">f</span><span class="s2">&quot;Exogenous names: </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="sa">f</span><span class="s2">&quot;Transformer for y: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="sa">f</span><span class="s2">&quot;Transformer for exog: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="sa">f</span><span class="s2">&quot;Weight function included: </span><span class="si">{</span><span class="kc">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">False</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation order: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="sa">f</span><span class="s2">&quot;Training range: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="sa">f</span><span class="s2">&quot;Training index type: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="sa">f</span><span class="s2">&quot;Training index frequency: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="sa">f</span><span class="s2">&quot;Estimator parameters: </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="sa">f</span><span class="s2">&quot;fit_kwargs: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="sa">f</span><span class="s2">&quot;Creation date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="sa">f</span><span class="s2">&quot;Last fit date: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="sa">f</span><span class="s2">&quot;spotforecast version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spotforecast_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="sa">f</span><span class="s2">&quot;Forecaster id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="p">)</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.__setstate__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Custom <strong>setstate</strong> to ensure backward compatibility when unpickling.
Only sets <strong>spotforecast_tags</strong> if not present, preserving custom tags.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Custom __setstate__ to ensure backward compatibility when unpickling.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    Only sets __spotforecast_tags__ if not present, preserving custom tags.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__spotforecast_tags__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__spotforecast_tags__</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="s2">&quot;library&quot;</span><span class="p">:</span> <span class="s2">&quot;spotforecast&quot;</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="s2">&quot;forecaster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="s2">&quot;forecaster_task&quot;</span><span class="p">:</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="s2">&quot;forecasting_scope&quot;</span><span class="p">:</span> <span class="s2">&quot;single-series&quot;</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="s2">&quot;forecasting_strategy&quot;</span><span class="p">:</span> <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="s2">&quot;index_types_supported&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.RangeIndex&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DatetimeIndex&quot;</span><span class="p">],</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="s2">&quot;requires_index_frequency&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="s2">&quot;allowed_input_types_series&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">],</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="s2">&quot;supports_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="s2">&quot;allowed_input_types_exog&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;pandas.Series&quot;</span><span class="p">,</span> <span class="s2">&quot;pandas.DataFrame&quot;</span><span class="p">],</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="s2">&quot;handles_missing_values_series&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="s2">&quot;handles_missing_values_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="s2">&quot;supports_lags&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="s2">&quot;supports_window_features&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="s2">&quot;supports_transformer_series&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="s2">&quot;supports_transformer_exog&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="s2">&quot;supports_weight_func&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="s2">&quot;supports_differentiation&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="s2">&quot;prediction_types&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="s2">&quot;point&quot;</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="s2">&quot;supports_probabilistic&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="s2">&quot;probabilistic_methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span> <span class="s2">&quot;conformal&quot;</span><span class="p">],</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="s2">&quot;handles_binned_residuals&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_predict_X" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_predict_X</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create the predictors needed to predict <code>steps</code> ahead. As it is a recursive
process, the predictors are created at each iteration of the prediction
process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_inputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the input is checked for possible warnings and errors
with the <code>check_predict_input</code> function. This argument is created
for internal use and is not recommended to be changed.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with the predictors for each step. The index</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>is the same as the prediction index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1662" name="__codelineno-0-1662"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_predict_X</span><span class="p">(</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a><span class="sd">    Create the predictors needed to predict `steps` ahead. As it is a recursive</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a><span class="sd">    process, the predictors are created at each iteration of the prediction</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a><span class="sd">    process.</span>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a><span class="sd">        check_inputs:</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a><span class="sd">            If `True`, the input is checked for possible warnings and errors</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a><span class="sd">            with the `check_predict_input` function. This argument is created</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a><span class="sd">            for internal use and is not recommended to be changed.</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a><span class="sd">        Pandas DataFrame with the predictors for each step. The index</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a><span class="sd">        is the same as the prediction index.</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>    <span class="p">(</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>        <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>        <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>        <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>        <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>        <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>        <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>    <span class="p">)</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>        <span class="p">)</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>        <span class="p">)</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>    <span class="n">X_predict</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>    <span class="n">full_predictors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window_values</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>        <span class="n">X_lags</span> <span class="o">=</span> <span class="n">full_predictors</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">)]</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_lags</span><span class="p">)</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="n">X_window_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)),</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>            <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>            <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a>            <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="p">)</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="n">X_window_features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>                <span class="p">[</span>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>                    <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">full_predictors</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">)])</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                    <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                <span class="p">]</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="p">)</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_window_features</span><span class="p">)</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>        <span class="n">X_predict</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>    <span class="n">X_predict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_predict</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>        <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>        <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>    <span class="p">)</span>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">:</span>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a>            <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>            <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_bool_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>            <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="p">)</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>        <span class="k">if</span> <span class="n">categorical_features</span><span class="p">:</span>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>            <span class="n">X_predict</span> <span class="o">=</span> <span class="n">X_predict</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span><span class="p">)</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>            <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>            <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>            <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>            <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>            <span class="s2">&quot;for more details: &quot;</span>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>            <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="n">DataTransformationWarning</span><span class="p">,</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>        <span class="p">)</span>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a>    <span class="k">return</span> <span class="n">X_predict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_sample_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create weights for each observation according to the forecaster's attribute
<code>weight_func</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_train</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe created with the <code>create_train_X_y</code> method, first return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights to use in <code>fit</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_sample_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    Create weights for each observation according to the forecaster&#39;s attribute</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">    `weight_func`.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        X_train: Dataframe created with the `create_train_X_y` method, first return.</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        Weights to use in `fit` method.</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>    <span class="n">sample_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot have NaN values.&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>            <span class="p">)</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">sample_weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot have negative values.&quot;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>            <span class="p">)</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>                <span class="s2">&quot;The resulting `sample_weight` cannot be normalized because &quot;</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>                <span class="s2">&quot;the sum of the weights is zero.&quot;</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>            <span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="k">return</span> <span class="n">sample_weight</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.create_train_X_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Public method to create training predictors and target values.</p>
<p>This method is a public wrapper around the internal method <code>_create_train_X_y</code>,
which generates the training predictors and target values based on the provided time series and exogenous variables.
It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target series for training. Must be a pandas Series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as <code>y</code> and cover the same time range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.Series">Series</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing:
- X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).
- y_train: Series of target values aligned with the predictors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">True</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_train_X_y</span><span class="p">(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Public method to create training predictors and target values.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">    This method is a public wrapper around the internal method `_create_train_X_y`,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">    which generates the training predictors and target values based on the provided time series and exogenous variables.</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">    It ensures that the necessary transformations and feature engineering steps are applied to prepare the data for training the forecaster.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        y: Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">        exog: Optional exogenous variables for training. Can be a pandas Series or DataFrame. Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="sd">        Tuple containing:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="sd">            - X_train: DataFrame of training predictors including lags, window features, and exogenous variables (if provided).</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a><span class="sd">            - y_train: Series of target values aligned with the predictors.</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        ...     lags=3,</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        &gt;&gt;&gt; X_train, y_train = forecaster.create_train_X_y(y=y, exog=exog)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        &gt;&gt;&gt; isinstance(X_train, pd.DataFrame)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a><span class="sd">        True</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        &gt;&gt;&gt; isinstance(y_train, pd.Series)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">        True</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="k">return</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_last_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the forecaster to the training data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target series for training. Must be a pandas Series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as <code>y</code> and cover the same time range. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store_last_window</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to store the last window of the training series for use in prediction. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>store_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility when sampling residuals if <code>store_in_sample_residuals</code> is True. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>    <span class="n">store_last_window</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a>    <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">    Fit the forecaster to the training data.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        y:</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">              Target series for training. Must be a pandas Series.</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">              Optional exogenous variables for training. Can be a pandas Series or DataFrame.Must have the same index as `y` and cover the same time range. Defaults to None.</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">        store_last_window:</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">              Whether to store the last window of the training series for use in prediction. Defaults to True.</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">        store_in_sample_residuals:</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">              Whether to store in-sample residuals after fitting, which can be used for certain probabilistic prediction methods. Defaults to False.</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a><span class="sd">              Random seed for reproducibility when sampling residuals if `store_in_sample_residuals` is True. Defaults to 123.</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">        suppress_warnings:</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">              Whether to suppress warnings during fitting, such as those related to insufficient data length for lags or window features. Defaults to False.</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a><span class="sd">        None</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">             &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a><span class="sd">             &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">             &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">             &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">             &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">             &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">             &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">             &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">             ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">             ...     lags=3,</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="sd">             ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">             ... )</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">             &gt;&gt;&gt; forecaster.fit(y=y, exog=exog, store_in_sample_residuals=True)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="p">(</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>        <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>        <span class="n">exog_names_in_</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>        <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>        <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>        <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="n">exog_dtypes_in_</span><span class="p">,</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="n">exog_dtypes_out_</span><span class="p">,</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span><span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>            <span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>            <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>            <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_window_features_names_out_</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_features_names_out_</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freqstr</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">step</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">exog_dtypes_in_</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_out_</span> <span class="o">=</span> <span class="n">exog_dtypes_out_</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog_names_out_</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">series_name_in_</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a>    <span class="c1"># NOTE: This is done to save time during fit in functions such as backtesting()</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probabilistic_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a>            <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a>            <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>            <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="n">store_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>        <span class="p">)</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>    <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>            <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:]</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>            <span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>            <span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a>        <span class="p">)</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a>    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.get_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get parameters for this forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>deep</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will return the parameters for this forecaster and
contained sub-objects that are estimators.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>params</code></td>            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of parameter names mapped to their values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">{</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">    &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">    &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">    &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">    Get parameters for this forecaster.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">        deep: If True, will return the parameters for this forecaster and</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            contained sub-objects that are estimators.</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        params: Dictionary of parameter names mapped to their values.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        &gt;&gt;&gt; forecaster.get_params()  # doctest: +ELLIPSIS</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        {</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">            &#39;estimator&#39;: LinearRegression(), &#39;lags&#39;: 3, &#39;window_features&#39;: None,</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">            &#39;transformer_y&#39;: None, &#39;transformer_exog&#39;: None, &#39;weight_func&#39;: None,</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            &#39;differentiation&#39;: None, &#39;fit_kwargs&#39;: {}, &#39;binner_kwargs&#39;: None, &#39;forecaster_id&#39;: &#39;...&#39;}</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="s2">&quot;estimator&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>        <span class="s2">&quot;lags&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>        <span class="s2">&quot;window_features&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>        <span class="s2">&quot;transformer_y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>        <span class="s2">&quot;transformer_exog&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="s2">&quot;weight_func&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>        <span class="s2">&quot;differentiation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="s2">&quot;fit_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>        <span class="s2">&quot;binner_kwargs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="s2">&quot;forecaster_id&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="p">]:</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">deep</span><span class="p">:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimator&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;get_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>                <span class="n">params</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;estimator__</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict future values recursively for the specified number of steps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps to predict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional last window of observed values to use for prediction. If None, uses the last window from training.
Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.
Must have the same structure as the exogenous variables used in training. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_inputs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to perform input validation checks. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas Series of predicted values for the specified number of steps,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>indexed according to the prediction index constructed from the last window and the number of steps.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">30</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">window_features</span><span class="o">=</span><span class="p">[</span><span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">last_window</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_future</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">35</span><span class="p">))</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog_future</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1777" name="__codelineno-0-1777"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a><span class="sd">    Predict future values recursively for the specified number of steps.</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a><span class="sd">            Number of future steps to predict.</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a><span class="sd">            Optional last window of observed values to use for prediction. If None, uses the last window from training.</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a><span class="sd">            Must be a pandas Series or DataFrame with the same structure as the training target series. Defaults to None.</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a><span class="sd">            Optional exogenous variables for prediction. Can be a pandas Series or DataFrame.</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a><span class="sd">            Must have the same structure as the exogenous variables used in training. Defaults to None.</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a><span class="sd">        check_inputs:</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a><span class="sd">            Whether to perform input validation checks. Defaults to True.</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a><span class="sd">        Pandas Series of predicted values for the specified number of steps,</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a><span class="sd">        indexed according to the prediction index constructed from the last window and the number of steps.</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(30), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">        &gt;&gt;&gt; exog = pd.DataFrame({&#39;temp&#39;: np.random.randn(30)}, index=y.index)</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">        ...     estimator=LinearRegression(),</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">        ...     lags=3,</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">        ...     window_features=[RollingFeatures(stats=&#39;mean&#39;, window_sizes=3)]</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">        &gt;&gt;&gt; forecaster.fit(y=y, exog=exog)</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">        &gt;&gt;&gt; last_window = y.iloc[-3:]</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">        &gt;&gt;&gt; exog_future = pd.DataFrame({&#39;temp&#39;: np.random.randn(5)}, index=pd.RangeIndex(start=30, stop=35))</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a><span class="sd">        &gt;&gt;&gt; predictions = forecaster.predict(</span>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">        ...     steps=5, last_window=last_window, exog=exog_future, check_inputs=True</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">        &gt;&gt;&gt; isinstance(predictions, pd.Series)</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">        True</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>    <span class="n">last_window_values</span><span class="p">,</span> <span class="n">exog_values</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a>            <span class="n">check_inputs</span><span class="o">=</span><span class="n">check_inputs</span><span class="p">,</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>        <span class="p">)</span>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a>    <span class="p">)</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a>        <span class="p">)</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>        <span class="p">)</span>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a>        <span class="n">array</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a>        <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a>        <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a>        <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>    <span class="p">)</span>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_bootstrapping" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_bootstrapping</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate multiple forecasting predictions using a bootstrapping process.
By sampling from a collection of past observed errors (the residuals),
each iteration of bootstrapping generates a different set of predictions.
See the References section for more information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values
(binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>steps</code> is not an integer or a valid date.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>exog</code> is missing or has invalid shape.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>n_boot</code> is not a positive integer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>use_in_sample_residuals=True</code> and <code>in_sample_residuals_</code> are not available.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>use_in_sample_residuals=False</code> and <code>out_sample_residuals_</code> are not available.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">boot_preds</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">boot_preds</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">(3, 5)</span>
</code></pre></div>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.
       https://otexts.com/fpp3/prediction-intervals.html</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span>
<span class="normal"><a href="#__codelineno-0-1881">1881</a></span>
<span class="normal"><a href="#__codelineno-0-1882">1882</a></span>
<span class="normal"><a href="#__codelineno-0-1883">1883</a></span>
<span class="normal"><a href="#__codelineno-0-1884">1884</a></span>
<span class="normal"><a href="#__codelineno-0-1885">1885</a></span>
<span class="normal"><a href="#__codelineno-0-1886">1886</a></span>
<span class="normal"><a href="#__codelineno-0-1887">1887</a></span>
<span class="normal"><a href="#__codelineno-0-1888">1888</a></span>
<span class="normal"><a href="#__codelineno-0-1889">1889</a></span>
<span class="normal"><a href="#__codelineno-0-1890">1890</a></span>
<span class="normal"><a href="#__codelineno-0-1891">1891</a></span>
<span class="normal"><a href="#__codelineno-0-1892">1892</a></span>
<span class="normal"><a href="#__codelineno-0-1893">1893</a></span>
<span class="normal"><a href="#__codelineno-0-1894">1894</a></span>
<span class="normal"><a href="#__codelineno-0-1895">1895</a></span>
<span class="normal"><a href="#__codelineno-0-1896">1896</a></span>
<span class="normal"><a href="#__codelineno-0-1897">1897</a></span>
<span class="normal"><a href="#__codelineno-0-1898">1898</a></span>
<span class="normal"><a href="#__codelineno-0-1899">1899</a></span>
<span class="normal"><a href="#__codelineno-0-1900">1900</a></span>
<span class="normal"><a href="#__codelineno-0-1901">1901</a></span>
<span class="normal"><a href="#__codelineno-0-1902">1902</a></span>
<span class="normal"><a href="#__codelineno-0-1903">1903</a></span>
<span class="normal"><a href="#__codelineno-0-1904">1904</a></span>
<span class="normal"><a href="#__codelineno-0-1905">1905</a></span>
<span class="normal"><a href="#__codelineno-0-1906">1906</a></span>
<span class="normal"><a href="#__codelineno-0-1907">1907</a></span>
<span class="normal"><a href="#__codelineno-0-1908">1908</a></span>
<span class="normal"><a href="#__codelineno-0-1909">1909</a></span>
<span class="normal"><a href="#__codelineno-0-1910">1910</a></span>
<span class="normal"><a href="#__codelineno-0-1911">1911</a></span>
<span class="normal"><a href="#__codelineno-0-1912">1912</a></span>
<span class="normal"><a href="#__codelineno-0-1913">1913</a></span>
<span class="normal"><a href="#__codelineno-0-1914">1914</a></span>
<span class="normal"><a href="#__codelineno-0-1915">1915</a></span>
<span class="normal"><a href="#__codelineno-0-1916">1916</a></span>
<span class="normal"><a href="#__codelineno-0-1917">1917</a></span>
<span class="normal"><a href="#__codelineno-0-1918">1918</a></span>
<span class="normal"><a href="#__codelineno-0-1919">1919</a></span>
<span class="normal"><a href="#__codelineno-0-1920">1920</a></span>
<span class="normal"><a href="#__codelineno-0-1921">1921</a></span>
<span class="normal"><a href="#__codelineno-0-1922">1922</a></span>
<span class="normal"><a href="#__codelineno-0-1923">1923</a></span>
<span class="normal"><a href="#__codelineno-0-1924">1924</a></span>
<span class="normal"><a href="#__codelineno-0-1925">1925</a></span>
<span class="normal"><a href="#__codelineno-0-1926">1926</a></span>
<span class="normal"><a href="#__codelineno-0-1927">1927</a></span>
<span class="normal"><a href="#__codelineno-0-1928">1928</a></span>
<span class="normal"><a href="#__codelineno-0-1929">1929</a></span>
<span class="normal"><a href="#__codelineno-0-1930">1930</a></span>
<span class="normal"><a href="#__codelineno-0-1931">1931</a></span>
<span class="normal"><a href="#__codelineno-0-1932">1932</a></span>
<span class="normal"><a href="#__codelineno-0-1933">1933</a></span>
<span class="normal"><a href="#__codelineno-0-1934">1934</a></span>
<span class="normal"><a href="#__codelineno-0-1935">1935</a></span>
<span class="normal"><a href="#__codelineno-0-1936">1936</a></span>
<span class="normal"><a href="#__codelineno-0-1937">1937</a></span>
<span class="normal"><a href="#__codelineno-0-1938">1938</a></span>
<span class="normal"><a href="#__codelineno-0-1939">1939</a></span>
<span class="normal"><a href="#__codelineno-0-1940">1940</a></span>
<span class="normal"><a href="#__codelineno-0-1941">1941</a></span>
<span class="normal"><a href="#__codelineno-0-1942">1942</a></span>
<span class="normal"><a href="#__codelineno-0-1943">1943</a></span>
<span class="normal"><a href="#__codelineno-0-1944">1944</a></span>
<span class="normal"><a href="#__codelineno-0-1945">1945</a></span>
<span class="normal"><a href="#__codelineno-0-1946">1946</a></span>
<span class="normal"><a href="#__codelineno-0-1947">1947</a></span>
<span class="normal"><a href="#__codelineno-0-1948">1948</a></span>
<span class="normal"><a href="#__codelineno-0-1949">1949</a></span>
<span class="normal"><a href="#__codelineno-0-1950">1950</a></span>
<span class="normal"><a href="#__codelineno-0-1951">1951</a></span>
<span class="normal"><a href="#__codelineno-0-1952">1952</a></span>
<span class="normal"><a href="#__codelineno-0-1953">1953</a></span>
<span class="normal"><a href="#__codelineno-0-1954">1954</a></span>
<span class="normal"><a href="#__codelineno-0-1955">1955</a></span>
<span class="normal"><a href="#__codelineno-0-1956">1956</a></span>
<span class="normal"><a href="#__codelineno-0-1957">1957</a></span>
<span class="normal"><a href="#__codelineno-0-1958">1958</a></span>
<span class="normal"><a href="#__codelineno-0-1959">1959</a></span>
<span class="normal"><a href="#__codelineno-0-1960">1960</a></span>
<span class="normal"><a href="#__codelineno-0-1961">1961</a></span>
<span class="normal"><a href="#__codelineno-0-1962">1962</a></span>
<span class="normal"><a href="#__codelineno-0-1963">1963</a></span>
<span class="normal"><a href="#__codelineno-0-1964">1964</a></span>
<span class="normal"><a href="#__codelineno-0-1965">1965</a></span>
<span class="normal"><a href="#__codelineno-0-1966">1966</a></span>
<span class="normal"><a href="#__codelineno-0-1967">1967</a></span>
<span class="normal"><a href="#__codelineno-0-1968">1968</a></span>
<span class="normal"><a href="#__codelineno-0-1969">1969</a></span>
<span class="normal"><a href="#__codelineno-0-1970">1970</a></span>
<span class="normal"><a href="#__codelineno-0-1971">1971</a></span>
<span class="normal"><a href="#__codelineno-0-1972">1972</a></span>
<span class="normal"><a href="#__codelineno-0-1973">1973</a></span>
<span class="normal"><a href="#__codelineno-0-1974">1974</a></span>
<span class="normal"><a href="#__codelineno-0-1975">1975</a></span>
<span class="normal"><a href="#__codelineno-0-1976">1976</a></span>
<span class="normal"><a href="#__codelineno-0-1977">1977</a></span>
<span class="normal"><a href="#__codelineno-0-1978">1978</a></span>
<span class="normal"><a href="#__codelineno-0-1979">1979</a></span>
<span class="normal"><a href="#__codelineno-0-1980">1980</a></span>
<span class="normal"><a href="#__codelineno-0-1981">1981</a></span>
<span class="normal"><a href="#__codelineno-0-1982">1982</a></span>
<span class="normal"><a href="#__codelineno-0-1983">1983</a></span>
<span class="normal"><a href="#__codelineno-0-1984">1984</a></span>
<span class="normal"><a href="#__codelineno-0-1985">1985</a></span>
<span class="normal"><a href="#__codelineno-0-1986">1986</a></span>
<span class="normal"><a href="#__codelineno-0-1987">1987</a></span>
<span class="normal"><a href="#__codelineno-0-1988">1988</a></span>
<span class="normal"><a href="#__codelineno-0-1989">1989</a></span>
<span class="normal"><a href="#__codelineno-0-1990">1990</a></span>
<span class="normal"><a href="#__codelineno-0-1991">1991</a></span>
<span class="normal"><a href="#__codelineno-0-1992">1992</a></span>
<span class="normal"><a href="#__codelineno-0-1993">1993</a></span>
<span class="normal"><a href="#__codelineno-0-1994">1994</a></span>
<span class="normal"><a href="#__codelineno-0-1995">1995</a></span>
<span class="normal"><a href="#__codelineno-0-1996">1996</a></span>
<span class="normal"><a href="#__codelineno-0-1997">1997</a></span>
<span class="normal"><a href="#__codelineno-0-1998">1998</a></span>
<span class="normal"><a href="#__codelineno-0-1999">1999</a></span>
<span class="normal"><a href="#__codelineno-0-2000">2000</a></span>
<span class="normal"><a href="#__codelineno-0-2001">2001</a></span>
<span class="normal"><a href="#__codelineno-0-2002">2002</a></span>
<span class="normal"><a href="#__codelineno-0-2003">2003</a></span>
<span class="normal"><a href="#__codelineno-0-2004">2004</a></span>
<span class="normal"><a href="#__codelineno-0-2005">2005</a></span>
<span class="normal"><a href="#__codelineno-0-2006">2006</a></span>
<span class="normal"><a href="#__codelineno-0-2007">2007</a></span>
<span class="normal"><a href="#__codelineno-0-2008">2008</a></span>
<span class="normal"><a href="#__codelineno-0-2009">2009</a></span>
<span class="normal"><a href="#__codelineno-0-2010">2010</a></span>
<span class="normal"><a href="#__codelineno-0-2011">2011</a></span>
<span class="normal"><a href="#__codelineno-0-2012">2012</a></span>
<span class="normal"><a href="#__codelineno-0-2013">2013</a></span>
<span class="normal"><a href="#__codelineno-0-2014">2014</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1861" name="__codelineno-0-1861"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a><span class="sd">    Generate multiple forecasting predictions using a bootstrapping process.</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a><span class="sd">    By sampling from a collection of past observed errors (the residuals),</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a><span class="sd">    each iteration of bootstrapping generates a different set of predictions.</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a><span class="sd">    See the References section for more information.</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-1881" name="__codelineno-0-1881"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-1882" name="__codelineno-0-1882"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-1883" name="__codelineno-0-1883"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-1884" name="__codelineno-0-1884"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-1885" name="__codelineno-0-1885"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-1886" name="__codelineno-0-1886"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-1887" name="__codelineno-0-1887"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-1888" name="__codelineno-0-1888"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-1889" name="__codelineno-0-1889"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-1890" name="__codelineno-0-1890"></a><span class="sd">        n_boot:</span>
<a id="__codelineno-0-1891" name="__codelineno-0-1891"></a><span class="sd">            Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-1892" name="__codelineno-0-1892"></a><span class="sd">            intervals. Defaults to 250.</span>
<a id="__codelineno-0-1893" name="__codelineno-0-1893"></a><span class="sd">        use_in_sample_residuals:</span>
<a id="__codelineno-0-1894" name="__codelineno-0-1894"></a><span class="sd">            If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-1895" name="__codelineno-0-1895"></a><span class="sd">            prediction error to create predictions.</span>
<a id="__codelineno-0-1896" name="__codelineno-0-1896"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-1897" name="__codelineno-0-1897"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-1898" name="__codelineno-0-1898"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-1899" name="__codelineno-0-1899"></a><span class="sd">        use_binned_residuals:</span>
<a id="__codelineno-0-1900" name="__codelineno-0-1900"></a><span class="sd">            If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-1901" name="__codelineno-0-1901"></a><span class="sd">            (binned selection).</span>
<a id="__codelineno-0-1902" name="__codelineno-0-1902"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-1903" name="__codelineno-0-1903"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-1904" name="__codelineno-0-1904"></a><span class="sd">            Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-1905" name="__codelineno-0-1905"></a>
<a id="__codelineno-0-1906" name="__codelineno-0-1906"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1907" name="__codelineno-0-1907"></a><span class="sd">        Pandas DataFrame with predictions generated by bootstrapping. Shape: (steps, n_boot).</span>
<a id="__codelineno-0-1908" name="__codelineno-0-1908"></a>
<a id="__codelineno-0-1909" name="__codelineno-0-1909"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1910" name="__codelineno-0-1910"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1911" name="__codelineno-0-1911"></a><span class="sd">            If `steps` is not an integer or a valid date.</span>
<a id="__codelineno-0-1912" name="__codelineno-0-1912"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1913" name="__codelineno-0-1913"></a><span class="sd">            If `exog` is missing or has invalid shape.</span>
<a id="__codelineno-0-1914" name="__codelineno-0-1914"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1915" name="__codelineno-0-1915"></a><span class="sd">            If `n_boot` is not a positive integer.</span>
<a id="__codelineno-0-1916" name="__codelineno-0-1916"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1917" name="__codelineno-0-1917"></a><span class="sd">            If `use_in_sample_residuals=True` and `in_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1918" name="__codelineno-0-1918"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-1919" name="__codelineno-0-1919"></a><span class="sd">            If `use_in_sample_residuals=False` and `out_sample_residuals_` are not available.</span>
<a id="__codelineno-0-1920" name="__codelineno-0-1920"></a>
<a id="__codelineno-0-1921" name="__codelineno-0-1921"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1922" name="__codelineno-0-1922"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1923" name="__codelineno-0-1923"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1924" name="__codelineno-0-1924"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1925" name="__codelineno-0-1925"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1926" name="__codelineno-0-1926"></a><span class="sd">        &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-1927" name="__codelineno-0-1927"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-1928" name="__codelineno-0-1928"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1929" name="__codelineno-0-1929"></a><span class="sd">        &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-1930" name="__codelineno-0-1930"></a><span class="sd">        &gt;&gt;&gt; boot_preds = forecaster.predict_bootstrapping(steps=3, n_boot=5)</span>
<a id="__codelineno-0-1931" name="__codelineno-0-1931"></a><span class="sd">        &gt;&gt;&gt; boot_preds.shape</span>
<a id="__codelineno-0-1932" name="__codelineno-0-1932"></a><span class="sd">        (3, 5)</span>
<a id="__codelineno-0-1933" name="__codelineno-0-1933"></a>
<a id="__codelineno-0-1934" name="__codelineno-0-1934"></a><span class="sd">    References:</span>
<a id="__codelineno-0-1935" name="__codelineno-0-1935"></a><span class="sd">        .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-1936" name="__codelineno-0-1936"></a><span class="sd">               https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-1937" name="__codelineno-0-1937"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1938" name="__codelineno-0-1938"></a>
<a id="__codelineno-0-1939" name="__codelineno-0-1939"></a>    <span class="p">(</span>
<a id="__codelineno-0-1940" name="__codelineno-0-1940"></a>        <span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1941" name="__codelineno-0-1941"></a>        <span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1942" name="__codelineno-0-1942"></a>        <span class="n">prediction_index</span><span class="p">,</span>
<a id="__codelineno-0-1943" name="__codelineno-0-1943"></a>        <span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1944" name="__codelineno-0-1944"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
<a id="__codelineno-0-1945" name="__codelineno-0-1945"></a>        <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1946" name="__codelineno-0-1946"></a>        <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-1947" name="__codelineno-0-1947"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-1948" name="__codelineno-0-1948"></a>        <span class="n">predict_probabilistic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1949" name="__codelineno-0-1949"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1950" name="__codelineno-0-1950"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1951" name="__codelineno-0-1951"></a>        <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1952" name="__codelineno-0-1952"></a>    <span class="p">)</span>
<a id="__codelineno-0-1953" name="__codelineno-0-1953"></a>
<a id="__codelineno-0-1954" name="__codelineno-0-1954"></a>    <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1955" name="__codelineno-0-1955"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-1956" name="__codelineno-0-1956"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1957" name="__codelineno-0-1957"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1958" name="__codelineno-0-1958"></a>        <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-1959" name="__codelineno-0-1959"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-1960" name="__codelineno-0-1960"></a>
<a id="__codelineno-0-1961" name="__codelineno-0-1961"></a>    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1962" name="__codelineno-0-1962"></a>    <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-1963" name="__codelineno-0-1963"></a>        <span class="c1"># Create 3D array with sampled residuals: (n_bins, steps, n_boot)</span>
<a id="__codelineno-0-1964" name="__codelineno-0-1964"></a>        <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">)</span>
<a id="__codelineno-0-1965" name="__codelineno-0-1965"></a>        <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-1966" name="__codelineno-0-1966"></a>            <span class="p">[</span>
<a id="__codelineno-0-1967" name="__codelineno-0-1967"></a>                <span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">][</span>
<a id="__codelineno-0-1968" name="__codelineno-0-1968"></a>                    <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span>
<a id="__codelineno-0-1969" name="__codelineno-0-1969"></a>                        <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">)</span>
<a id="__codelineno-0-1970" name="__codelineno-0-1970"></a>                    <span class="p">)</span>
<a id="__codelineno-0-1971" name="__codelineno-0-1971"></a>                <span class="p">]</span>
<a id="__codelineno-0-1972" name="__codelineno-0-1972"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">)</span>
<a id="__codelineno-0-1973" name="__codelineno-0-1973"></a>            <span class="p">],</span>
<a id="__codelineno-0-1974" name="__codelineno-0-1974"></a>            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1975" name="__codelineno-0-1975"></a>        <span class="p">)</span>
<a id="__codelineno-0-1976" name="__codelineno-0-1976"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1977" name="__codelineno-0-1977"></a>        <span class="n">sampled_residuals</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span>
<a id="__codelineno-0-1978" name="__codelineno-0-1978"></a>            <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">))</span>
<a id="__codelineno-0-1979" name="__codelineno-0-1979"></a>        <span class="p">]</span>
<a id="__codelineno-0-1980" name="__codelineno-0-1980"></a>
<a id="__codelineno-0-1981" name="__codelineno-0-1981"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-1982" name="__codelineno-0-1982"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-1983" name="__codelineno-0-1983"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1984" name="__codelineno-0-1984"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1985" name="__codelineno-0-1985"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-1986" name="__codelineno-0-1986"></a>        <span class="p">)</span>
<a id="__codelineno-0-1987" name="__codelineno-0-1987"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-1988" name="__codelineno-0-1988"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-1989" name="__codelineno-0-1989"></a>            <span class="n">last_window_values</span><span class="o">=</span><span class="n">last_window_values</span><span class="p">,</span>
<a id="__codelineno-0-1990" name="__codelineno-0-1990"></a>            <span class="n">exog_values</span><span class="o">=</span><span class="n">exog_values</span><span class="p">,</span>
<a id="__codelineno-0-1991" name="__codelineno-0-1991"></a>            <span class="n">sampled_residuals</span><span class="o">=</span><span class="n">sampled_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1992" name="__codelineno-0-1992"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-1993" name="__codelineno-0-1993"></a>            <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-1994" name="__codelineno-0-1994"></a>        <span class="p">)</span>
<a id="__codelineno-0-1995" name="__codelineno-0-1995"></a>
<a id="__codelineno-0-1996" name="__codelineno-0-1996"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1997" name="__codelineno-0-1997"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span>
<a id="__codelineno-0-1998" name="__codelineno-0-1998"></a>            <span class="n">boot_predictions</span>
<a id="__codelineno-0-1999" name="__codelineno-0-1999"></a>        <span class="p">)</span>
<a id="__codelineno-0-2000" name="__codelineno-0-2000"></a>
<a id="__codelineno-0-2001" name="__codelineno-0-2001"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2002" name="__codelineno-0-2002"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2003" name="__codelineno-0-2003"></a>            <span class="n">array</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span>
<a id="__codelineno-0-2004" name="__codelineno-0-2004"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2005" name="__codelineno-0-2005"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2006" name="__codelineno-0-2006"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2007" name="__codelineno-0-2007"></a>        <span class="p">)</span>
<a id="__codelineno-0-2008" name="__codelineno-0-2008"></a>
<a id="__codelineno-0-2009" name="__codelineno-0-2009"></a>    <span class="n">boot_columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">)]</span>
<a id="__codelineno-0-2010" name="__codelineno-0-2010"></a>    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2011" name="__codelineno-0-2011"></a>        <span class="n">data</span><span class="o">=</span><span class="n">boot_predictions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">prediction_index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">boot_columns</span>
<a id="__codelineno-0-2012" name="__codelineno-0-2012"></a>    <span class="p">)</span>
<a id="__codelineno-0-2013" name="__codelineno-0-2013"></a>
<a id="__codelineno-0-2014" name="__codelineno-0-2014"></a>    <span class="k">return</span> <span class="n">boot_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.predict_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_interval</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict n steps ahead and estimate prediction intervals using either
bootstrapping or conformal prediction methods. Refer to the References
section for additional details on these methods.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to predict.
- If steps is int, number of steps to predict.
- If str or pandas Datetime, the prediction will be up to that date.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:
- 'bootstrapping': Bootstrapping is used to generate prediction
  intervals [1]<em>.
- 'conformal': Employs the conformal prediction split method for
  interval estimation [2]</em>.
Defaults to 'bootstrapping'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="list">list</span>[<span title="float">float</span>] | <span title="tuple">tuple</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level of the prediction interval. Interpretation depends
on the method used:
- If <code>float</code>, represents the nominal (expected) coverage (between 0
  and 1). For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code>
  percentiles.
- If <code>list</code> or <code>tuple</code>, defines the exact percentiles to compute, which
  must be between 0 and 100 inclusive. For example, interval
  of 95% should be as <code>interval = [2.5, 97.5]</code>.
- When using <code>method='conformal'</code>, the interval must be a float or
  a list/tuple defining a symmetric interval.
Defaults to [5, 95].</p>
              </div>
            </td>
            <td>
                  <code>[5, 95]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values
(binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame with values predicted by the forecaster and their estimated interval.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>pred: predictions.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>lower_bound: lower bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>method</code> is not 'bootstrapping' or 'conformal'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>interval</code> is invalid or not compatible with the chosen method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs (<code>steps</code>, <code>exog</code>, etc.) are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bootstrapping method</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_boot</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_boot</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">[&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Conformal method</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_conf</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;conformal&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.95</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">intervals_conf</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
</code></pre></div>


<details class="references" open>
  <summary>References</summary>
  <p>.. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.
       https://otexts.com/fpp3/prediction-intervals.html
.. [2] MAPIE - Model Agnostic Prediction Interval Estimator.
       https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2166">2166</a></span>
<span class="normal"><a href="#__codelineno-0-2167">2167</a></span>
<span class="normal"><a href="#__codelineno-0-2168">2168</a></span>
<span class="normal"><a href="#__codelineno-0-2169">2169</a></span>
<span class="normal"><a href="#__codelineno-0-2170">2170</a></span>
<span class="normal"><a href="#__codelineno-0-2171">2171</a></span>
<span class="normal"><a href="#__codelineno-0-2172">2172</a></span>
<span class="normal"><a href="#__codelineno-0-2173">2173</a></span>
<span class="normal"><a href="#__codelineno-0-2174">2174</a></span>
<span class="normal"><a href="#__codelineno-0-2175">2175</a></span>
<span class="normal"><a href="#__codelineno-0-2176">2176</a></span>
<span class="normal"><a href="#__codelineno-0-2177">2177</a></span>
<span class="normal"><a href="#__codelineno-0-2178">2178</a></span>
<span class="normal"><a href="#__codelineno-0-2179">2179</a></span>
<span class="normal"><a href="#__codelineno-0-2180">2180</a></span>
<span class="normal"><a href="#__codelineno-0-2181">2181</a></span>
<span class="normal"><a href="#__codelineno-0-2182">2182</a></span>
<span class="normal"><a href="#__codelineno-0-2183">2183</a></span>
<span class="normal"><a href="#__codelineno-0-2184">2184</a></span>
<span class="normal"><a href="#__codelineno-0-2185">2185</a></span>
<span class="normal"><a href="#__codelineno-0-2186">2186</a></span>
<span class="normal"><a href="#__codelineno-0-2187">2187</a></span>
<span class="normal"><a href="#__codelineno-0-2188">2188</a></span>
<span class="normal"><a href="#__codelineno-0-2189">2189</a></span>
<span class="normal"><a href="#__codelineno-0-2190">2190</a></span>
<span class="normal"><a href="#__codelineno-0-2191">2191</a></span>
<span class="normal"><a href="#__codelineno-0-2192">2192</a></span>
<span class="normal"><a href="#__codelineno-0-2193">2193</a></span>
<span class="normal"><a href="#__codelineno-0-2194">2194</a></span>
<span class="normal"><a href="#__codelineno-0-2195">2195</a></span>
<span class="normal"><a href="#__codelineno-0-2196">2196</a></span>
<span class="normal"><a href="#__codelineno-0-2197">2197</a></span>
<span class="normal"><a href="#__codelineno-0-2198">2198</a></span>
<span class="normal"><a href="#__codelineno-0-2199">2199</a></span>
<span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span>
<span class="normal"><a href="#__codelineno-0-2247">2247</a></span>
<span class="normal"><a href="#__codelineno-0-2248">2248</a></span>
<span class="normal"><a href="#__codelineno-0-2249">2249</a></span>
<span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2166" name="__codelineno-0-2166"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_interval</span><span class="p">(</span>
<a id="__codelineno-0-2167" name="__codelineno-0-2167"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2168" name="__codelineno-0-2168"></a>    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-2169" name="__codelineno-0-2169"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2170" name="__codelineno-0-2170"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2171" name="__codelineno-0-2171"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2172" name="__codelineno-0-2172"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
<a id="__codelineno-0-2173" name="__codelineno-0-2173"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-2174" name="__codelineno-0-2174"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2175" name="__codelineno-0-2175"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2176" name="__codelineno-0-2176"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2177" name="__codelineno-0-2177"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-2178" name="__codelineno-0-2178"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2179" name="__codelineno-0-2179"></a><span class="sd">    Predict n steps ahead and estimate prediction intervals using either</span>
<a id="__codelineno-0-2180" name="__codelineno-0-2180"></a><span class="sd">    bootstrapping or conformal prediction methods. Refer to the References</span>
<a id="__codelineno-0-2181" name="__codelineno-0-2181"></a><span class="sd">    section for additional details on these methods.</span>
<a id="__codelineno-0-2182" name="__codelineno-0-2182"></a>
<a id="__codelineno-0-2183" name="__codelineno-0-2183"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-2184" name="__codelineno-0-2184"></a><span class="sd">        steps:</span>
<a id="__codelineno-0-2185" name="__codelineno-0-2185"></a><span class="sd">            Number of steps to predict.</span>
<a id="__codelineno-0-2186" name="__codelineno-0-2186"></a><span class="sd">            - If steps is int, number of steps to predict.</span>
<a id="__codelineno-0-2187" name="__codelineno-0-2187"></a><span class="sd">            - If str or pandas Datetime, the prediction will be up to that date.</span>
<a id="__codelineno-0-2188" name="__codelineno-0-2188"></a><span class="sd">        last_window:</span>
<a id="__codelineno-0-2189" name="__codelineno-0-2189"></a><span class="sd">            Series values used to create the predictors (lags) needed in the</span>
<a id="__codelineno-0-2190" name="__codelineno-0-2190"></a><span class="sd">            first iteration of the prediction (t + 1).</span>
<a id="__codelineno-0-2191" name="__codelineno-0-2191"></a><span class="sd">            If `last_window = None`, the values stored in `self.last_window_` are</span>
<a id="__codelineno-0-2192" name="__codelineno-0-2192"></a><span class="sd">            used to calculate the initial predictors, and the predictions start</span>
<a id="__codelineno-0-2193" name="__codelineno-0-2193"></a><span class="sd">            right after training data. Defaults to None.</span>
<a id="__codelineno-0-2194" name="__codelineno-0-2194"></a><span class="sd">        exog:</span>
<a id="__codelineno-0-2195" name="__codelineno-0-2195"></a><span class="sd">            Exogenous variable/s included as predictor/s. Defaults to None.</span>
<a id="__codelineno-0-2196" name="__codelineno-0-2196"></a><span class="sd">        method:</span>
<a id="__codelineno-0-2197" name="__codelineno-0-2197"></a><span class="sd">            Technique used to estimate prediction intervals. Available options:</span>
<a id="__codelineno-0-2198" name="__codelineno-0-2198"></a><span class="sd">            - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction</span>
<a id="__codelineno-0-2199" name="__codelineno-0-2199"></a><span class="sd">              intervals [1]_.</span>
<a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="sd">              interval estimation [2]_.</span>
<a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">            Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-2203" name="__codelineno-0-2203"></a><span class="sd">        interval:</span>
<a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">            Confidence level of the prediction interval. Interpretation depends</span>
<a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">            on the method used:</span>
<a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0</span>
<a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">              and 1). For instance, `interval=0.95` corresponds to `[2.5, 97.5]`</span>
<a id="__codelineno-0-2208" name="__codelineno-0-2208"></a><span class="sd">              percentiles.</span>
<a id="__codelineno-0-2209" name="__codelineno-0-2209"></a><span class="sd">            - If `list` or `tuple`, defines the exact percentiles to compute, which</span>
<a id="__codelineno-0-2210" name="__codelineno-0-2210"></a><span class="sd">              must be between 0 and 100 inclusive. For example, interval</span>
<a id="__codelineno-0-2211" name="__codelineno-0-2211"></a><span class="sd">              of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-2212" name="__codelineno-0-2212"></a><span class="sd">            - When using `method=&#39;conformal&#39;`, the interval must be a float or</span>
<a id="__codelineno-0-2213" name="__codelineno-0-2213"></a><span class="sd">              a list/tuple defining a symmetric interval.</span>
<a id="__codelineno-0-2214" name="__codelineno-0-2214"></a><span class="sd">            Defaults to [5, 95].</span>
<a id="__codelineno-0-2215" name="__codelineno-0-2215"></a><span class="sd">        n_boot:</span>
<a id="__codelineno-0-2216" name="__codelineno-0-2216"></a><span class="sd">            Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-2217" name="__codelineno-0-2217"></a><span class="sd">            intervals. Defaults to 250.</span>
<a id="__codelineno-0-2218" name="__codelineno-0-2218"></a><span class="sd">        use_in_sample_residuals:</span>
<a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="sd">            If `True`, residuals from the training data are used as proxy of</span>
<a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">            prediction error to create predictions.</span>
<a id="__codelineno-0-2221" name="__codelineno-0-2221"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        use_binned_residuals:</span>
<a id="__codelineno-0-2225" name="__codelineno-0-2225"></a><span class="sd">            If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-2226" name="__codelineno-0-2226"></a><span class="sd">            (binned selection).</span>
<a id="__codelineno-0-2227" name="__codelineno-0-2227"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-2228" name="__codelineno-0-2228"></a><span class="sd">        random_state:</span>
<a id="__codelineno-0-2229" name="__codelineno-0-2229"></a><span class="sd">            Seed for the random number generator to ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-2230" name="__codelineno-0-2230"></a>
<a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="sd">        Pandas DataFrame with values predicted by the forecaster and their estimated interval.</span>
<a id="__codelineno-0-2233" name="__codelineno-0-2233"></a><span class="sd">        - pred: predictions.</span>
<a id="__codelineno-0-2234" name="__codelineno-0-2234"></a><span class="sd">        - lower_bound: lower bound of the interval.</span>
<a id="__codelineno-0-2235" name="__codelineno-0-2235"></a><span class="sd">        - upper_bound: upper bound of the interval.</span>
<a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
<a id="__codelineno-0-2237" name="__codelineno-0-2237"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">            If `method` is not &#39;bootstrapping&#39; or &#39;conformal&#39;.</span>
<a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2241" name="__codelineno-0-2241"></a><span class="sd">             If `interval` is invalid or not compatible with the chosen method.</span>
<a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="sd">            If inputs (`steps`, `exog`, etc.) are invalid.</span>
<a id="__codelineno-0-2244" name="__codelineno-0-2244"></a>
<a id="__codelineno-0-2245" name="__codelineno-0-2245"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-2246" name="__codelineno-0-2246"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-2247" name="__codelineno-0-2247"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-2248" name="__codelineno-0-2248"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-2249" name="__codelineno-0-2249"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="sd">        &gt;&gt;&gt; rng = np.random.default_rng(123)</span>
<a id="__codelineno-0-2251" name="__codelineno-0-2251"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(rng.normal(size=100), name=&#39;y&#39;)</span>
<a id="__codelineno-0-2252" name="__codelineno-0-2252"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-2253" name="__codelineno-0-2253"></a><span class="sd">        &gt;&gt;&gt; _ = forecaster.fit(y=y)</span>
<a id="__codelineno-0-2254" name="__codelineno-0-2254"></a><span class="sd">        &gt;&gt;&gt; # Bootstrapping method</span>
<a id="__codelineno-0-2255" name="__codelineno-0-2255"></a><span class="sd">        &gt;&gt;&gt; intervals_boot = forecaster.predict_interval(</span>
<a id="__codelineno-0-2256" name="__codelineno-0-2256"></a><span class="sd">        ...     steps=3, method=&#39;bootstrapping&#39;, interval=[5, 95]</span>
<a id="__codelineno-0-2257" name="__codelineno-0-2257"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-2258" name="__codelineno-0-2258"></a><span class="sd">        &gt;&gt;&gt; intervals_boot.columns.tolist()</span>
<a id="__codelineno-0-2259" name="__codelineno-0-2259"></a><span class="sd">        [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>
<a id="__codelineno-0-2261" name="__codelineno-0-2261"></a><span class="sd">        &gt;&gt;&gt; # Conformal method</span>
<a id="__codelineno-0-2262" name="__codelineno-0-2262"></a><span class="sd">        &gt;&gt;&gt; intervals_conf = forecaster.predict_interval(</span>
<a id="__codelineno-0-2263" name="__codelineno-0-2263"></a><span class="sd">        ...     steps=3, method=&#39;conformal&#39;, interval=0.95</span>
<a id="__codelineno-0-2264" name="__codelineno-0-2264"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-2265" name="__codelineno-0-2265"></a><span class="sd">        &gt;&gt;&gt; intervals_conf.columns.tolist()</span>
<a id="__codelineno-0-2266" name="__codelineno-0-2266"></a><span class="sd">        [&#39;pred&#39;, &#39;lower_bound&#39;, &#39;upper_bound&#39;]</span>
<a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>
<a id="__codelineno-0-2268" name="__codelineno-0-2268"></a><span class="sd">    References:</span>
<a id="__codelineno-0-2269" name="__codelineno-0-2269"></a><span class="sd">        .. [1] Forecasting: Principles and Practice (3rd ed) Rob J Hyndman and George Athanasopoulos.</span>
<a id="__codelineno-0-2270" name="__codelineno-0-2270"></a><span class="sd">               https://otexts.com/fpp3/prediction-intervals.html</span>
<a id="__codelineno-0-2271" name="__codelineno-0-2271"></a><span class="sd">        .. [2] MAPIE - Model Agnostic Prediction Interval Estimator.</span>
<a id="__codelineno-0-2272" name="__codelineno-0-2272"></a><span class="sd">               https://mapie.readthedocs.io/en/stable/theoretical_description_regression.html#the-split-method</span>
<a id="__codelineno-0-2273" name="__codelineno-0-2273"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>
<a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>
<a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>            <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>            <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">interval</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>
<a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>        <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
<a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>            <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>        <span class="p">)</span>
<a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>
<a id="__codelineno-0-2294" name="__codelineno-0-2294"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
<a id="__codelineno-0-2295" name="__codelineno-0-2295"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">check_inputs</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>        <span class="p">)</span>
<a id="__codelineno-0-2297" name="__codelineno-0-2297"></a>
<a id="__codelineno-0-2298" name="__codelineno-0-2298"></a>        <span class="n">predictions_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
<a id="__codelineno-0-2299" name="__codelineno-0-2299"></a>            <span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>        <span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>        <span class="n">predictions_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lower_bound&quot;</span><span class="p">,</span> <span class="s2">&quot;upper_bound&quot;</span><span class="p">]</span>
<a id="__codelineno-0-2302" name="__codelineno-0-2302"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">predictions</span><span class="p">,</span> <span class="n">predictions_interval</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2303" name="__codelineno-0-2303"></a>
<a id="__codelineno-0-2304" name="__codelineno-0-2304"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-2305" name="__codelineno-0-2305"></a>
<a id="__codelineno-0-2306" name="__codelineno-0-2306"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-2307" name="__codelineno-0-2307"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2308" name="__codelineno-0-2308"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span>
<a id="__codelineno-0-2309" name="__codelineno-0-2309"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2310" name="__codelineno-0-2310"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2311" name="__codelineno-0-2311"></a>            <span class="n">nominal_coverage</span> <span class="o">=</span> <span class="n">interval</span>
<a id="__codelineno-0-2312" name="__codelineno-0-2312"></a>
<a id="__codelineno-0-2313" name="__codelineno-0-2313"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_interval_conformal</span><span class="p">(</span>
<a id="__codelineno-0-2314" name="__codelineno-0-2314"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-2315" name="__codelineno-0-2315"></a>            <span class="n">last_window</span><span class="o">=</span><span class="n">last_window</span><span class="p">,</span>
<a id="__codelineno-0-2316" name="__codelineno-0-2316"></a>            <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-2317" name="__codelineno-0-2317"></a>            <span class="n">nominal_coverage</span><span class="o">=</span><span class="n">nominal_coverage</span><span class="p">,</span>
<a id="__codelineno-0-2318" name="__codelineno-0-2318"></a>            <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2319" name="__codelineno-0-2319"></a>            <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-2320" name="__codelineno-0-2320"></a>        <span class="p">)</span>
<a id="__codelineno-0-2321" name="__codelineno-0-2321"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2322" name="__codelineno-0-2322"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2323" name="__codelineno-0-2323"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid `method` &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;. Choose &#39;bootstrapping&#39; or &#39;conformal&#39;.&quot;</span>
<a id="__codelineno-0-2324" name="__codelineno-0-2324"></a>        <span class="p">)</span>
<a id="__codelineno-0-2325" name="__codelineno-0-2325"></a>
<a id="__codelineno-0-2326" name="__codelineno-0-2326"></a>    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_in_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_in_sample_residuals</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set in-sample residuals in case they were not calculated during the
training process.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span>
<span class="normal"><a href="#__codelineno-0-2403">2403</a></span>
<span class="normal"><a href="#__codelineno-0-2404">2404</a></span>
<span class="normal"><a href="#__codelineno-0-2405">2405</a></span>
<span class="normal"><a href="#__codelineno-0-2406">2406</a></span>
<span class="normal"><a href="#__codelineno-0-2407">2407</a></span>
<span class="normal"><a href="#__codelineno-0-2408">2408</a></span>
<span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2388" name="__codelineno-0-2388"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2389" name="__codelineno-0-2389"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2390" name="__codelineno-0-2390"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-2391" name="__codelineno-0-2391"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="sd">    Set in-sample residuals in case they were not calculated during the</span>
<a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="sd">    training process.</span>
<a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>            <span class="s2">&quot;arguments before using `set_in_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>        <span class="p">)</span>
<a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>
<a id="__codelineno-0-2403" name="__codelineno-0-2403"></a>    <span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-2404" name="__codelineno-0-2404"></a>    <span class="n">y_index_range</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-2405" name="__codelineno-0-2405"></a>        <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`y`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2406" name="__codelineno-0-2406"></a>    <span class="p">)[</span><span class="mi">1</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-2407" name="__codelineno-0-2407"></a>
<a id="__codelineno-0-2408" name="__codelineno-0-2408"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">y_index_range</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">):</span>
<a id="__codelineno-0-2409" name="__codelineno-0-2409"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-2410" name="__codelineno-0-2410"></a>            <span class="sa">f</span><span class="s2">&quot;The index range of `y` does not match the range &quot;</span>
<a id="__codelineno-0-2411" name="__codelineno-0-2411"></a>            <span class="sa">f</span><span class="s2">&quot;used during training. Please ensure the index is aligned &quot;</span>
<a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>            <span class="sa">f</span><span class="s2">&quot;with the training data.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>            <span class="sa">f</span><span class="s2">&quot;    Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2414" name="__codelineno-0-2414"></a>            <span class="sa">f</span><span class="s2">&quot;    Received : </span><span class="si">{</span><span class="n">y_index_range</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2415" name="__codelineno-0-2415"></a>        <span class="p">)</span>
<a id="__codelineno-0-2416" name="__codelineno-0-2416"></a>
<a id="__codelineno-0-2417" name="__codelineno-0-2417"></a>    <span class="p">(</span>
<a id="__codelineno-0-2418" name="__codelineno-0-2418"></a>        <span class="n">X_train</span><span class="p">,</span>
<a id="__codelineno-0-2419" name="__codelineno-0-2419"></a>        <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-0-2420" name="__codelineno-0-2420"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>        <span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>        <span class="n">X_train_features_names_out_</span><span class="p">,</span>
<a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>        <span class="o">*</span><span class="n">_</span><span class="p">,</span>
<a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>
<a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">X_train_features_names_out_</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">:</span>
<a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>            <span class="sa">f</span><span class="s2">&quot;Feature mismatch detected after matrix creation. The features &quot;</span>
<a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>            <span class="sa">f</span><span class="s2">&quot;generated from the provided data do not match those used during &quot;</span>
<a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>            <span class="sa">f</span><span class="s2">&quot;the training process. To correctly set in-sample residuals, &quot;</span>
<a id="__codelineno-0-2432" name="__codelineno-0-2432"></a>            <span class="sa">f</span><span class="s2">&quot;ensure that the same data and preprocessing steps are applied.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>            <span class="sa">f</span><span class="s2">&quot;    Expected output : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>            <span class="sa">f</span><span class="s2">&quot;    Current output  : </span><span class="si">{</span><span class="n">X_train_features_names_out_</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>        <span class="p">)</span>
<a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>
<a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_binning_in_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>        <span class="n">y_true</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>        <span class="n">y_pred</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
<a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>        <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_out_sample_residuals" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_out_sample_residuals</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set new values to the attribute <code>out_sample_residuals_</code>.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
<a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>    <span class="n">y_true</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>    <span class="n">y_pred</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>    <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-2450" name="__codelineno-0-2450"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2451" name="__codelineno-0-2451"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2452" name="__codelineno-0-2452"></a><span class="sd">    Set new values to the attribute `out_sample_residuals_`.</span>
<a id="__codelineno-0-2453" name="__codelineno-0-2453"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>            <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
<a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>        <span class="p">)</span>
<a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
<a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>        <span class="p">)</span>
<a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>
<a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
<a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>            <span class="sa">f</span><span class="s2">&quot;`y_pred` argument must be `numpy ndarray` or `pandas Series`. &quot;</span>
<a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2470" name="__codelineno-0-2470"></a>        <span class="p">)</span>
<a id="__codelineno-0-2471" name="__codelineno-0-2471"></a>
<a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-0-2473" name="__codelineno-0-2473"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-2474" name="__codelineno-0-2474"></a>            <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
<a id="__codelineno-0-2475" name="__codelineno-0-2475"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="p">)</span>
<a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>
<a id="__codelineno-0-2478" name="__codelineno-0-2478"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-2479" name="__codelineno-0-2479"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-2480" name="__codelineno-0-2480"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`y_true` and `y_pred` must have the same index.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-2481" name="__codelineno-0-2481"></a>
<a id="__codelineno-0-2482" name="__codelineno-0-2482"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2483" name="__codelineno-0-2483"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2486" name="__codelineno-0-2486"></a>
<a id="__codelineno-0-2487" name="__codelineno-0-2487"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">:</span>
<a id="__codelineno-0-2488" name="__codelineno-0-2488"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2489" name="__codelineno-0-2489"></a>            <span class="n">array</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-0-2490" name="__codelineno-0-2490"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2491" name="__codelineno-0-2491"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2492" name="__codelineno-0-2492"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2493" name="__codelineno-0-2493"></a>        <span class="p">)</span>
<a id="__codelineno-0-2494" name="__codelineno-0-2494"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-2495" name="__codelineno-0-2495"></a>            <span class="n">array</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>            <span class="n">transformer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_y</span><span class="p">,</span>
<a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>            <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>            <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>        <span class="p">)</span>
<a id="__codelineno-0-2500" name="__codelineno-0-2500"></a>
<a id="__codelineno-0-2501" name="__codelineno-0-2501"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>        <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
<a id="__codelineno-0-2503" name="__codelineno-0-2503"></a>        <span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-2504" name="__codelineno-0-2504"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2505" name="__codelineno-0-2505"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="p">:]</span>
<a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>
<a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-2508" name="__codelineno-0-2508"></a>        <span class="p">{</span><span class="s2">&quot;prediction&quot;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s2">&quot;residuals&quot;</span><span class="p">:</span> <span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">}</span>
<a id="__codelineno-0-2509" name="__codelineno-0-2509"></a>    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>    <span class="n">residuals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-2512" name="__codelineno-0-2512"></a>
<a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">)[</span><span class="s2">&quot;residuals&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-2517" name="__codelineno-0-2517"></a>        <span class="p">)</span>
<a id="__codelineno-0-2518" name="__codelineno-0-2518"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>        <span class="n">residuals_by_bin</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-2520" name="__codelineno-0-2520"></a>
<a id="__codelineno-0-2521" name="__codelineno-0-2521"></a>    <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2522" name="__codelineno-0-2522"></a>        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-2525" name="__codelineno-0-2525"></a>    <span class="p">)</span>
<a id="__codelineno-0-2526" name="__codelineno-0-2526"></a>    <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2527" name="__codelineno-0-2527"></a>        <span class="p">{}</span>
<a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-2529" name="__codelineno-0-2529"></a>        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-2530" name="__codelineno-0-2530"></a>    <span class="p">)</span>
<a id="__codelineno-0-2531" name="__codelineno-0-2531"></a>    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
<a id="__codelineno-0-2532" name="__codelineno-0-2532"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">residuals</span><span class="p">])</span>
<a id="__codelineno-0-2533" name="__codelineno-0-2533"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2534" name="__codelineno-0-2534"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="p">:</span>
<a id="__codelineno-0-2535" name="__codelineno-0-2535"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
<a id="__codelineno-0-2536" name="__codelineno-0-2536"></a>                    <span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-2537" name="__codelineno-0-2537"></a>                <span class="p">)</span>
<a id="__codelineno-0-2538" name="__codelineno-0-2538"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2539" name="__codelineno-0-2539"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
<a id="__codelineno-0-2540" name="__codelineno-0-2540"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-2541" name="__codelineno-0-2541"></a>        <span class="n">out_sample_residuals</span> <span class="o">=</span> <span class="n">residuals</span>
<a id="__codelineno-0-2542" name="__codelineno-0-2542"></a>        <span class="n">out_sample_residuals_by_bin</span> <span class="o">=</span> <span class="n">residuals_by_bin</span>
<a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>
<a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-2545" name="__codelineno-0-2545"></a>        <span class="n">max_samples</span> <span class="o">=</span> <span class="mi">10_000</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner</span><span class="o">.</span><span class="n">n_bins</span>
<a id="__codelineno-0-2546" name="__codelineno-0-2546"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-2547" name="__codelineno-0-2547"></a>
<a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-2549" name="__codelineno-0-2549"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
<a id="__codelineno-0-2550" name="__codelineno-0-2550"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2551" name="__codelineno-0-2551"></a>                    <span class="n">v</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">max_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2552" name="__codelineno-0-2552"></a>                <span class="p">)</span>
<a id="__codelineno-0-2553" name="__codelineno-0-2553"></a>
<a id="__codelineno-0-2554" name="__codelineno-0-2554"></a>        <span class="n">bin_keys</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-2555" name="__codelineno-0-2555"></a>            <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-2556" name="__codelineno-0-2556"></a>        <span class="p">)</span>
<a id="__codelineno-0-2557" name="__codelineno-0-2557"></a>        <span class="n">empty_bins</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-2558" name="__codelineno-0-2558"></a>            <span class="n">k</span>
<a id="__codelineno-0-2559" name="__codelineno-0-2559"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bin_keys</span>
<a id="__codelineno-0-2560" name="__codelineno-0-2560"></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_sample_residuals_by_bin</span>
<a id="__codelineno-0-2561" name="__codelineno-0-2561"></a>            <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-2562" name="__codelineno-0-2562"></a>        <span class="p">]</span>
<a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>
<a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="k">if</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>                <span class="sa">f</span><span class="s2">&quot;The following bins have no out of sample residuals: </span><span class="si">{</span><span class="n">empty_bins</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2567" name="__codelineno-0-2567"></a>                <span class="sa">f</span><span class="s2">&quot;No predicted values fall in the interval &quot;</span>
<a id="__codelineno-0-2568" name="__codelineno-0-2568"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binner_intervals_</span><span class="p">[</span><span class="nb">bin</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">bin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">empty_bins</span><span class="p">]</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>                <span class="sa">f</span><span class="s2">&quot;Empty bins will be filled with a random sample of residuals.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-2570" name="__codelineno-0-2570"></a>                <span class="n">ResidualsUsageWarning</span><span class="p">,</span>
<a id="__codelineno-0-2571" name="__codelineno-0-2571"></a>            <span class="p">)</span>
<a id="__codelineno-0-2572" name="__codelineno-0-2572"></a>            <span class="n">empty_bin_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">out_sample_residuals</span><span class="p">))</span>
<a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">empty_bins</span><span class="p">:</span>
<a id="__codelineno-0-2574" name="__codelineno-0-2574"></a>                <span class="n">out_sample_residuals_by_bin</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
<a id="__codelineno-0-2575" name="__codelineno-0-2575"></a>                    <span class="n">a</span><span class="o">=</span><span class="n">out_sample_residuals</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">empty_bin_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-2576" name="__codelineno-0-2576"></a>                <span class="p">)</span>
<a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>
<a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="n">out_sample_residuals</span>
<a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_by_bin_</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.forecaster.recursive.ForecasterRecursive.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set the parameters of this forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of parameter names mapped to their new values.
If provided, these parameters are set first.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of parameter names mapped to their new values.
Parameters can be for the forecaster itself or for the contained estimator (using the <code>estimator__</code> prefix).</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code>&#39;ForecasterRecursive&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forecaster instance with updated parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">estimator__fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">get_params</span><span class="p">()[</span><span class="s2">&quot;fit_intercept&quot;</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">False</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/recursive/_forecaster_recursive.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">    Set the parameters of this forecaster.</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        params: Optional dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">            If provided, these parameters are set first.</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        **kwargs: Dictionary of parameter names mapped to their new values.</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">            Parameters can be for the forecaster itself or for the contained estimator (using the `estimator__` prefix).</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a><span class="sd">        self: The forecaster instance with updated parameters.</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=LinearRegression(), lags=3)</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        &gt;&gt;&gt; forecaster.set_params(estimator__fit_intercept=False)</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        &gt;&gt;&gt; forecaster.estimator.get_params()[&quot;fit_intercept&quot;]</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">        False</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>    <span class="c1"># Merge params dict and kwargs</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>    <span class="n">all_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>    <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>        <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>    <span class="n">all_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_params</span><span class="p">:</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>    <span class="n">valid_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>    <span class="n">nested_params</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">all_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_params</span> <span class="ow">and</span> <span class="s2">&quot;__&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>            <span class="c1"># Relaxed check for now</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>            <span class="k">pass</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>        <span class="k">if</span> <span class="s2">&quot;__&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>            <span class="n">obj_name</span><span class="p">,</span> <span class="n">param_name</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>            <span class="k">if</span> <span class="n">obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="p">:</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>                <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>            <span class="n">nested_params</span><span class="p">[</span><span class="n">obj_name</span><span class="p">][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>    <span class="k">for</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">obj_params</span> <span class="ow">in</span> <span class="n">nested_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">):</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;set_params&quot;</span><span class="p">):</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>                <span class="n">obj</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">obj_params</span><span class="p">)</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>                <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="forecasting-utilities">Forecasting Utilities</h2>
<h3 id="utils">utils</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.forecaster.utils" class="doc doc-heading">
            <code>spotforecast2_safe.forecaster.utils</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_exog" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`exog`&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate that exog is a pandas Series or DataFrame.</p>
<p>This function ensures that exogenous variables meet basic requirements:
- Must be a pandas Series or DataFrame
- If Series, must have a name
- Optionally warns if NaN values are present</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_nan</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, allows NaN values but issues a warning. If False,
raises no warning about NaN values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier of the series used in error messages. Defaults to "<code>exog</code>".</p>
              </div>
            </td>
            <td>
                  <code>&#39;`exog`&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If exog is not a pandas Series or DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If exog is a Series without a name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>MissingValuesWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If allow_nan=True and exog contains NaN values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_exog</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid DataFrame</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;temp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">60</span><span class="p">]})</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_exog</span><span class="p">(</span><span class="n">exog_df</span><span class="p">)</span>  <span class="c1"># No error</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid Series with name</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_exog</span><span class="p">(</span><span class="n">exog_series</span><span class="p">)</span>  <span class="c1"># No error</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: Series without name</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_no_name</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>    <span class="n">check_exog</span><span class="p">(</span><span class="n">exog_no_name</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">Error: When `exog` is a pandas Series, it must have a name.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: not a Series/DataFrame</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">... </span>    <span class="n">check_exog</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">Error: `exog` must be a pandas Series or DataFrame. Got &lt;class &#39;list&#39;&gt;.</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_exog</span><span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">allow_nan</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;`exog`&quot;</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Validate that exog is a pandas Series or DataFrame.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    This function ensures that exogenous variables meet basic requirements:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    - Must be a pandas Series or DataFrame</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    - If Series, must have a name</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    - Optionally warns if NaN values are present</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        exog: Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        allow_nan: If True, allows NaN values but issues a warning. If False,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            raises no warning about NaN values. Defaults to True.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        series_id: Identifier of the series used in error messages. Defaults to &quot;`exog`&quot;.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        TypeError: If exog is not a pandas Series or DataFrame.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ValueError: If exog is a Series without a name.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        MissingValuesWarning: If allow_nan=True and exog contains NaN values.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.validation import check_exog</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &gt;&gt;&gt; # Valid DataFrame</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        &gt;&gt;&gt; exog_df = pd.DataFrame({&quot;temp&quot;: [20, 21, 22], &quot;humidity&quot;: [50, 55, 60]})</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        &gt;&gt;&gt; check_exog(exog_df)  # No error</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        &gt;&gt;&gt; # Valid Series with name</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &gt;&gt;&gt; exog_series = pd.Series([1, 2, 3], name=&quot;temperature&quot;)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        &gt;&gt;&gt; check_exog(exog_series)  # No error</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        &gt;&gt;&gt; # Invalid: Series without name</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        &gt;&gt;&gt; exog_no_name = pd.Series([1, 2, 3])</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     check_exog(exog_no_name)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        ...     print(f&quot;Error: {e}&quot;)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Error: When `exog` is a pandas Series, it must have a name.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &gt;&gt;&gt; # Invalid: not a Series/DataFrame</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        ...     check_exog([1, 2, 3])</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        ... except TypeError as e:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        ...     print(f&quot;Error: {e}&quot;)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        Error: `exog` must be a pandas Series or DataFrame. Got &lt;class &#39;list&#39;&gt;.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> must be a pandas Series or DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="n">exog</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When </span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> is a pandas Series, it must have a name.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_nan</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> has missing values. Most machine learning models &quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="sa">f</span><span class="s2">&quot;do not allow missing values. Fitting the forecaster may fail.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">MissingValuesWarning</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_exog_dtypes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`exog`&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check that exogenous variables have valid data types (int, float, category).</p>
<p>This function validates that the exogenous variables (Series or DataFrame)
contain only supported data types: integer, float, or category. It issues a
warning if other types (like object/string) are found, as these may cause
issues with some machine learning estimators.</p>
<p>It also strictly enforces that categorical columns must have integer categories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>call_check_exog</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, calls check_exog() first to ensure basic validity.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier used in warning/error messages. Defaults to "<code>exog</code>".</p>
              </div>
            </td>
            <td>
                  <code>&#39;`exog`&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If categorical columns contain non-integer categories.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DataTypeWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If columns with unsupported data types (not int, float, category)
are found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_exog_dtypes</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid types (float, int)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_valid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">})</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">df_valid</span><span class="p">)</span>  <span class="c1"># No warning</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid type (object/string)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_invalid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span><span class="p">})</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">df_invalid</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span><span class="c1"># Issues DataTypeWarning about column &#39;b&#39;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid categorical (with integer categories)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_cat</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cat</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">df_cat</span><span class="p">)</span>  <span class="c1"># No warning</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_exog_dtypes</span><span class="p">(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">call_check_exog</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;`exog`&quot;</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Check that exogenous variables have valid data types (int, float, category).</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    This function validates that the exogenous variables (Series or DataFrame)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    contain only supported data types: integer, float, or category. It issues a</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    warning if other types (like object/string) are found, as these may cause</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    issues with some machine learning estimators.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    It also strictly enforces that categorical columns must have integer categories.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        exog: Exogenous variables to check.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        call_check_exog: If True, calls check_exog() first to ensure basic validity.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        series_id: Identifier used in warning/error messages. Defaults to &quot;`exog`&quot;.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        TypeError: If categorical columns contain non-integer categories.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        DataTypeWarning: If columns with unsupported data types (not int, float, category)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            are found.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.validation import check_exog_dtypes</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        &gt;&gt;&gt; # Valid types (float, int)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &gt;&gt;&gt; df_valid = pd.DataFrame({</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        ...     &quot;a&quot;: [1.0, 2.0, 3.0],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ...     &quot;b&quot;: [1, 2, 3]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        ... })</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        &gt;&gt;&gt; check_exog_dtypes(df_valid)  # No warning</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &gt;&gt;&gt; # Invalid type (object/string)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        &gt;&gt;&gt; df_invalid = pd.DataFrame({</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        ...     &quot;a&quot;: [1, 2, 3],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        ...     &quot;b&quot;: [&quot;x&quot;, &quot;y&quot;, &quot;z&quot;]</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        ... })</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        &gt;&gt;&gt; check_exog_dtypes(df_invalid)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        ... # Issues DataTypeWarning about column &#39;b&#39;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        &gt;&gt;&gt; # Valid categorical (with integer categories)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        &gt;&gt;&gt; df_cat = pd.DataFrame({&quot;a&quot;: [1, 2, 1]})</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; df_cat[&quot;a&quot;] = df_cat[&quot;a&quot;].astype(&quot;category&quot;)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &gt;&gt;&gt; check_exog_dtypes(df_cat)  # No warning</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="n">call_check_exog</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="n">series_id</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">valid_dtypes</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="s2">&quot;Int&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">,</span> <span class="s2">&quot;Float&quot;</span><span class="p">,</span> <span class="s2">&quot;uint&quot;</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">unique_dtypes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">has_invalid_dtype</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">unique_dtypes</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">):</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                    <span class="n">is_integer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="c1"># Pandas StringDtype and other non-numpy dtypes will raise TypeError</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                    <span class="n">is_integer</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_integer</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                        <span class="s2">&quot;Categorical dtypes in exog must contain only integer values. &quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                    <span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">dtype</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">valid_dtypes</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="n">has_invalid_dtype</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">if</span> <span class="n">has_invalid_dtype</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> may contain only `int`, `float` or `category` dtypes. &quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="sa">f</span><span class="s2">&quot;Most machine learning models do not allow other types of values. &quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="sa">f</span><span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="n">DataTypeWarning</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">dtype_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dtype_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">valid_dtypes</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dtype_name</span> <span class="o">==</span> <span class="s2">&quot;category&quot;</span><span class="p">):</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> may contain only `int`, `float` or `category` dtypes. Most &quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="sa">f</span><span class="s2">&quot;machine learning models do not allow other types of values. &quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="sa">f</span><span class="s2">&quot;Fitting the forecaster may fail.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="n">DataTypeWarning</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">CategoricalDtype</span><span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">exog</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                    <span class="s2">&quot;Categorical dtypes in exog must contain only integer values. &quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_extract_values_and_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_extract_values_and_index</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;`y`&#39;</span><span class="p">,</span> <span class="n">ignore_freq</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract values and index from a pandas Series or DataFrame, ensuring they are valid.</p>
<p>Validates that the input data has a proper DatetimeIndex or RangeIndex and extracts
its values and index for use in forecasting operations. Optionally checks for
index frequency consistency.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data (pandas Series or DataFrame) to extract values and index from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label used in exception messages for better error reporting.
Defaults to "<code>y</code>".</p>
              </div>
            </td>
            <td>
                  <code>&#39;`y`&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_freq</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the frequency of the index is not checked.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_values</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the values of the data are returned.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>], <span title="pandas.Index">Index</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- values (numpy.ndarray or None): Values of the data as numpy array,
  or None if return_values is False.
- index (pandas.Index): Index of the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If data is not a pandas Series or DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If data index is not a DatetimeIndex or RangeIndex.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>UserWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If DatetimeIndex has no frequency (inferred automatically).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">values</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">(10,)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">&lt;class &#39;pandas.core.indexes.datetimes.DatetimeIndex&#39;&gt;</span>
</code></pre></div>
    <p>Extract index only:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">2020-01-01 00:00:00</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="n">data_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;`y`&quot;</span><span class="p">,</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="n">ignore_freq</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="n">return_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract values and index from a pandas Series or DataFrame, ensuring they are valid.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="sd">    Validates that the input data has a proper DatetimeIndex or RangeIndex and extracts</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="sd">    its values and index for use in forecasting operations. Optionally checks for</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">    index frequency consistency.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        data: Input data (pandas Series or DataFrame) to extract values and index from.</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">        data_label: Label used in exception messages for better error reporting.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">            Defaults to &quot;`y`&quot;.</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">        ignore_freq: If True, the frequency of the index is not checked.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        return_values: If True, the values of the data are returned.</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        tuple: A tuple containing:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">            - values (numpy.ndarray or None): Values of the data as numpy array,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">              or None if return_values is False.</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">            - index (pandas.Index): Index of the data.</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">        TypeError: If data is not a pandas Series or DataFrame.</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">        TypeError: If data index is not a DatetimeIndex or RangeIndex.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">        UserWarning: If DatetimeIndex has no frequency (inferred automatically).</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">        &gt;&gt;&gt; dates = pd.date_range(&#39;2020-01-01&#39;, periods=10, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">        &gt;&gt;&gt; series = pd.Series(np.arange(10), index=dates)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">        &gt;&gt;&gt; values, index = check_extract_values_and_index(series)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        &gt;&gt;&gt; print(values.shape)</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">        (10,)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        &gt;&gt;&gt; print(type(index))</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        &lt;class &#39;pandas.core.indexes.datetimes.DatetimeIndex&#39;&gt;</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">        Extract index only:</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        &gt;&gt;&gt; _, index = check_extract_values_and_index(series, return_values=False)</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        &gt;&gt;&gt; print(index[0])</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        2020-01-01 00:00:00</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_label</span><span class="si">}</span><span class="s2"> must be a pandas Series or DataFrame.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">)):</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_label</span><span class="si">}</span><span class="s2"> must have a pandas DatetimeIndex or RangeIndex.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ignore_freq</span><span class="p">:</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_label</span><span class="si">}</span><span class="s2"> has a DatetimeIndex but no frequency. &quot;</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>                <span class="s2">&quot;The frequency has been inferred from the index.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>                <span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>            <span class="p">)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>    <span class="n">values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">if</span> <span class="n">return_values</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="k">return</span> <span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quantiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha_literal</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate that a confidence interval specification is valid.</p>
<p>This function checks that interval values are properly formatted and within
valid ranges for confidence interval prediction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="float">float</span>], <span title="typing.Tuple">Tuple</span>[<span title="float">float</span>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence interval percentiles (0-100 inclusive).
Should be [lower_bound, upper_bound]. Example: [2.5, 97.5] for 95% interval.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ensure_symmetric_intervals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, ensure intervals are symmetric
(lower + upper = 100).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quantiles</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="float">float</span>], <span title="typing.Tuple">Tuple</span>[<span title="float">float</span>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of quantiles (0-1 inclusive). Currently not validated,
reserved for future use.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level (1-alpha). Currently not validated, reserved for future use.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha_literal</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name used in error messages for alpha parameter.</p>
              </div>
            </td>
            <td>
                  <code>&#39;alpha&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If interval is not a list or tuple.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If interval doesn't have exactly 2 values, values out of range (0-100),
lower &gt;= upper, or intervals not symmetric when required.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_interval</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid 95% confidence interval</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>  <span class="c1"># No error</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid symmetric interval</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">],</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># No error</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: not symmetric</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">ensure_symmetric_intervals</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Interval not symmetric&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Error: Interval not symmetric</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: wrong number of values</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Must have exactly 2 values&quot;</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">Error: Must have exactly 2 values</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: out of range</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">... </span>    <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">105</span><span class="p">])</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Values out of range&quot;</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">Error: Values out of range</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_interval</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">interval</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">ensure_symmetric_intervals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="n">quantiles</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">alpha_literal</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;alpha&quot;</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Validate that a confidence interval specification is valid.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    This function checks that interval values are properly formatted and within</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    valid ranges for confidence interval prediction.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        interval: Confidence interval percentiles (0-100 inclusive).</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            Should be [lower_bound, upper_bound]. Example: [2.5, 97.5] for 95% interval.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        ensure_symmetric_intervals: If True, ensure intervals are symmetric</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            (lower + upper = 100).</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        quantiles: Sequence of quantiles (0-1 inclusive). Currently not validated,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            reserved for future use.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        alpha: Confidence level (1-alpha). Currently not validated, reserved for future use.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        alpha_literal: Name used in error messages for alpha parameter.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        TypeError: If interval is not a list or tuple.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        ValueError: If interval doesn&#39;t have exactly 2 values, values out of range (0-100),</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            lower &gt;= upper, or intervals not symmetric when required.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.validation import check_interval</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &gt;&gt;&gt; # Valid 95% confidence interval</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        &gt;&gt;&gt; check_interval(interval=[2.5, 97.5])  # No error</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        &gt;&gt;&gt; # Valid symmetric interval</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        &gt;&gt;&gt; check_interval(interval=[2.5, 97.5], ensure_symmetric_intervals=True)  # No error</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        &gt;&gt;&gt; # Invalid: not symmetric</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        ...     check_interval(interval=[5, 90], ensure_symmetric_intervals=True)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        ...     print(&quot;Error: Interval not symmetric&quot;)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Error: Interval not symmetric</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        &gt;&gt;&gt; # Invalid: wrong number of values</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        ...     check_interval(interval=[2.5, 50, 97.5])</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        ...     print(&quot;Error: Must have exactly 2 values&quot;)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        Error: Must have exactly 2 values</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        &gt;&gt;&gt; # Invalid: out of range</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        ...     check_interval(interval=[-5, 105])</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        ...     print(&quot;Error: Values out of range&quot;)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        Error: Values out of range</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="s2">&quot;`interval` must be a `list` or `tuple`. For example, interval of 95% &quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="s2">&quot;`interval` must contain exactly 2 values, respectively the &quot;</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="s2">&quot;lower and upper interval bounds. For example, interval of 95% &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="s2">&quot;should be as `interval = [2.5, 97.5]`.&quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">100.0</span><span class="p">):</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt;= 0 and &lt; 100.&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">100.0</span><span class="p">):</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="sa">f</span><span class="s2">&quot;Upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be &gt; 0 and &lt;= 100.&quot;</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">if</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="sa">f</span><span class="s2">&quot;Lower interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">) must be less than the &quot;</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="sa">f</span><span class="s2">&quot;upper interval bound (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">if</span> <span class="n">ensure_symmetric_intervals</span> <span class="ow">and</span> <span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">100</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="sa">f</span><span class="s2">&quot;Interval must be symmetric, the sum of the lower, (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">), &quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="sa">f</span><span class="s2">&quot;and upper, (</span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">), interval bounds must be equal to &quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="sa">f</span><span class="s2">&quot;100. Got </span><span class="si">{</span><span class="n">interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_predict_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_predict_input</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">is_fitted</span><span class="p">,</span> <span class="n">exog_in_</span><span class="p">,</span> <span class="n">index_type_</span><span class="p">,</span> <span class="n">index_freq_</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">last_window</span><span class="p">,</span> <span class="n">last_window_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog_names_in_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels_forecaster</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series_names_in_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check all inputs of predict method. This is a helper function to validate
that inputs used in predict method match attributes of a forecaster already
trained.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str
Forecaster name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="typing.List">List</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int, list
Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_fitted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool
Tag to identify if the estimator has been fitted (trained).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog_in_</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool
If the forecaster has been trained using exogenous variable/s.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_type_</code>
            </td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type
Type of index of the input used in training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index_freq_</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str
Frequency of Index of the input used in training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int
Size of the window needed to create the predictors. It is equal to
<code>max_lag</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas Series, pandas DataFrame, None
Values of the series used to create the predictors (lags) need in the
first iteration of prediction (t + 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>last_window_exog</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas Series, pandas DataFrame, default None
Values of the exogenous variables aligned with <code>last_window</code> in
ForecasterStats predictions.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas Series, pandas DataFrame, dict, default None
Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog_names_in_</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list, default None
Names of the exogenous variables used during training.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list, tuple, default None
Confidence of the prediction interval estimated. Sequence of percentiles
to compute, which must be between 0 and 100 inclusive. For example,
interval of 95% should be as <code>interval = [2.5, 97.5]</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>float, default None
The confidence intervals used in ForecasterStats are (1 - alpha) %.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_step</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int, default None
Maximum number of steps allowed (<code>ForecasterDirect</code> and
<code>ForecasterDirectMultiVariate</code>).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, list, default None
Time series to be predicted (<code>ForecasterRecursiveMultiSeries</code>
and `ForecasterRnn).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels_forecaster</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, list, default None
Time series used as output data of a multiseries problem in a RNN problem
(<code>ForecasterRnn</code>).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_names_in_</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list, default None
Names of the columns used during fit (<code>ForecasterRecursiveMultiSeries</code>,
<code>ForecasterDirectMultiVariate</code> and <code>ForecasterRnn</code>).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, default None
Encoding used to identify the different series (<code>ForecasterRecursiveMultiSeries</code>).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_predict_input</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="n">steps</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">is_fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">exog_in_</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="n">index_type_</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="n">index_freq_</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">last_window_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]]]</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">exog_names_in_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="n">interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">max_step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">levels_forecaster</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">series_names_in_</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Check all inputs of predict method. This is a helper function to validate</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    that inputs used in predict method match attributes of a forecaster already</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    trained.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        forecaster_name: str</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">            Forecaster name.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        steps: int, list</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            Number of future steps predicted.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        is_fitted: bool</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            Tag to identify if the estimator has been fitted (trained).</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        exog_in_: bool</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            If the forecaster has been trained using exogenous variable/s.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        index_type_: type</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">            Type of index of the input used in training.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        index_freq_: str</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            Frequency of Index of the input used in training.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        window_size: int</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            Size of the window needed to create the predictors. It is equal to</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            `max_lag`.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        last_window: pandas Series, pandas DataFrame, None</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            Values of the series used to create the predictors (lags) need in the</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            first iteration of prediction (t + 1).</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        last_window_exog: pandas Series, pandas DataFrame, default None</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">            Values of the exogenous variables aligned with `last_window` in</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            ForecasterStats predictions.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        exog: pandas Series, pandas DataFrame, dict, default None</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            Exogenous variable/s included as predictor/s.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        exog_names_in_: list, default None</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            Names of the exogenous variables used during training.</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        interval: list, tuple, default None</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            Confidence of the prediction interval estimated. Sequence of percentiles</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            to compute, which must be between 0 and 100 inclusive. For example,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">        alpha: float, default None</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            The confidence intervals used in ForecasterStats are (1 - alpha) %.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        max_step: int, default None</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            Maximum number of steps allowed (`ForecasterDirect` and</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">            `ForecasterDirectMultiVariate`).</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        levels: str, list, default None</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            Time series to be predicted (`ForecasterRecursiveMultiSeries`</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            and `ForecasterRnn).</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        levels_forecaster: str, list, default None</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">            Time series used as output data of a multiseries problem in a RNN problem</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            (`ForecasterRnn`).</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        series_names_in_: list, default None</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            Names of the columns used during fit (`ForecasterRecursiveMultiSeries`,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            `ForecasterDirectMultiVariate` and `ForecasterRnn`).</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        encoding: str, default None</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            Encoding used to identify the different series (`ForecasterRecursiveMultiSeries`).</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        None</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="s2">&quot;arguments before using `predict`.&quot;</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">min</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="sa">f</span><span class="s2">&quot;`steps` must be a list of integers greater than or equal to 1. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">if</span> <span class="n">max_step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="n">max_step</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                    <span class="sa">f</span><span class="s2">&quot;The maximum step that can be predicted is </span><span class="si">{</span><span class="n">max_step</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>                <span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_step</span><span class="p">:</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                    <span class="sa">f</span><span class="s2">&quot;The maximum step that can be predicted is </span><span class="si">{</span><span class="n">max_step</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>                <span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="k">if</span> <span class="n">exog_in_</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="s2">&quot;Forecaster trained with exogenous variable/s. &quot;</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="s2">&quot;Same variable/s must be provided when predicting.&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">exog_in_</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="s2">&quot;Forecaster trained without exogenous variable/s. &quot;</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="s2">&quot;`exog` must be `None` when predicting.&quot;</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="p">)</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="c1"># If exog is a dictionary, it is assumed that it contains the exogenous</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="c1"># variables for each series.</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="c1"># Check that all series have the exogenous variables</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">series_names_in_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="n">levels</span> <span class="o">=</span> <span class="n">series_names_in_</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">]</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exog</span><span class="p">:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                            <span class="sa">f</span><span class="s2">&quot;Exogenous variables for series &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39; are missing.&quot;</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                        <span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                    <span class="n">check_exog</span><span class="p">(</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                        <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                        <span class="n">series_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;`exog` for series &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                    <span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>                    <span class="n">check_exog_dtypes</span><span class="p">(</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                        <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                        <span class="n">series_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;`exog` for series &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                    <span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>                    <span class="c1"># Check that exogenous variables are the same as used in training</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>                    <span class="c1"># Get the name of columns</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">[</span><span class="n">level</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                        <span class="n">exog_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">exog</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>                        <span class="n">exog_names</span> <span class="o">=</span> <span class="n">exog</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                    <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_names</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                    <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                            <span class="sa">f</span><span class="s2">&quot;Missing columns for series &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39; in `exog`. &quot;</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                            <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2">. Got </span><span class="si">{</span><span class="n">exog_names</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                        <span class="p">)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="n">check_exog</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">allow_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="c1"># Check that exogenous variables are the same as used in training</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="c1"># Get the name of columns</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                <span class="n">exog_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="n">exog_names</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="n">col_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_names</span><span class="p">)</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="k">if</span> <span class="n">col_missing</span><span class="p">:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                    <span class="sa">f</span><span class="s2">&quot;Missing columns in `exog`. Expected </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">exog_names</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                <span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="c1"># Check last_window</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">if</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="k">if</span> <span class="n">last_window</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`last_window` has missing values.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="n">check_y</span><span class="p">(</span><span class="n">last_window</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s2">&quot;`last_window`&quot;</span><span class="p">)</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_preprocess_series" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">series</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check and preprocess <code>series</code> argument in <code>ForecasterRecursiveMultiSeries</code> class.</p>
<div class="highlight"><pre><span></span><code>- If `series` is a wide-format pandas DataFrame, each column represents a
different time series, and the index must be either a `DatetimeIndex` or
a `RangeIndex` with frequency or step size, as appropriate
- If `series` is a long-format pandas DataFrame with a MultiIndex, the
first level of the index must contain the series IDs, and the second
level must be a `DatetimeIndex` with the same frequency across all series.
- If series is a dictionary, each key must be a series ID, and each value
must be a named pandas Series. All series must have the same index, which
must be either a `DatetimeIndex` or a `RangeIndex`, and they must share the
same frequency or step size, as appropriate.
</code></pre></div>
<p>When <code>series</code> is a pandas DataFrame, it is converted to a dictionary of pandas
Series, where the keys are the series IDs and the values are the Series with
the same index as the original DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas DataFrame or dictionary of pandas Series/DataFrames</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Index">Index</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[dict[str, pd.Series], dict[str, pd.Index]]:
- series_dict: Dictionary where keys are series IDs and values are pandas Series.
- series_indexes: Dictionary where keys are series IDs and values are the index of each series.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises:
    TypeError:
        If <code>series</code> is not a pandas DataFrame or a dictionary of pandas Series/DataFrames.
    TypeError:
        If the index of <code>series</code> is not a DatetimeIndex or RangeIndex with frequency/step size.
    ValueError:
        If the series in <code>series</code> have different frequencies or step sizes.
    ValueError:
        If all values of any series are NaN.
    UserWarning:
        If <code>series</code> is a wide-format DataFrame, only the first column will be used as series values.
    UserWarning:
        If <code>series</code> is a DataFrame (either wide or long format), additional internal transformations are required, which can increase computational time.
        It is recommended to use a dictionary of pandas Series instead.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_preprocess_series</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with wide-format DataFrame</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="s1">&#39;series_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="s1">&#39;series_2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span> <span class="o">=</span> <span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">df_wide</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">UserWarning: `series` DataFrame has multiple columns. Only the values of first column, &#39;series_1&#39;, will be used as series values. All other columns will be ignored.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">UserWarning: Passing a DataFrame (either wide or long format) as `series` requires additional internal transformations, which can increase computational time.</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">It is recommended to use a dictionary of pandas Series instead.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_dict</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">2020-01-01    1</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">2020-01-02    2</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">2020-01-03    3</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">2020-01-04    4</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">2020-01-05    5</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">Name: series_1, dtype: int64</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">               &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with long-format DataFrame</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">... </span>    <span class="s1">&#39;series_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;series_2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">... </span>    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="gp">... </span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;series_1&#39;</span><span class="p">,</span> <span class="s1">&#39;series_2&#39;</span><span class="p">],</span> <span class="n">dates</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;series_id&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">]))</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span> <span class="o">=</span> <span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">df_long</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">UserWarning: `series` DataFrame has multiple columns. Only the values of first column, &#39;value&#39;, will be used as series values. All other columns will be ignored.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">UserWarning: Passing a DataFrame (either wide or long format) as `series` requires additional internal transformations, which can increase computational time.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">It is recommended to use a dictionary of pandas Series instead.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_dict</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">2020-01-01    1</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">2020-01-02    2</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">2020-01-03    3</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="go">2020-01-04    4</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">2020-01-05    5</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="go">Name: series_1, dtype: int64</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="go">DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">                  &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="go">                 dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with dictionary of Series</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series_dict_input</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="s1">&#39;series_1&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="s1">&#39;series_2&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">),</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span> <span class="o">=</span> <span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">series_dict_input</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_dict</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">2020-01-01    1</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">2020-01-02    2</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">2020-01-03    3</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">2020-01-04    4</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">2020-01-05    5</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">Name: series_1, dtype: int64</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">               &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">    &gt;&gt;&gt; # Example with dictionary of DataFrames</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">    &gt;&gt;&gt; df_series_1 = pd.DataFrame({&#39;value&#39;: [1, 2, 3, 4, 5]}, index=dates)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">    &gt;&gt;&gt; df_series_2 = pd.DataFrame({&#39;value&#39;: [5, 4, 3, 2, 1]}, index=dates)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">    &gt;&gt;&gt; series_dict_input = {</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">    ...     &#39;series_1&#39;: df_series_1,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">    ...     &#39;series_2&#39;: df_series_2,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">    ... }</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">    &gt;&gt;&gt; series_dict, series_indexes = check_preprocess_series(series_dict_input)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">    &gt;&gt;&gt; print(series_dict[&#39;series_1&#39;])</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">2020-01-01    1</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">2020-01-02    2</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">2020-01-03    3</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">2020-01-04    4</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">2020-01-05    5</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">Name: series_1, dtype: int64</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="s1">&#39;series_1&#39;</span><span class="p">])</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">               &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_preprocess_series</span><span class="p">(</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]]:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Check and preprocess `series` argument in `ForecasterRecursiveMultiSeries` class.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        - If `series` is a wide-format pandas DataFrame, each column represents a</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        different time series, and the index must be either a `DatetimeIndex` or</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        a `RangeIndex` with frequency or step size, as appropriate</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        - If `series` is a long-format pandas DataFrame with a MultiIndex, the</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        first level of the index must contain the series IDs, and the second</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        level must be a `DatetimeIndex` with the same frequency across all series.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        - If series is a dictionary, each key must be a series ID, and each value</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        must be a named pandas Series. All series must have the same index, which</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        must be either a `DatetimeIndex` or a `RangeIndex`, and they must share the</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        same frequency or step size, as appropriate.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    When `series` is a pandas DataFrame, it is converted to a dictionary of pandas</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Series, where the keys are the series IDs and the values are the Series with</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    the same index as the original DataFrame.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        series: pandas DataFrame or dictionary of pandas Series/DataFrames</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        tuple[dict[str, pd.Series], dict[str, pd.Index]]:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            - series_dict: Dictionary where keys are series IDs and values are pandas Series.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            - series_indexes: Dictionary where keys are series IDs and values are the index of each series.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        TypeError:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            If `series` is not a pandas DataFrame or a dictionary of pandas Series/DataFrames.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        TypeError:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            If the index of `series` is not a DatetimeIndex or RangeIndex with frequency/step size.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            If the series in `series` have different frequencies or step sizes.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        ValueError:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            If all values of any series are NaN.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        UserWarning:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            If `series` is a wide-format DataFrame, only the first column will be used as series values.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        UserWarning:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            If `series` is a DataFrame (either wide or long format), additional internal transformations are required, which can increase computational time.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            It is recommended to use a dictionary of pandas Series instead.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.utils import check_preprocess_series</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; # Example with wide-format DataFrame</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        &gt;&gt;&gt; dates = pd.date_range(&#39;2020-01-01&#39;, periods=5, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; df_wide = pd.DataFrame({</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        ...     &#39;series_1&#39;: [1, 2, 3, 4, 5],</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        ...     &#39;series_2&#39;: [5, 4, 3, 2, 1],</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ... }, index=dates)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &gt;&gt;&gt; series_dict, series_indexes = check_preprocess_series(df_wide)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        UserWarning: `series` DataFrame has multiple columns. Only the values of first column, &#39;series_1&#39;, will be used as series values. All other columns will be ignored.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        UserWarning: Passing a DataFrame (either wide or long format) as `series` requires additional internal transformations, which can increase computational time.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        It is recommended to use a dictionary of pandas Series instead.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        &gt;&gt;&gt; print(series_dict[&#39;series_1&#39;])</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        2020-01-01    1</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        2020-01-02    2</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        2020-01-03    3</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        2020-01-04    4</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        2020-01-05    5</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Name: series_1, dtype: int64</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &gt;&gt;&gt; print(series_indexes[&#39;series_1&#39;])</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">                       &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">                      dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        &gt;&gt;&gt; # Example with long-format DataFrame</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        &gt;&gt;&gt; df_long = pd.DataFrame({</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        ...     &#39;series_id&#39;: [&#39;series_1&#39;] * 5 + [&#39;series_2&#39;] * 5,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        ...     &#39;value&#39;: [1, 2, 3, 4, 5, 5, 4, 3, 2, 1],</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        ... }, index=pd.MultiIndex.from_product([[&#39;series_1&#39;, &#39;series_2&#39;], dates], names=[&#39;series_id&#39;, &#39;date&#39;]))</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        &gt;&gt;&gt; series_dict, series_indexes = check_preprocess_series(df_long)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        UserWarning: `series` DataFrame has multiple columns. Only the values of first column, &#39;value&#39;, will be used as series values. All other columns will be ignored.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        UserWarning: Passing a DataFrame (either wide or long format) as `series` requires additional internal transformations, which can increase computational time.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        It is recommended to use a dictionary of pandas Series instead.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        &gt;&gt;&gt; print(series_dict[&#39;series_1&#39;])</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        2020-01-01    1</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        2020-01-02    2</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        2020-01-03    3</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        2020-01-04    4</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        2020-01-05    5</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        Name: series_1, dtype: int64</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; print(series_indexes[&#39;series_1&#39;])</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                          &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">                         dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        &gt;&gt;&gt; # Example with dictionary of Series</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; series_dict_input = {</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ...     &#39;series_1&#39;: pd.Series([1, 2, 3, 4, 5], index=dates),</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        ...     &#39;series_2&#39;: pd.Series([5, 4, 3, 2, 1], index=dates),</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        ... }</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; series_dict, series_indexes = check_preprocess_series(series_dict_input)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; print(series_dict[&#39;series_1&#39;])</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        2020-01-01    1</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        2020-01-02    2</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        2020-01-03    3</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        2020-01-04    4</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        2020-01-05    5</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Name: series_1, dtype: int64</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        &gt;&gt;&gt; print(series_indexes[&#39;series_1&#39;])</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                       &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                      dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            &gt;&gt;&gt; # Example with dictionary of DataFrames</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            &gt;&gt;&gt; df_series_1 = pd.DataFrame({&#39;value&#39;: [1, 2, 3, 4, 5]}, index=dates)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            &gt;&gt;&gt; df_series_2 = pd.DataFrame({&#39;value&#39;: [5, 4, 3, 2, 1]}, index=dates)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            &gt;&gt;&gt; series_dict_input = {</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            ...     &#39;series_1&#39;: df_series_1,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            ...     &#39;series_2&#39;: df_series_2,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            ... }</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            &gt;&gt;&gt; series_dict, series_indexes = check_preprocess_series(series_dict_input)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            &gt;&gt;&gt; print(series_dict[&#39;series_1&#39;])</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        2020-01-01    1</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        2020-01-02    2</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        2020-01-03    3</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        2020-01-04    4</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        2020-01-05    5</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Name: series_1, dtype: int64</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        &gt;&gt;&gt; print(series_indexes[&#39;series_1&#39;])</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        DatetimeIndex([&#39;2020-01-01&#39;, &#39;2020-01-02&#39;, &#39;2020-01-03&#39;, &#39;2020-01-04&#39;,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">                       &#39;2020-01-05&#39;],</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">                      dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame or a dict of DataFrames or Series. &quot;</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="p">):</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">check_extract_values_and_index</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="n">data</span><span class="o">=</span><span class="n">series</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;`series`&quot;</span><span class="p">,</span> <span class="n">return_values</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">series_dict</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;series&quot;</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                    <span class="sa">f</span><span class="s2">&quot;The second level of the MultiIndex in `series` must be a &quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                    <span class="sa">f</span><span class="s2">&quot;pandas DatetimeIndex with the same frequency for each series. &quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                    <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">first_col</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                    <span class="sa">f</span><span class="s2">&quot;`series` DataFrame has multiple columns. Only the values of &quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                    <span class="sa">f</span><span class="s2">&quot;first column, &#39;</span><span class="si">{</span><span class="n">first_col</span><span class="si">}</span><span class="s2">&#39;, will be used as series values. &quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                    <span class="sa">f</span><span class="s2">&quot;All other columns will be ignored.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                    <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">series</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">series</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">set_names</span><span class="p">([</span><span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">series_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="n">series_id</span><span class="p">:</span> <span class="n">series</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">series_id</span><span class="p">][</span><span class="n">first_col</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">series_id</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="k">for</span> <span class="n">series_id</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="p">}</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="s2">&quot;Passing a DataFrame (either wide or long format) as `series` requires &quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="s2">&quot;additional internal transformations, which can increase computational &quot;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="s2">&quot;time. It is recommended to use a dictionary of pandas Series instead. &quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="n">InputTypeWarning</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">not_valid_series</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">))</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="p">]</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">if</span> <span class="n">not_valid_series</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_series</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">series_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">series_indexes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                    <span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must be a named &quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                    <span class="sa">f</span><span class="s2">&quot;pandas Series or a pandas DataFrame with a single column. &quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                    <span class="sa">f</span><span class="s2">&quot;Review series: &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">k</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="n">not_valid_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All values of series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39; are NaN.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">series_indexes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="p">)</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">indexes_freq</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="s2">&quot;If it a MultiIndex DataFrame, the second level must be a DatetimeIndex &quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="s2">&quot;with the same frequency for each series. Found series with no &quot;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="s2">&quot;frequency or step.&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="sa">f</span><span class="s2">&quot;If `series` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="sa">f</span><span class="s2">&quot;If it a MultiIndex DataFrame, the second level must be a DatetimeIndex &quot;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="sa">f</span><span class="s2">&quot;with the same frequency for each series. &quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="k">return</span> <span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_residuals_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_residuals_input</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span> <span class="n">in_sample_residuals_</span><span class="p">,</span> <span class="n">out_sample_residuals_</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="p">,</span> <span class="n">in_sample_residuals_by_bin_</span><span class="p">,</span> <span class="n">out_sample_residuals_by_bin_</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check residuals input arguments in Forecasters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str
Forecaster name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool
Indicates if in sample or out sample residuals are used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_sample_residuals_</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="numpy.ndarray">ndarray</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy ndarray, dict
Residuals of the model when predicting training data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_sample_residuals_</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="numpy.ndarray">ndarray</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy ndarray, dict
Residuals of the model when predicting non training data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool
Indicates if residuals are binned.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>in_sample_residuals_by_bin_</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span> | <span title="int">int</span>, <span title="numpy.ndarray">ndarray</span> | <span title="dict">dict</span>[<span title="int">int</span>, <span title="numpy.ndarray">ndarray</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict
In sample residuals binned according to the predicted value each residual
is associated with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_sample_residuals_by_bin_</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span> | <span title="int">int</span>, <span title="numpy.ndarray">ndarray</span> | <span title="dict">dict</span>[<span title="int">int</span>, <span title="numpy.ndarray">ndarray</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict
Out of sample residuals binned according to the predicted value each residual
is associated with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>levels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list, default None
Names of the series (levels) to be predicted (Forecasters multiseries).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, default None
Encoding used to identify the different series (ForecasterRecursiveMultiSeries).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotforecast2_safe.forecaster.utils import check_residuals_input
import numpy as np
forecaster_name = "ForecasterRecursiveMultiSeries"
use_in_sample_residuals = True
in_sample_residuals_ = np.array([0.1, -0.2
out_sample_residuals_ = np.array([0.3, -0.1])
use_binned_residuals = False
check_residuals_input(
    forecaster_name,
    use_in_sample_residuals,
    in_sample_residuals_,
    out_sample_residuals_,
    use_binned_residuals,
    in_sample_residuals_by_bin_=None,
    out_sample_residuals_by_bin_=None,
    levels=['series_1', 'series_2'],
    encoding='onehot'
)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_residuals_input</span><span class="p">(</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>    <span class="n">in_sample_residuals_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>    <span class="n">out_sample_residuals_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>    <span class="n">in_sample_residuals_by_bin_</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>        <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>    <span class="p">),</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>    <span class="n">out_sample_residuals_by_bin_</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>    <span class="p">),</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="n">levels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">    Check residuals input arguments in Forecasters.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        forecaster_name: str</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">            Forecaster name.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        use_in_sample_residuals: bool</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            Indicates if in sample or out sample residuals are used.</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        in_sample_residuals_: numpy ndarray, dict</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">            Residuals of the model when predicting training data.</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">        out_sample_residuals_: numpy ndarray, dict</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">            Residuals of the model when predicting non training data.</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        use_binned_residuals: bool</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            Indicates if residuals are binned.</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        in_sample_residuals_by_bin_: dict</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">            In sample residuals binned according to the predicted value each residual</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">            is associated with.</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        out_sample_residuals_by_bin_: dict</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">            Out of sample residuals binned according to the predicted value each residual</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">            is associated with.</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        levels: list, default None</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">            Names of the series (levels) to be predicted (Forecasters multiseries).</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">        encoding: str, default None</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">            Encoding used to identify the different series (ForecasterRecursiveMultiSeries).</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a><span class="sd">        None</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a><span class="sd">        from spotforecast2_safe.forecaster.utils import check_residuals_input</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="sd">        import numpy as np</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">        forecaster_name = &quot;ForecasterRecursiveMultiSeries&quot;</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        use_in_sample_residuals = True</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        in_sample_residuals_ = np.array([0.1, -0.2</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        out_sample_residuals_ = np.array([0.3, -0.1])</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">        use_binned_residuals = False</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        check_residuals_input(</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">            forecaster_name,</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            use_in_sample_residuals,</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="sd">            in_sample_residuals_,</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">            out_sample_residuals_,</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            use_binned_residuals,</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">            in_sample_residuals_by_bin_=None,</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">            out_sample_residuals_by_bin_=None,</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">            levels=[&#39;series_1&#39;, &#39;series_2&#39;],</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a><span class="sd">            encoding=&#39;onehot&#39;</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a><span class="sd">        )</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>    <span class="n">forecasters_multiseries</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>    <span class="p">)</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>    <span class="k">if</span> <span class="n">use_in_sample_residuals</span><span class="p">:</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="n">in_sample_residuals_by_bin_</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="n">literal</span> <span class="o">=</span> <span class="s2">&quot;in_sample_residuals_by_bin_&quot;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="n">in_sample_residuals_</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>            <span class="n">literal</span> <span class="o">=</span> <span class="s2">&quot;in_sample_residuals_&quot;</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="c1"># Check if residuals are empty or None</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="n">is_empty</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>            <span class="n">residuals</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">residuals</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="p">)</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="k">if</span> <span class="n">is_empty</span><span class="p">:</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>                <span class="sa">f</span><span class="s2">&quot;`forecaster.</span><span class="si">{</span><span class="n">literal</span><span class="si">}</span><span class="s2">` is either None or empty. Use &quot;</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>                <span class="sa">f</span><span class="s2">&quot;`store_in_sample_residuals = True` when fitting the forecaster &quot;</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>                <span class="sa">f</span><span class="s2">&quot;or use the `set_in_sample_residuals()` method before predicting.&quot;</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="p">)</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multiseries</span><span class="p">:</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>            <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>                <span class="n">unknown_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>                <span class="k">if</span> <span class="n">unknown_levels</span><span class="p">:</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>                        <span class="sa">f</span><span class="s2">&quot;`levels` </span><span class="si">{</span><span class="n">unknown_levels</span><span class="si">}</span><span class="s2"> are not present in `forecaster.</span><span class="si">{</span><span class="n">literal</span><span class="si">}</span><span class="s2">`, &quot;</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>                        <span class="sa">f</span><span class="s2">&quot;most likely because they were not present in the training data. &quot;</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>                        <span class="sa">f</span><span class="s2">&quot;A random sample of the residuals from other levels will be used. &quot;</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>                        <span class="sa">f</span><span class="s2">&quot;This can lead to inaccurate intervals for the unknown levels.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>                        <span class="n">UnknownLevelWarning</span><span class="p">,</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>                    <span class="p">)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>        <span class="k">if</span> <span class="n">use_binned_residuals</span><span class="p">:</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="n">out_sample_residuals_by_bin_</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>            <span class="n">literal</span> <span class="o">=</span> <span class="s2">&quot;out_sample_residuals_by_bin_&quot;</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="n">out_sample_residuals_</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">literal</span> <span class="o">=</span> <span class="s2">&quot;out_sample_residuals_&quot;</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="n">is_empty</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="n">residuals</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">residuals</span><span class="p">)</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>            <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">residuals</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>        <span class="p">)</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>        <span class="k">if</span> <span class="n">is_empty</span><span class="p">:</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                <span class="sa">f</span><span class="s2">&quot;`forecaster.</span><span class="si">{</span><span class="n">literal</span><span class="si">}</span><span class="s2">` is either None or empty. Use &quot;</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                <span class="sa">f</span><span class="s2">&quot;`set_out_sample_residuals()` method before predicting.&quot;</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>            <span class="p">)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multiseries</span><span class="p">:</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>            <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>                <span class="n">unknown_levels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>                <span class="k">if</span> <span class="n">unknown_levels</span><span class="p">:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>                        <span class="sa">f</span><span class="s2">&quot;`levels` </span><span class="si">{</span><span class="n">unknown_levels</span><span class="si">}</span><span class="s2"> are not present in `forecaster.</span><span class="si">{</span><span class="n">literal</span><span class="si">}</span><span class="s2">`, &quot;</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>                        <span class="sa">f</span><span class="s2">&quot;most likely because they were not present in the training data. &quot;</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>                        <span class="sa">f</span><span class="s2">&quot;A random sample of the residuals from other levels will be used. &quot;</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>                        <span class="sa">f</span><span class="s2">&quot;This can lead to inaccurate intervals for the unknown levels.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>                        <span class="n">UnknownLevelWarning</span><span class="p">,</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>                    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_select_fit_kwargs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_select_fit_kwargs</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if <code>fit_kwargs</code> is a dict and select only keys used by estimator's <code>fit</code>.</p>
<p>This function validates that fit_kwargs is a dictionary, warns about unused arguments,
removes 'sample_weight' (which should be handled via weight_func), and returns
a dictionary containing only the arguments accepted by the estimator's fit method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn compatible estimator.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit_kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of arguments to pass to the estimator's fit method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with only the arguments accepted by the estimator's fit method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If fit_kwargs is not a dict.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>IgnoredArgumentWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If fit_kwargs contains keys not used by fit method,
or if 'sample_weight' is present (it gets removed).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.forecaster_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_select_fit_kwargs</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid argument for Ridge.fit</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sample_weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;invalid_arg&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># sample_weight is removed (should be passed via weight_func in forecaster)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># invalid_arg is ignored</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">{}</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/forecaster_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_select_fit_kwargs</span><span class="p">(</span><span class="n">estimator</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    Check if `fit_kwargs` is a dict and select only keys used by estimator&#39;s `fit`.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    This function validates that fit_kwargs is a dictionary, warns about unused arguments,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    removes &#39;sample_weight&#39; (which should be handled via weight_func), and returns</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    a dictionary containing only the arguments accepted by the estimator&#39;s fit method.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        estimator: Scikit-learn compatible estimator.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        fit_kwargs: Dictionary of arguments to pass to the estimator&#39;s fit method.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Dictionary with only the arguments accepted by the estimator&#39;s fit method.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        TypeError: If fit_kwargs is not a dict.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        IgnoredArgumentWarning: If fit_kwargs contains keys not used by fit method,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            or if &#39;sample_weight&#39; is present (it gets removed).</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.forecaster_config import check_select_fit_kwargs</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        &gt;&gt;&gt; estimator = Ridge()</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        &gt;&gt;&gt; # Valid argument for Ridge.fit</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        &gt;&gt;&gt; kwargs = {&quot;sample_weight&quot;: [1, 1], &quot;invalid_arg&quot;: 10}</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        &gt;&gt;&gt; # sample_weight is removed (should be passed via weight_func in forecaster)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        &gt;&gt;&gt; # invalid_arg is ignored</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        &gt;&gt;&gt; filtered = check_select_fit_kwargs(estimator, kwargs)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        &gt;&gt;&gt; filtered</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        {}</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="c1"># Import IgnoredArgumentWarning if available, otherwise define locally</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IgnoredArgumentWarning</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">class</span><span class="w"> </span><span class="nc">IgnoredArgumentWarning</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">):</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Warning for ignored arguments.&quot;&quot;&quot;</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="k">pass</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="k">if</span> <span class="n">fit_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="sa">f</span><span class="s2">&quot;Argument `fit_kwargs` must be a dict. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="c1"># Get parameters accepted by estimator.fit</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">fit_params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># Identify unused keys</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">non_used_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_params</span><span class="p">]</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">if</span> <span class="n">non_used_keys</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="sa">f</span><span class="s2">&quot;Argument/s </span><span class="si">{</span><span class="n">non_used_keys</span><span class="si">}</span><span class="s2"> ignored since they are not used by the &quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                <span class="sa">f</span><span class="s2">&quot;estimator&#39;s `fit` method.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="c1"># Handle sample_weight specially</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">if</span> <span class="s2">&quot;sample_weight&quot;</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="s2">&quot;The `sample_weight` argument is ignored. Use `weight_func` to pass &quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="s2">&quot;a function that defines the individual weights for each sample &quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="s2">&quot;based on its index.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="k">del</span> <span class="n">fit_kwargs</span><span class="p">[</span><span class="s2">&quot;sample_weight&quot;</span><span class="p">]</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="c1"># Select only the keyword arguments allowed by the estimator&#39;s `fit` method.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="c1"># Note: We need to re-check keys because sample_weight might have been deleted but it might be in fit_params</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="c1"># If it was deleted, it is no longer in fit_kwargs, so this comprehension is safe</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fit_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">fit_params</span><span class="p">}</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="k">return</span> <span class="n">fit_kwargs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.check_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">series_id</span><span class="o">=</span><span class="s1">&#39;`y`&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate that y is a pandas Series without missing values.</p>
<p>This function ensures that the input time series meets the basic requirements
for forecasting: it must be a pandas Series and must not contain any NaN values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series values to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier of the series used in error messages. Defaults to "<code>y</code>".</p>
              </div>
            </td>
            <td>
                  <code>&#39;`y`&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If y is not a pandas Series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If y contains missing (NaN) values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_y</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Valid series</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_y</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># No error</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: not a Series</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">check_y</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">Error: `y` must be a pandas Series with a DatetimeIndex or a RangeIndex. Found &lt;class &#39;list&#39;&gt;.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: contains NaN</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_with_nan</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>    <span class="n">check_y</span><span class="p">(</span><span class="n">y_with_nan</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">Error: `y` has missing values.</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_y</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">series_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;`y`&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Validate that y is a pandas Series without missing values.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    This function ensures that the input time series meets the basic requirements</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    for forecasting: it must be a pandas Series and must not contain any NaN values.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        y: Time series values to validate.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        series_id: Identifier of the series used in error messages. Defaults to &quot;`y`&quot;.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        TypeError: If y is not a pandas Series.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        ValueError: If y contains missing (NaN) values.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.validation import check_y</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        &gt;&gt;&gt; # Valid series</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        &gt;&gt;&gt; check_y(y)  # No error</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        &gt;&gt;&gt; # Invalid: not a Series</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        ...     check_y([1, 2, 3])</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        ... except TypeError as e:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        ...     print(f&quot;Error: {e}&quot;)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        Error: `y` must be a pandas Series with a DatetimeIndex or a RangeIndex. Found &lt;class &#39;list&#39;&gt;.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        &gt;&gt;&gt; # Invalid: contains NaN</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        &gt;&gt;&gt; y_with_nan = pd.Series([1, 2, np.nan, 4])</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        ...     check_y(y_with_nan)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        ...     print(f&quot;Error: {e}&quot;)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        Error: `y` has missing values.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> must be a pandas Series with a DatetimeIndex or a RangeIndex. &quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_id</span><span class="si">}</span><span class="s2"> has missing values.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.date_to_index_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">date_to_index_position</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">date_input</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="n">date_literal</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">kwargs_pd_to_datetime</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transform a datetime string or pandas Timestamp to an integer. The integer
represents the position of the datetime in the index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas Index
Original datetime index (must be a pandas DatetimeIndex if <code>date_input</code>
is not an int).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_input</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int, str, pandas Timestamp
Datetime to transform to integer.</p>
<ul>
<li>If int, returns the same integer.</li>
<li>If str or pandas Timestamp, it is converted and expanded into the index.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, default 'prediction'
Can be 'prediction' or 'validation'.</p>
<ul>
<li>If 'prediction', the date must be later than the last date in the index.</li>
<li>If 'validation', the date must be within the index range.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;prediction&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_literal</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, default 'steps'
Variable name used in error messages.</p>
              </div>
            </td>
            <td>
                  <code>&#39;steps&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_pd_to_datetime</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict, default {}
Additional keyword arguments to pass to <code>pd.to_datetime()</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>date_input</code> transformed to integer position in the <code>index</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If <code>date_input</code> is an integer, it returns the same integer.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If method is 'prediction', number of steps to predict from the last</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>date in the index.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If method is 'validation', position plus one of the date in the index,</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>this is done to include the target date in the training set when using</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas iloc with slices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>method</code> is not 'prediction' or 'validation'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>date_input</code> is not an int, str, or pandas Timestamp.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>index</code> is not a pandas DatetimeIndex when <code>date_input</code> is not an int.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>date_input</code> is a date and does not meet the requirements based on the <code>method</code> argument.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotforecast2_safe.forecaster.utils import date_to_index_position
import pandas as pd
index = pd.date_range(start='2020-01-01', periods=10, freq='D')</p>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--using-an-integer-input">Using an integer input</h4>
<p>position = date_to_index_position(index, 5)
print(position)</p>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--output-5">Output: 5</h4>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-prediction">Using a date input for prediction</h4>
<p>position = date_to_index_position(index, '2020-01-15', method='prediction')
print(position)</p>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-number-of-steps-from-the-last-date-in-the-index-to-the-target-date">Output: 5 (number of steps from the last date in the index to the target date)</h4>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--using-a-date-input-for-validation">Using a date input for validation</h4>
<p>position = date_to_index_position(index, '2020-01-05', method='validation')
print(position)</p>
<h4 id="spotforecast2_safe.forecaster.utils.date_to_index_position--output-5-position-plus-one-of-the-target-date-in-the-index">Output: 5 (position plus one of the target date in the index)</h4>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="k">def</span><span class="w"> </span><span class="nf">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="n">date_input</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prediction&quot;</span><span class="p">,</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">date_literal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;steps&quot;</span><span class="p">,</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>    <span class="n">kwargs_pd_to_datetime</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">    Transform a datetime string or pandas Timestamp to an integer. The integer</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a><span class="sd">    represents the position of the datetime in the index.</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        index: pandas Index</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">            Original datetime index (must be a pandas DatetimeIndex if `date_input`</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">            is not an int).</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">        date_input: int, str, pandas Timestamp</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">            Datetime to transform to integer.</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">            - If int, returns the same integer.</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            - If str or pandas Timestamp, it is converted and expanded into the index.</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        method: str, default &#39;prediction&#39;</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            Can be &#39;prediction&#39; or &#39;validation&#39;.</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">            - If &#39;prediction&#39;, the date must be later than the last date in the index.</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            - If &#39;validation&#39;, the date must be within the index range.</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        date_literal: str, default &#39;steps&#39;</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">            Variable name used in error messages.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        kwargs_pd_to_datetime: dict, default {}</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            Additional keyword arguments to pass to `pd.to_datetime()`.</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">        int:</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            `date_input` transformed to integer position in the `index`.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">        + If `date_input` is an integer, it returns the same integer.</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        + If method is &#39;prediction&#39;, number of steps to predict from the last</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        date in the index.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        + If method is &#39;validation&#39;, position plus one of the date in the index,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">        this is done to include the target date in the training set when using</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        pandas iloc with slices.</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        ValueError: If `method` is not &#39;prediction&#39; or &#39;validation&#39;.</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        TypeError: If `date_input` is not an int, str, or pandas Timestamp.</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        TypeError: If `index` is not a pandas DatetimeIndex when `date_input` is not an int.</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">        ValueError: If `date_input` is a date and does not meet the requirements based on the `method` argument.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">        from spotforecast2_safe.forecaster.utils import date_to_index_position</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">        import pandas as pd</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">        index = pd.date_range(start=&#39;2020-01-01&#39;, periods=10, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">        # Using an integer input</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        position = date_to_index_position(index, 5)</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">        print(position)</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">        # Output: 5</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        # Using a date input for prediction</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">        position = date_to_index_position(index, &#39;2020-01-15&#39;, method=&#39;prediction&#39;)</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        print(position)</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        # Output: 5 (number of steps from the last date in the index to the target date)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        # Using a date input for validation</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">        position = date_to_index_position(index, &#39;2020-01-05&#39;, method=&#39;validation&#39;)</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">        print(position)</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        # Output: 5 (position plus one of the target date in the index)</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`method` must be &#39;prediction&#39; or &#39;validation&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>    <span class="c1"># Initialize output; will be set in all valid code paths below</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>    <span class="n">output</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date_input</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">)):</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>                <span class="sa">f</span><span class="s2">&quot;Index must be a pandas DatetimeIndex when `</span><span class="si">{</span><span class="n">date_literal</span><span class="si">}</span><span class="s2">` is &quot;</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>                <span class="sa">f</span><span class="s2">&quot;not an integer. Check input series or last window.&quot;</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>            <span class="p">)</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>        <span class="n">target_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date_input</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_pd_to_datetime</span><span class="p">)</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="n">last_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;prediction&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>            <span class="k">if</span> <span class="n">target_date</span> <span class="o">&lt;=</span> <span class="n">last_date</span><span class="p">:</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>                    <span class="s2">&quot;If `steps` is a date, it must be greater than the last date &quot;</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>                    <span class="s2">&quot;in the index.&quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>                <span class="p">)</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>            <span class="n">span_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>                <span class="n">start</span><span class="o">=</span><span class="n">last_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">target_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>            <span class="p">)</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>            <span class="n">output</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;validation&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a>            <span class="n">first_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a>            <span class="k">if</span> <span class="n">target_date</span> <span class="o">&lt;</span> <span class="n">first_date</span> <span class="ow">or</span> <span class="n">target_date</span> <span class="o">&gt;</span> <span class="n">last_date</span><span class="p">:</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a>                    <span class="s2">&quot;If `initial_train_size` is a date, it must be greater than &quot;</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a>                    <span class="s2">&quot;the first date in the index and less than the last date.&quot;</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>                <span class="p">)</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>            <span class="n">span_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a>                <span class="n">start</span><span class="o">=</span><span class="n">first_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">target_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a>            <span class="p">)</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>            <span class="n">output</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_index</span><span class="p">)</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">date_input</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">date_input</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>            <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">date_literal</span><span class="si">}</span><span class="s2">` must be an integer, string, or pandas Timestamp.&quot;</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>        <span class="p">)</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.exog_to_direct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exog_to_direct</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transforms <code>exog</code> to a pandas DataFrame with the shape needed for Direct
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pandas Series, pandas DataFrame
Exogenous variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int
Number of steps that will be predicted using exog.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[pd.DataFrame, list[str]]:
exog_direct: pandas DataFrame
    Exogenous variables transformed.
exog_direct_names: list
    Names of the columns of the exogenous variables transformed. Only
    created if <code>exog</code> is a pandas Series or DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="k">def</span><span class="w"> </span><span class="nf">exog_to_direct</span><span class="p">(</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    Transforms `exog` to a pandas DataFrame with the shape needed for Direct</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    forecasting.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        exog: pandas Series, pandas DataFrame</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            Exogenous variables.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        steps: int</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            Number of steps that will be predicted using exog.</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        tuple[pd.DataFrame, list[str]]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            exog_direct: pandas DataFrame</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">                Exogenous variables transformed.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            exog_direct_names: list</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                Names of the columns of the exogenous variables transformed. Only</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">                created if `exog` is a pandas Series or DataFrame.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series or DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">exog_idx</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">exog_cols</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">exog_direct</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="n">exog_step</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">),]</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="n">exog_step</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_step</span><span class="p">))</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">exog_step</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_step_</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_cols</span><span class="p">]</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="n">exog_direct</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_step</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">exog_direct</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">exog_direct</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">exog_direct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">exog_direct_names</span> <span class="o">=</span> <span class="n">exog_direct</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="n">exog_direct</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">exog_idx</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">exog_direct</span><span class="p">)</span> <span class="p">:]</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">return</span> <span class="n">exog_direct</span><span class="p">,</span> <span class="n">exog_direct_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.exog_to_direct_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exog_to_direct_numpy</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transforms <code>exog</code> to numpy ndarray with the shape needed for Direct
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy ndarray, pandas Series, pandas DataFrame
Exogenous variables, shape(samples,). If exog is a pandas format, the
direct exog names are created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int
Number of steps that will be predicted using exog.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="list">list</span>[<span title="str">str</span>] | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[np.ndarray, list[str] | None]:
exog_direct: numpy ndarray
    Exogenous variables transformed.
exog_direct_names: list, None
    Names of the columns of the exogenous variables transformed. Only
    created if <code>exog</code> is a pandas Series or DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotforecast2_safe.forecaster.utils import exog_to_direct_numpy
import numpy as np
exog = np.array([10, 20, 30, 40, 50])
steps = 3
exog_direct, exog_direct_names = exog_to_direct_numpy(exog, steps)
print(exog_direct)
    [[10 20 30]
    [20 30 40]
    [30 40 50]]
print(exog_direct_names)
None</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="k">def</span><span class="w"> </span><span class="nf">exog_to_direct_numpy</span><span class="p">(</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Transforms `exog` to numpy ndarray with the shape needed for Direct</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    forecasting.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        exog: numpy ndarray, pandas Series, pandas DataFrame</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            Exogenous variables, shape(samples,). If exog is a pandas format, the</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            direct exog names are created.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        steps: int</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            Number of steps that will be predicted using exog.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        tuple[np.ndarray, list[str] | None]:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            exog_direct: numpy ndarray</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">                Exogenous variables transformed.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            exog_direct_names: list, None</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">                Names of the columns of the exogenous variables transformed. Only</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">                created if `exog` is a pandas Series or DataFrame.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        from spotforecast2_safe.forecaster.utils import exog_to_direct_numpy</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        import numpy as np</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        exog = np.array([10, 20, 30, 40, 50])</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        steps = 3</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        exog_direct, exog_direct_names = exog_to_direct_numpy(exog, steps)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        print(exog_direct)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            [[10 20 30]</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            [20 30 40]</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            [30 40 50]]</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        print(exog_direct_names)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        None</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">exog_cols</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">exog_direct_names</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_step_</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">exog_cols</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="p">]</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">exog_direct_names</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>                <span class="sa">f</span><span class="s2">&quot;`exog` must be a numpy ndarray, pandas Series or DataFrame. &quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="k">if</span> <span class="n">exog</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">exog</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">exog_direct</span> <span class="o">=</span> <span class="p">[</span><span class="n">exog</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">n_rows</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">)]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">exog_direct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">exog_direct</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">steps</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">exog_direct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">return</span> <span class="n">exog_direct</span><span class="p">,</span> <span class="n">exog_direct_names</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.expand_index" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expand_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new index extending from the end of the original index.</p>
<p>This function generates future indices for forecasting by extending the time
series index by a specified number of steps. Handles both DatetimeIndex and
RangeIndex appropriately.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Index">Index</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original pandas Index (DatetimeIndex or RangeIndex). If None,
creates a RangeIndex starting from 0.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.Index">Index</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New pandas Index with <code>steps</code> future periods.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If steps is not an integer, or if index is neither DatetimeIndex
nor RangeIndex.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.data_transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand_index</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DatetimeIndex</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">DatetimeIndex([&#39;2023-01-06&#39;, &#39;2023-01-07&#39;, &#39;2023-01-08&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># RangeIndex</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">range_idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="n">range_idx</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">RangeIndex(start=10, stop=15, step=1)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># None index (creates new RangeIndex)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">new_index</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">RangeIndex(start=0, stop=3, step=1)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: steps not an integer</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">... </span>    <span class="n">expand_index</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: steps must be an integer&quot;</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">Error: steps must be an integer</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/data_transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="k">def</span><span class="w"> </span><span class="nf">expand_index</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    Create a new index extending from the end of the original index.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    This function generates future indices for forecasting by extending the time</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    series index by a specified number of steps. Handles both DatetimeIndex and</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    RangeIndex appropriately.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        index: Original pandas Index (DatetimeIndex or RangeIndex). If None,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            creates a RangeIndex starting from 0.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        steps: Number of future steps to generate.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        New pandas Index with `steps` future periods.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        TypeError: If steps is not an integer, or if index is neither DatetimeIndex</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            nor RangeIndex.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.data_transform import expand_index</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        &gt;&gt;&gt; # DatetimeIndex</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        &gt;&gt;&gt; dates = pd.date_range(&quot;2023-01-01&quot;, periods=5, freq=&quot;D&quot;)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &gt;&gt;&gt; new_index = expand_index(dates, 3)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        &gt;&gt;&gt; new_index</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        DatetimeIndex([&#39;2023-01-06&#39;, &#39;2023-01-07&#39;, &#39;2023-01-08&#39;], dtype=&#39;datetime64[ns]&#39;, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; # RangeIndex</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &gt;&gt;&gt; range_idx = pd.RangeIndex(start=0, stop=10)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; new_index = expand_index(range_idx, 5)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &gt;&gt;&gt; new_index</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        RangeIndex(start=10, stop=15, step=1)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        &gt;&gt;&gt; # None index (creates new RangeIndex)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        &gt;&gt;&gt; new_index = expand_index(None, 3)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        &gt;&gt;&gt; new_index</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        RangeIndex(start=0, stop=3, step=1)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        &gt;&gt;&gt; # Invalid: steps not an integer</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        ...     expand_index(dates, 3.5)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        ... except TypeError as e:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        ...     print(&quot;Error: steps must be an integer&quot;)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        Error: steps must be an integer</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`steps` must be an integer. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="c1"># Convert numpy integer to Python int if needed</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="n">start</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="s2">&quot;Argument `index` must be a pandas DatetimeIndex or RangeIndex.&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">new_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">steps</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">return</span> <span class="n">new_index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.get_exog_dtypes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract and store the data types of exogenous variables.</p>
<p>This function returns a dictionary mapping column names to their data types.
For Series, uses the series name as the key. For DataFrames, uses all column names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s (Series or DataFrame).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="type">type</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping variable names to their pandas dtypes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_exog_dtypes</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DataFrame with mixed types</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="s2">&quot;temp&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">20.5</span><span class="p">,</span> <span class="mf">21.3</span><span class="p">,</span> <span class="mf">22.1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="s2">&quot;is_weekend&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span><span class="p">})</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog_df</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">dtype(&#39;float64&#39;)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">dtype(&#39;int64&#39;)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Series</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog_series</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">{&#39;temperature&#39;: dtype(&#39;float64&#39;)}</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">]:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Extract and store the data types of exogenous variables.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    This function returns a dictionary mapping column names to their data types.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    For Series, uses the series name as the key. For DataFrames, uses all column names.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        exog: Exogenous variable/s (Series or DataFrame).</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Dictionary mapping variable names to their pandas dtypes.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.validation import get_exog_dtypes</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        &gt;&gt;&gt; # DataFrame with mixed types</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        &gt;&gt;&gt; exog_df = pd.DataFrame({</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        ...     &quot;temp&quot;: pd.Series([20.5, 21.3, 22.1], dtype=&#39;float64&#39;),</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        ...     &quot;day&quot;: pd.Series([1, 2, 3], dtype=&#39;int64&#39;),</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        ...     &quot;is_weekend&quot;: pd.Series([False, False, True], dtype=&#39;bool&#39;)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        ... })</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        &gt;&gt;&gt; dtypes = get_exog_dtypes(exog_df)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        &gt;&gt;&gt; dtypes[&#39;temp&#39;]</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        dtype(&#39;float64&#39;)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        &gt;&gt;&gt; dtypes[&#39;day&#39;]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        dtype(&#39;int64&#39;)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        &gt;&gt;&gt; # Series</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        &gt;&gt;&gt; exog_series = pd.Series([1.0, 2.0, 3.0], name=&quot;temperature&quot;, dtype=&#39;float64&#39;)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        &gt;&gt;&gt; dtypes = get_exog_dtypes(exog_series)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        &gt;&gt;&gt; dtypes</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        {&#39;temperature&#39;: dtype(&#39;float64&#39;)}</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="p">{</span><span class="n">exog</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="p">}</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">exog_dtypes</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">return</span> <span class="n">exog_dtypes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.get_style_repr_html" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_style_repr_html</span><span class="p">(</span><span class="n">is_fitted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate CSS style for HTML representation of the Forecaster.</p>
<p>Creates a unique CSS style block with a container ID for rendering
forecaster objects in Jupyter notebooks or HTML documents. The styling
provides a clean, monospace display with a light gray background.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>is_fitted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter to indicate if the Forecaster has been fitted.
Currently not used in styling but reserved for future extensions.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- style (str): CSS style block as a string with unique container class.
- unique_id (str): Unique 8-character ID for the container element.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">style</span><span class="p">,</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">(</span><span class="n">is_fitted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Container ID: </span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">Container ID: a1b2c3d4</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Style contains CSS: </span><span class="si">{</span><span class="s1">&#39;container-&#39;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">style</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Style contains CSS: True</span>
</code></pre></div>
    <p>Using in HTML rendering:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">style</span><span class="p">,</span> <span class="n">uid</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">(</span><span class="n">is_fitted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">style</span><span class="si">}</span><span class="s2">&lt;div class=&#39;container-</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">&#39;&gt;Forecaster Info&lt;/div&gt;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span> <span class="ow">in</span> <span class="n">html</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_style_repr_html</span><span class="p">(</span><span class="n">is_fitted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate CSS style for HTML representation of the Forecaster.</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    Creates a unique CSS style block with a container ID for rendering</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">    forecaster objects in Jupyter notebooks or HTML documents. The styling</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    provides a clean, monospace display with a light gray background.</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        is_fitted: Parameter to indicate if the Forecaster has been fitted.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            Currently not used in styling but reserved for future extensions.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        tuple: A tuple containing:</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">            - style (str): CSS style block as a string with unique container class.</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            - unique_id (str): Unique 8-character ID for the container element.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">        &gt;&gt;&gt; style, uid = get_style_repr_html(is_fitted=True)</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Container ID: {uid}&quot;)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        Container ID: a1b2c3d4</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Style contains CSS: {&#39;container-&#39; in style}&quot;)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        Style contains CSS: True</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        Using in HTML rendering:</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        &gt;&gt;&gt; style, uid = get_style_repr_html(is_fitted=False)</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        &gt;&gt;&gt; html = f&quot;{style}&lt;div class=&#39;container-{uid}&#39;&gt;Forecaster Info&lt;/div&gt;&quot;</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        &gt;&gt;&gt; print(&quot;background-color&quot; in html)</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        True</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="n">unique_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())[:</span><span class="mi">8</span><span class="p">]</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="n">style</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="s2">    &lt;style&gt;</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a><span class="s2">        .container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2"> </span><span class="se">{{</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="s2">            font-family: monospace;</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a><span class="s2">            background-color: #f0f0f0;</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="s2">            padding: 10px;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="s2">            border-radius: 5px;</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="s2">        </span><span class="se">}}</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="s2">    &lt;/style&gt;</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>    <span class="k">return</span> <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.initialize_estimator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">regressor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Helper to handle the deprecation of 'regressor' in favor of 'estimator'.
Returns the valid estimator object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="object">object</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>estimator or pipeline compatible with the scikit-learn API, default None
An instance of a estimator or pipeline compatible with the scikit-learn API.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>regressor</code>
            </td>
            <td>
                  <code><span title="object">object</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>estimator or pipeline compatible with the scikit-learn API, default None
Deprecated. An instance of a estimator or pipeline compatible with the
scikit-learn API.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>estimator or pipeline compatible with the scikit-learn API
The valid estimator object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If both <code>estimator</code> and <code>regressor</code> are provided. Use only <code>estimator</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Warning">Warning</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>regressor</code> is provided, a FutureWarning is raised indicating that it is deprecated and will be removed in a future version.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotforecast2_safe.forecaster.utils import initialize_estimator
from sklearn.linear_model import LinearRegression</p>
<h4 id="spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-estimator-argument">Using the <code>estimator</code> argument</h4>
<p>estimator = LinearRegression()
result = initialize_estimator(estimator=estimator)
print(result)
LinearRegression()</p>
<h4 id="spotforecast2_safe.forecaster.utils.initialize_estimator--using-the-deprecated-regressor-argument">Using the deprecated <code>regressor</code> argument</h4>
<p>regressor = LinearRegression()
result = initialize_estimator(regressor=regressor)
print(result)
LinearRegression()</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_estimator</span><span class="p">(</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a><span class="sd">    Helper to handle the deprecation of &#39;regressor&#39; in favor of &#39;estimator&#39;.</span>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">    Returns the valid estimator object.</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        estimator: estimator or pipeline compatible with the scikit-learn API, default None</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a><span class="sd">            An instance of a estimator or pipeline compatible with the scikit-learn API.</span>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        regressor: estimator or pipeline compatible with the scikit-learn API, default None</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            Deprecated. An instance of a estimator or pipeline compatible with the</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a><span class="sd">            scikit-learn API.</span>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">        estimator or pipeline compatible with the scikit-learn API</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            The valid estimator object.</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a><span class="sd">        ValueError: If both `estimator` and `regressor` are provided. Use only `estimator`.</span>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">        Warning: If `regressor` is provided, a FutureWarning is raised indicating that it is deprecated and will be removed in a future version.</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        from spotforecast2_safe.forecaster.utils import initialize_estimator</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a><span class="sd">        from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        # Using the `estimator` argument</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">        estimator = LinearRegression()</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">        result = initialize_estimator(estimator=estimator)</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        print(result)</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">        LinearRegression()</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">        # Using the deprecated `regressor` argument</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a><span class="sd">        regressor = LinearRegression()</span>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">        result = initialize_estimator(regressor=regressor)</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">        print(result)</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">        LinearRegression()</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a>    <span class="k">if</span> <span class="n">regressor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a>            <span class="s2">&quot;The `regressor` argument is deprecated and will be removed in a future &quot;</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a>            <span class="s2">&quot;version. Please use `estimator` instead.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>            <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a>            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># Important: to point to the user&#39;s code</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a>        <span class="p">)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>        <span class="k">if</span> <span class="n">estimator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>                <span class="s2">&quot;Both `estimator` and `regressor` were provided. Use only `estimator`.&quot;</span>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a>            <span class="p">)</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>        <span class="k">return</span> <span class="n">regressor</span>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>    <span class="k">return</span> <span class="n">estimator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.initialize_lags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_lags</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate and normalize lag specification for forecasting.</p>
<p>This function converts various lag specifications (int, list, tuple, range, ndarray)
into a standardized format: sorted numpy array, lag names, and maximum lag value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the forecaster class for error messages.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lag specification in one of several formats:
- int: Creates lags from 1 to lags (e.g., 5  [1,2,3,4,5])
- list/tuple/range: Converted to numpy array
- numpy.ndarray: Validated and used directly
- None: Returns (None, None, None)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>lags: Sorted numpy array of lag values (or None)</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>lags_names: List of lag names like ['lag_1', 'lag_2', ...] (or None)</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>], <span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]], <span title="typing.Optional">Optional</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>max_lag: Maximum lag value (or None)</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If lags &lt; 1, empty array, or not 1-dimensional.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If lags is not an integer, not in the right format for the forecaster,
or array contains non-integer values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.forecaster_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_lags</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Integer input</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">array([1, 2, 3])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">[&#39;lag_1&#39;, &#39;lag_2&#39;, &#39;lag_3&#39;]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">max_lag</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">3</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># List input</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">array([1, 3, 5])</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">[&#39;lag_1&#39;, &#39;lag_3&#39;, &#39;lag_5&#39;]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Range input</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">array([1, 2, 3])</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># None input</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">True</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: lags &lt; 1</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="gp">... </span>    <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Minimum value of lags allowed is 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">Error: Minimum value of lags allowed is 1</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid: negative lags</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="gp">... </span>    <span class="n">initialize_lags</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Minimum value of lags allowed is 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">Error: Minimum value of lags allowed is 1</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/forecaster_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_lags</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lags</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Validate and normalize lag specification for forecasting.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    This function converts various lag specifications (int, list, tuple, range, ndarray)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    into a standardized format: sorted numpy array, lag names, and maximum lag value.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        forecaster_name: Name of the forecaster class for error messages.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        lags: Lag specification in one of several formats:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            - int: Creates lags from 1 to lags (e.g., 5  [1,2,3,4,5])</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            - list/tuple/range: Converted to numpy array</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            - numpy.ndarray: Validated and used directly</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            - None: Returns (None, None, None)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        Tuple containing:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        - lags: Sorted numpy array of lag values (or None)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        - lags_names: List of lag names like [&#39;lag_1&#39;, &#39;lag_2&#39;, ...] (or None)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        - max_lag: Maximum lag value (or None)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        ValueError: If lags &lt; 1, empty array, or not 1-dimensional.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        TypeError: If lags is not an integer, not in the right format for the forecaster,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            or array contains non-integer values.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.forecaster_config import initialize_lags</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        &gt;&gt;&gt; # Integer input</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        &gt;&gt;&gt; lags, names, max_lag = initialize_lags(&quot;ForecasterRecursive&quot;, 3)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        &gt;&gt;&gt; lags</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        array([1, 2, 3])</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        &gt;&gt;&gt; names</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        [&#39;lag_1&#39;, &#39;lag_2&#39;, &#39;lag_3&#39;]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        &gt;&gt;&gt; max_lag</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        3</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        &gt;&gt;&gt; # List input</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        &gt;&gt;&gt; lags, names, max_lag = initialize_lags(&quot;ForecasterRecursive&quot;, [1, 3, 5])</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        &gt;&gt;&gt; lags</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        array([1, 3, 5])</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        &gt;&gt;&gt; names</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        [&#39;lag_1&#39;, &#39;lag_3&#39;, &#39;lag_5&#39;]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        &gt;&gt;&gt; # Range input</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        &gt;&gt;&gt; lags, names, max_lag = initialize_lags(&quot;ForecasterRecursive&quot;, range(1, 4))</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        &gt;&gt;&gt; lags</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        array([1, 2, 3])</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        &gt;&gt;&gt; # None input</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        &gt;&gt;&gt; lags, names, max_lag = initialize_lags(&quot;ForecasterRecursive&quot;, None)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        &gt;&gt;&gt; lags is None</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        True</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        &gt;&gt;&gt; # Invalid: lags &lt; 1</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        ...     initialize_lags(&quot;ForecasterRecursive&quot;, 0)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        ...     print(&quot;Error: Minimum value of lags allowed is 1&quot;)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Error: Minimum value of lags allowed is 1</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        &gt;&gt;&gt; # Invalid: negative lags</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        ...     initialize_lags(&quot;ForecasterRecursive&quot;, [1, -2, 3])</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ... except ValueError as e:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        ...     print(&quot;Error: Minimum value of lags allowed is 1&quot;)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        Error: Minimum value of lags allowed is 1</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">lags_names</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">max_lag</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">if</span> <span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">if</span> <span class="n">lags</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">range</span><span class="p">)):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="k">if</span> <span class="n">lags</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="k">if</span> <span class="n">lags</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`lags` must be a 1-dimensional array.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">lags</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">):</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All values in `lags` must be integers.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">lags</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Minimum value of lags allowed is 1.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="sa">f</span><span class="s2">&quot;`lags` argument must be a dict, int, 1d numpy ndarray, range, &quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                    <span class="sa">f</span><span class="s2">&quot;tuple or list. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                    <span class="sa">f</span><span class="s2">&quot;`lags` argument must be an int, 1d numpy ndarray, range, &quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                    <span class="sa">f</span><span class="s2">&quot;tuple or list. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">lags_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;lag_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lags</span><span class="p">]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">max_lag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lags</span><span class="p">))</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">return</span> <span class="n">lags</span><span class="p">,</span> <span class="n">lags_names</span><span class="p">,</span> <span class="n">max_lag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.initialize_transformer_series" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_transformer_series</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">series_names_in_</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transformer_series</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize transformer_series_ attribute for multivariate/multiseries forecasters.</p>
<p>Creates a dictionary of transformers for each time series in multivariate or
multiseries forecasting. Handles three cases: no transformation (None), same
transformer for all series (single object), or different transformers per series
(dictionary). Clones transformer objects to avoid overwriting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the forecaster using this function. Special handling
is applied for 'ForecasterRecursiveMultiSeries'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_names_in_</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the time series (levels) used during training.
These will be the keys in the returned transformer dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Encoding used to identify different series. Only used for
ForecasterRecursiveMultiSeries. If None, creates a single '_unknown_level'
entry. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer_series</code>
            </td>
            <td>
                  <code><span title="object">object</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span> | None] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformer(s) to apply to series. Can be:
- None: No transformation applied
- Single transformer object: Same transformer cloned for all series
- Dict mapping series names to transformers: Different transformer per series
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="object">object</span> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with series names as keys and transformer objects (or None)
as values. Transformers are cloned to prevent overwriting.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>IgnoredArgumentWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If transformer_series is a dict and some series_names_in_
are not present in the dict keys (those series get no transformation).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>No transformation:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_transformer_series</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;series1&#39;</span><span class="p">,</span> <span class="s1">&#39;series2&#39;</span><span class="p">,</span> <span class="s1">&#39;series3&#39;</span><span class="p">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">initialize_transformer_series</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">forecaster_name</span><span class="o">=</span><span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">series_names_in_</span><span class="o">=</span><span class="n">series</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">transformer_series</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">{&#39;series1&#39;: None, &#39;series2&#39;: None, &#39;series3&#39;: None}</span>
</code></pre></div>
    <p>Same transformer for all series:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">initialize_transformer_series</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">forecaster_name</span><span class="o">=</span><span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">series_names_in_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;series1&#39;</span><span class="p">,</span> <span class="s1">&#39;series2&#39;</span><span class="p">],</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">transformer_series</span><span class="o">=</span><span class="n">scaler</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">2</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">True</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;series1&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;series2&#39;</span><span class="p">]</span>  <span class="c1"># Different clones</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">False</span>
</code></pre></div>
    <p>Different transformer per series:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinMaxScaler</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">transformers</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="s1">&#39;series1&#39;</span><span class="p">:</span> <span class="n">StandardScaler</span><span class="p">(),</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="s1">&#39;series2&#39;</span><span class="p">:</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">}</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">initialize_transformer_series</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">forecaster_name</span><span class="o">=</span><span class="s1">&#39;ForecasterDirectMultiVariate&#39;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">series_names_in_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;series1&#39;</span><span class="p">,</span> <span class="s1">&#39;series2&#39;</span><span class="p">],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">transformer_series</span><span class="o">=</span><span class="n">transformers</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;series1&#39;</span><span class="p">],</span> <span class="n">StandardScaler</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;series2&#39;</span><span class="p">],</span> <span class="n">MinMaxScaler</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_transformer_series</span><span class="p">(</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>    <span class="n">series_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>    <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a>    <span class="n">transformer_series</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize transformer_series_ attribute for multivariate/multiseries forecasters.</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">    Creates a dictionary of transformers for each time series in multivariate or</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">    multiseries forecasting. Handles three cases: no transformation (None), same</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">    transformer for all series (single object), or different transformers per series</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">    (dictionary). Clones transformer objects to avoid overwriting.</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">        forecaster_name: Name of the forecaster using this function. Special handling</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">            is applied for &#39;ForecasterRecursiveMultiSeries&#39;.</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">        series_names_in_: Names of the time series (levels) used during training.</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            These will be the keys in the returned transformer dictionary.</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">        encoding: Encoding used to identify different series. Only used for</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">            ForecasterRecursiveMultiSeries. If None, creates a single &#39;_unknown_level&#39;</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">            entry. Defaults to None.</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">        transformer_series: Transformer(s) to apply to series. Can be:</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">            - None: No transformation applied</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">            - Single transformer object: Same transformer cloned for all series</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">            - Dict mapping series names to transformers: Different transformer per series</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">        dict: Dictionary with series names as keys and transformer objects (or None)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">            as values. Transformers are cloned to prevent overwriting.</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">        IgnoredArgumentWarning: If transformer_series is a dict and some series_names_in_</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">            are not present in the dict keys (those series get no transformation).</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">        No transformation:</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.utils import initialize_transformer_series</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">        &gt;&gt;&gt; series = [&#39;series1&#39;, &#39;series2&#39;, &#39;series3&#39;]</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">        &gt;&gt;&gt; result = initialize_transformer_series(</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">        ...     forecaster_name=&#39;ForecasterDirectMultiVariate&#39;,</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">        ...     series_names_in_=series,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">        ...     transformer_series=None</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">        &gt;&gt;&gt; print(result)</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">        {&#39;series1&#39;: None, &#39;series2&#39;: None, &#39;series3&#39;: None}</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">        Same transformer for all series:</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">        &gt;&gt;&gt; from sklearn.preprocessing import StandardScaler</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        &gt;&gt;&gt; scaler = StandardScaler()</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a><span class="sd">        &gt;&gt;&gt; result = initialize_transformer_series(</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a><span class="sd">        ...     forecaster_name=&#39;ForecasterDirectMultiVariate&#39;,</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a><span class="sd">        ...     series_names_in_=[&#39;series1&#39;, &#39;series2&#39;],</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a><span class="sd">        ...     transformer_series=scaler</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a><span class="sd">        &gt;&gt;&gt; len(result)</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a><span class="sd">        2</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a><span class="sd">        &gt;&gt;&gt; all(isinstance(v, StandardScaler) for v in result.values())</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a><span class="sd">        True</span>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a><span class="sd">        &gt;&gt;&gt; result[&#39;series1&#39;] is result[&#39;series2&#39;]  # Different clones</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a><span class="sd">        False</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a><span class="sd">        Different transformer per series:</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a><span class="sd">        &gt;&gt;&gt; from sklearn.preprocessing import MinMaxScaler</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a><span class="sd">        &gt;&gt;&gt; transformers = {</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a><span class="sd">        ...     &#39;series1&#39;: StandardScaler(),</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a><span class="sd">        ...     &#39;series2&#39;: MinMaxScaler()</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a><span class="sd">        ... }</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a><span class="sd">        &gt;&gt;&gt; result = initialize_transformer_series(</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a><span class="sd">        ...     forecaster_name=&#39;ForecasterDirectMultiVariate&#39;,</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a><span class="sd">        ...     series_names_in_=[&#39;series1&#39;, &#39;series2&#39;],</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a><span class="sd">        ...     transformer_series=transformers</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a><span class="sd">        &gt;&gt;&gt; isinstance(result[&#39;series1&#39;], StandardScaler)</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a><span class="sd">        True</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a><span class="sd">        &gt;&gt;&gt; isinstance(result[&#39;series2&#39;], MinMaxScaler)</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a><span class="sd">        True</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">clone</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IgnoredArgumentWarning</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_unknown_level&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="n">series_names_in_</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;_unknown_level&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>    <span class="k">if</span> <span class="n">transformer_series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>            <span class="n">serie</span><span class="p">:</span> <span class="n">clone</span><span class="p">(</span><span class="n">transformer_series</span><span class="p">)</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>        <span class="p">}</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>        <span class="n">transformer_series_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>        <span class="c1"># Only elements already present in transformer_series_ are updated</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>        <span class="n">transformer_series_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>            <span class="p">{</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>                <span class="n">k</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">transformer_series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">transformer_series_</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>            <span class="p">}</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="p">)</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>        <span class="n">series_not_in_transformer_series</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>            <span class="nb">set</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">transformer_series</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>        <span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;_unknown_level&quot;</span><span class="p">}</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>        <span class="k">if</span> <span class="n">series_not_in_transformer_series</span><span class="p">:</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_not_in_transformer_series</span><span class="si">}</span><span class="s2"> not present in `transformer_series`.&quot;</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>                <span class="sa">f</span><span class="s2">&quot; No transformation is applied to these series.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>            <span class="p">)</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>    <span class="k">return</span> <span class="n">transformer_series_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.initialize_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_weights</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">weight_func</span><span class="p">,</span> <span class="n">series_weights</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate and initialize weight function configuration for forecasting.</p>
<p>This function validates weight_func and series_weights, extracts source code
from weight functions for serialization, and checks if the estimator supports
sample weights in its fit method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the forecaster class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn compatible estimator or pipeline.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>weight_func</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight function specification:
- Callable: Single weight function
- dict: Dictionary of weight functions (for MultiSeries forecasters)
- None: No weighting</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series_weights</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of series-level weights (for MultiSeries forecasters).
- dict: Maps series names to weight values
- None: No series weighting</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="dict">dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>weight_func: Validated weight function (or None if invalid)</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>source_code_weight_func: Source code of weight function(s) for serialization (or None)</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Any">Any</span>, <span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="dict">dict</span>]], <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>series_weights: Validated series weights (or None if invalid)</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If weight_func is not Callable/dict (depending on forecaster type),
or if series_weights is not a dict.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Warns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>IgnoredArgumentWarning</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If estimator doesn't support sample_weight.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.forecaster_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_weights</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple weight function</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">custom_weights</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="n">initialize_weights</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">custom_weights</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">True</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">True</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># No weight function</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">sw</span> <span class="o">=</span> <span class="n">initialize_weights</span><span class="p">(</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>    <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">True</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">True</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Invalid type for non-MultiSeries forecaster</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="gp">... </span>    <span class="n">initialize_weights</span><span class="p">(</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="s2">&quot;invalid&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="gp">... </span><span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: weight_func must be Callable&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">Error: weight_func must be Callable</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/forecaster_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_weights</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">estimator</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">weight_func</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">series_weights</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Validate and initialize weight function configuration for forecasting.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    This function validates weight_func and series_weights, extracts source code</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    from weight functions for serialization, and checks if the estimator supports</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    sample weights in its fit method.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        forecaster_name: Name of the forecaster class.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        estimator: Scikit-learn compatible estimator or pipeline.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        weight_func: Weight function specification:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            - Callable: Single weight function</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            - dict: Dictionary of weight functions (for MultiSeries forecasters)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            - None: No weighting</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        series_weights: Dictionary of series-level weights (for MultiSeries forecasters).</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            - dict: Maps series names to weight values</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            - None: No series weighting</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Tuple containing:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        - weight_func: Validated weight function (or None if invalid)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        - source_code_weight_func: Source code of weight function(s) for serialization (or None)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        - series_weights: Validated series weights (or None if invalid)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        TypeError: If weight_func is not Callable/dict (depending on forecaster type),</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            or if series_weights is not a dict.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Warnings:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        IgnoredArgumentWarning: If estimator doesn&#39;t support sample_weight.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.forecaster_config import initialize_weights</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        &gt;&gt;&gt; # Simple weight function</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        &gt;&gt;&gt; def custom_weights(index):</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        ...     return np.ones(len(index))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        &gt;&gt;&gt; estimator = Ridge()</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; wf, source, sw = initialize_weights(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        ...     &quot;ForecasterRecursive&quot;, estimator, custom_weights, None</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        &gt;&gt;&gt; wf is not None</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        True</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; isinstance(source, str)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        True</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &gt;&gt;&gt; # No weight function</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        &gt;&gt;&gt; wf, source, sw = initialize_weights(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ...     &quot;ForecasterRecursive&quot;, estimator, None, None</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        &gt;&gt;&gt; wf is None</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        True</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        &gt;&gt;&gt; source is None</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        True</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        &gt;&gt;&gt; # Invalid type for non-MultiSeries forecaster</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        &gt;&gt;&gt; try:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        ...     initialize_weights(&quot;ForecasterRecursive&quot;, estimator, &quot;invalid&quot;, None)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        ... except TypeError as e:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        ...     print(&quot;Error: weight_func must be Callable&quot;)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        Error: weight_func must be Callable</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="c1"># Import IgnoredArgumentWarning if available, otherwise define locally</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IgnoredArgumentWarning</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">class</span><span class="w"> </span><span class="nc">IgnoredArgumentWarning</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">):</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Warning for ignored arguments.&quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="k">pass</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">if</span> <span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                    <span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable or a dict of &quot;</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                    <span class="sa">f</span><span class="s2">&quot;Callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="sa">f</span><span class="s2">&quot;Argument `weight_func` must be a Callable. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">weight_func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">weight_func</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                    <span class="n">source_code_weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                    <span class="c1"># OSError: source not available, TypeError: callable class instance</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                    <span class="n">source_code_weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                        <span class="sa">f</span><span class="s2">&quot;&lt;source unavailable: </span><span class="si">{</span><span class="n">weight_func</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                    <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">weight_func</span><span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                <span class="c1"># OSError: source not available (e.g., built-in, lambda in REPL)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span class="c1"># TypeError: callable class instance (e.g., WeightFunction)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="c1"># In these cases, we can&#39;t get source but the object can still be pickled</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;source unavailable: </span><span class="si">{</span><span class="n">weight_func</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">if</span> <span class="s2">&quot;sample_weight&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                <span class="sa">f</span><span class="s2">&quot;Argument `weight_func` is ignored since estimator </span><span class="si">{</span><span class="n">estimator</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">weight_func</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">source_code_weight_func</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">if</span> <span class="n">series_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_weights</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="sa">f</span><span class="s2">&quot;Argument `series_weights` must be a dict of floats or ints.&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series_weights</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="k">if</span> <span class="s2">&quot;sample_weight&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="sa">f</span><span class="s2">&quot;Argument `series_weights` is ignored since estimator </span><span class="si">{</span><span class="n">estimator</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="sa">f</span><span class="s2">&quot;does not accept `sample_weight` in its `fit` method.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">series_weights</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="n">weight_func</span><span class="p">,</span> <span class="n">source_code_weight_func</span><span class="p">,</span> <span class="n">series_weights</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.initialize_window_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check window_features argument input and generate the corresponding list.</p>
<p>This function validates window feature objects and extracts their metadata,
ensuring they have the required attributes (window_sizes, features_names) and
methods (transform_batch, transform) for proper forecasting operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>window_features</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Classes used to create window features. Can be a single
object or a list of objects. Each object must have <code>window_sizes</code>,
<code>features_names</code> attributes and <code>transform_batch</code>, <code>transform</code> methods.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="object">object</span>]], <span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]], <span title="typing.Optional">Optional</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- window_features (list or None): List of classes used to create window features.
- window_features_names (list or None): List with all the features names of the window features.
- max_size_window_features (int or None): Maximum value of the <code>window_sizes</code> attribute of all classes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>window_features</code> is an empty list.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a window feature is missing required attributes or methods.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>window_sizes</code> or <code>features_names</code> have incorrect types.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RollingFeatures</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf</span> <span class="o">=</span> <span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">],</span> <span class="n">window_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf_list</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_size</span> <span class="o">=</span> <span class="n">initialize_window_features</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max window size: </span><span class="si">{</span><span class="n">max_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Max window size: 14</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of features: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">Number of features: 4</span>
</code></pre></div>
    <p>Multiple window features:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf1</span> <span class="o">=</span> <span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">],</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf2</span> <span class="o">=</span> <span class="n">RollingFeatures</span><span class="p">(</span><span class="n">stats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="n">window_sizes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">wf_list</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">max_size</span> <span class="o">=</span> <span class="n">initialize_window_features</span><span class="p">([</span><span class="n">wf1</span><span class="p">,</span> <span class="n">wf2</span><span class="p">])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max window size: </span><span class="si">{</span><span class="n">max_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Max window size: 7</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_window_features</span><span class="p">(</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="n">window_features</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">object</span><span class="p">]],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check window_features argument input and generate the corresponding list.</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">    This function validates window feature objects and extracts their metadata,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    ensuring they have the required attributes (window_sizes, features_names) and</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">    methods (transform_batch, transform) for proper forecasting operations.</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        window_features: Classes used to create window features. Can be a single</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            object or a list of objects. Each object must have `window_sizes`,</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            `features_names` attributes and `transform_batch`, `transform` methods.</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        tuple: A tuple containing:</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            - window_features (list or None): List of classes used to create window features.</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            - window_features_names (list or None): List with all the features names of the window features.</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            - max_size_window_features (int or None): Maximum value of the `window_sizes` attribute of all classes.</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">        ValueError: If `window_features` is an empty list.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        ValueError: If a window feature is missing required attributes or methods.</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        TypeError: If `window_sizes` or `features_names` have incorrect types.</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.preprocessing import RollingFeatures</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        &gt;&gt;&gt; wf = RollingFeatures(stats=[&#39;mean&#39;, &#39;std&#39;], window_sizes=[7, 14])</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">        &gt;&gt;&gt; wf_list, names, max_size = initialize_window_features(wf)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Max window size: {max_size}&quot;)</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        Max window size: 14</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Number of features: {len(names)}&quot;)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        Number of features: 4</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">        Multiple window features:</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">        &gt;&gt;&gt; wf1 = RollingFeatures(stats=[&#39;mean&#39;], window_sizes=7)</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">        &gt;&gt;&gt; wf2 = RollingFeatures(stats=[&#39;max&#39;, &#39;min&#39;], window_sizes=3)</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        &gt;&gt;&gt; wf_list, names, max_size = initialize_window_features([wf1, wf2])</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Max window size: {max_size}&quot;)</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        Max window size: 7</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="n">needed_atts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;window_sizes&quot;</span><span class="p">,</span> <span class="s2">&quot;features_names&quot;</span><span class="p">]</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>    <span class="n">needed_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;transform_batch&quot;</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">]</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="n">max_window_sizes</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="n">window_features_names</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="n">max_size_window_features</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_features</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>                <span class="s2">&quot;Argument `window_features` must contain at least one element.&quot;</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_features</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="n">window_features</span> <span class="o">=</span> <span class="p">[</span><span class="n">window_features</span><span class="p">]</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">link_to_docs</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Visit the documentation for more information about how to create &quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="s2">&quot;custom window features.&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">max_window_sizes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="n">window_features_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">needed_atts_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">needed_atts</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">needed_methods_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">needed_methods</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="n">window_features</span><span class="p">:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="n">wf_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="n">atts_methods</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">wf</span><span class="p">))</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">needed_atts_set</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">atts_methods</span><span class="p">):</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2"> must have the attributes: </span><span class="si">{</span><span class="n">needed_atts</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">needed_methods_set</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">atts_methods</span><span class="p">):</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2"> must have the methods: </span><span class="si">{</span><span class="n">needed_methods</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                <span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="n">window_sizes</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">window_sizes</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                    <span class="sa">f</span><span class="s2">&quot;Attribute `window_sizes` of </span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2"> must be an int or a list &quot;</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                    <span class="sa">f</span><span class="s2">&quot;of ints. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                <span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                <span class="k">if</span> <span class="n">window_sizes</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                        <span class="sa">f</span><span class="s2">&quot;If argument `window_sizes` is an integer, it must be equal to or &quot;</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                        <span class="sa">f</span><span class="s2">&quot;greater than 1. Got </span><span class="si">{</span><span class="n">window_sizes</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                        <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                    <span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>                <span class="n">max_window_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="n">window_sizes</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                    <span class="n">ws</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="n">window_sizes</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>                <span class="p">):</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>                        <span class="sa">f</span><span class="s2">&quot;If argument `window_sizes` is a list, all elements must be integers &quot;</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                        <span class="sa">f</span><span class="s2">&quot;equal to or greater than 1. Got </span><span class="si">{</span><span class="n">window_sizes</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                        <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                    <span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                <span class="n">max_window_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">window_sizes</span><span class="p">))</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>            <span class="n">features_names</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">features_names</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">features_names</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                    <span class="sa">f</span><span class="s2">&quot;Attribute `features_names` of </span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2"> must be a str or &quot;</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>                    <span class="sa">f</span><span class="s2">&quot;a list of strings. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">features_names</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span> <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>                <span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">features_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="n">window_features_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features_names</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">features_names</span><span class="p">):</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                        <span class="sa">f</span><span class="s2">&quot;If argument `features_names` is a list, all elements &quot;</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                        <span class="sa">f</span><span class="s2">&quot;must be strings. Got </span><span class="si">{</span><span class="n">features_names</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">wf_name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                        <span class="o">+</span> <span class="n">link_to_docs</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                    <span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="n">window_features_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">features_names</span><span class="p">)</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="n">max_size_window_features</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_window_sizes</span><span class="p">)</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">window_features_names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">window_features_names</span><span class="p">):</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                <span class="sa">f</span><span class="s2">&quot;All window features names must be unique. Got </span><span class="si">{</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="p">)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="k">return</span> <span class="n">window_features</span><span class="p">,</span> <span class="n">window_features_names</span><span class="p">,</span> <span class="n">max_size_window_features</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.input_to_frame" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">input_to_frame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">input_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert input data to a pandas DataFrame.</p>
<p>This function ensures consistent DataFrame format for internal processing.
If data is already a DataFrame, it's returned as-is. If it's a Series,
it's converted to a single-column DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.Series">Series</span>, <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input data as pandas Series or DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the input data type. Accepted values are:
- 'y': Target time series
- 'last_window': Last window for prediction
- 'exog': Exogenous variables</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame version of the input data. For Series input, uses the series</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name if available, otherwise uses a default name based on input_name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.utils.data_transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">input_to_frame</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Series with name</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sales&quot;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">[&#39;sales&#39;]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Series without name (uses default)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y_no_name</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">y_no_name</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">[&#39;y&#39;]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># DataFrame (returned as-is)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_input</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;temp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">55</span><span class="p">]})</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_output</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">df_input</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_output</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">[&#39;temp&#39;, &#39;humidity&#39;]</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Exog series without name</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_exog</span> <span class="o">=</span> <span class="n">input_to_frame</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">input_name</span><span class="o">=</span><span class="s2">&quot;exog&quot;</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">df_exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">[&#39;exog&#39;]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/data_transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="k">def</span><span class="w"> </span><span class="nf">input_to_frame</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span> <span class="n">input_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Convert input data to a pandas DataFrame.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    This function ensures consistent DataFrame format for internal processing.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    If data is already a DataFrame, it&#39;s returned as-is. If it&#39;s a Series,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    it&#39;s converted to a single-column DataFrame.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        data: Input data as pandas Series or DataFrame.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        input_name: Name of the input data type. Accepted values are:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            - &#39;y&#39;: Target time series</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            - &#39;last_window&#39;: Last window for prediction</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            - &#39;exog&#39;: Exogenous variables</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        DataFrame version of the input data. For Series input, uses the series</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        name if available, otherwise uses a default name based on input_name.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.utils.data_transform import input_to_frame</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; # Series with name</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3], name=&quot;sales&quot;)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        &gt;&gt;&gt; df = input_to_frame(y, input_name=&quot;y&quot;)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        &gt;&gt;&gt; df.columns.tolist()</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        [&#39;sales&#39;]</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        &gt;&gt;&gt; # Series without name (uses default)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        &gt;&gt;&gt; y_no_name = pd.Series([1, 2, 3])</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        &gt;&gt;&gt; df = input_to_frame(y_no_name, input_name=&quot;y&quot;)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        &gt;&gt;&gt; df.columns.tolist()</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        [&#39;y&#39;]</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &gt;&gt;&gt; # DataFrame (returned as-is)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &gt;&gt;&gt; df_input = pd.DataFrame({&quot;temp&quot;: [20, 21], &quot;humidity&quot;: [50, 55]})</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &gt;&gt;&gt; df_output = input_to_frame(df_input, input_name=&quot;exog&quot;)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; df_output.columns.tolist()</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        [&#39;temp&#39;, &#39;humidity&#39;]</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        &gt;&gt;&gt; # Exog series without name</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        &gt;&gt;&gt; exog = pd.Series([10, 20, 30])</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        &gt;&gt;&gt; df_exog = input_to_frame(exog, input_name=&quot;exog&quot;)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        &gt;&gt;&gt; df_exog.columns.tolist()</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        [&#39;exog&#39;]</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">output_col_name</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;last_window&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;exog&quot;</span><span class="p">:</span> <span class="s2">&quot;exog&quot;</span><span class="p">}</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">name</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">output_col_name</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.predict_multivariate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_multivariate</span><span class="p">(</span><span class="n">forecasters</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate multi-output predictions using multiple baseline forecasters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecasters</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of fitted forecaster instances (one per target).
Keys are target names, values are the fitted forecasters (e.g.,
ForecasterRecursive, ForecasterEquivalentDate).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps_ahead</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of steps to forecast.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables for prediction.
If provided, will be passed to each forecaster's predict method.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show progress bar while predicting
per target forecaster. Default: False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: DataFrame with predictions for all targets.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2_safe.forecaster.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">predict_multivariate</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y1</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y2</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecasters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;target1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span> <span class="s1">&#39;target2&#39;</span><span class="p">:</span> <span class="n">f2</span><span class="p">}</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predict_multivariate</span><span class="p">(</span><span class="n">forecasters</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">   target1  target2</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">5      6.0     12.0</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">6      7.0     14.0</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="k">def</span><span class="w"> </span><span class="nf">predict_multivariate</span><span class="p">(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a>    <span class="n">forecasters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a>    <span class="n">steps_ahead</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">    Generate multi-output predictions using multiple baseline forecasters.</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">        forecasters (dict): Dictionary of fitted forecaster instances (one per target).</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a><span class="sd">            Keys are target names, values are the fitted forecasters (e.g.,</span>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">            ForecasterRecursive, ForecasterEquivalentDate).</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">        steps_ahead (int): Number of steps to forecast.</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">        exog (pd.DataFrame, optional): Exogenous variables for prediction.</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">            If provided, will be passed to each forecaster&#39;s predict method.</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">        show_progress (bool, optional): Show progress bar while predicting</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">            per target forecaster. Default: False.</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="sd">        pd.DataFrame: DataFrame with predictions for all targets.</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2_safe.forecaster.utils import predict_multivariate</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">        &gt;&gt;&gt; y1 = pd.Series([1, 2, 3, 4, 5])</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">        &gt;&gt;&gt; y2 = pd.Series([2, 4, 6, 8, 10])</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">        &gt;&gt;&gt; f1 = ForecasterRecursive(estimator=LinearRegression(), lags=2)</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">        &gt;&gt;&gt; f2 = ForecasterRecursive(estimator=LinearRegression(), lags=2)</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">        &gt;&gt;&gt; f1.fit(y=y1)</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">        &gt;&gt;&gt; f2.fit(y=y2)</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">        &gt;&gt;&gt; forecasters = {&#39;target1&#39;: f1, &#39;target2&#39;: f2}</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="sd">        &gt;&gt;&gt; predictions = predict_multivariate(forecasters, steps_ahead=2)</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">        &gt;&gt;&gt; predictions</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">           target1  target2</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">        5      6.0     12.0</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        6      7.0     14.0</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">forecasters</span><span class="p">:</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>    <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a>    <span class="n">target_iter</span> <span class="o">=</span> <span class="n">forecasters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a>    <span class="k">if</span> <span class="n">show_progress</span> <span class="ow">and</span> <span class="n">tqdm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>        <span class="n">target_iter</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>            <span class="n">forecasters</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>            <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Predicting targets&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="p">)</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>    <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">forecaster</span> <span class="ow">in</span> <span class="n">target_iter</span><span class="p">:</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="c1"># Generate predictions for this target</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps_ahead</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>            <span class="n">pred</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">steps_ahead</span><span class="p">)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>        <span class="n">predictions</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="c1"># Combine into a single DataFrame</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.prepare_steps_direct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_steps_direct</span><span class="p">(</span><span class="n">max_step</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prepare list of steps to be predicted in Direct Forecasters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>max_step</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int, list, numpy ndarray
Maximum number of future steps the forecaster will predict
when using predict methods.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>int, list, None, default None
Predict n steps. The value of <code>steps</code> must be less than or equal to the
value of steps defined when initializing the forecaster. Starts at 1.</p>
<ul>
<li>If <code>int</code>: Only steps within the range of 1 to int are predicted.</li>
<li>If <code>list</code>: List of ints. Only the steps contained in the list
  are predicted.</li>
<li>If <code>None</code>: As many steps are predicted as were defined at
  initialization.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[int]:
Steps to be predicted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>from spotforecast2_safe.forecaster.utils import prepare_steps_direct
max_step = 5
steps = 3
steps_direct = prepare_steps_direct(max_step, steps)
print(steps_direct)
[1, 2, 3]</p>
<p>max_step = 5
steps = [1, 3, 5]
steps_direct = prepare_steps_direct(max_step, steps)
print(steps_direct)
[1, 3, 5]</p>
<p>max_step = 5
steps = None
steps_direct = prepare_steps_direct(max_step, steps)
print(steps_direct)
[1, 2, 3, 4, 5]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare_steps_direct</span><span class="p">(</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="n">max_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    Prepare list of steps to be predicted in Direct Forecasters.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        max_step: int, list, numpy ndarray</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            Maximum number of future steps the forecaster will predict</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            when using predict methods.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        steps: int, list, None, default None</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            Predict n steps. The value of `steps` must be less than or equal to the</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            value of steps defined when initializing the forecaster. Starts at 1.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            - If `int`: Only steps within the range of 1 to int are predicted.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            - If `list`: List of ints. Only the steps contained in the list</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">              are predicted.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            - If `None`: As many steps are predicted as were defined at</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">              initialization.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        list[int]:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            Steps to be predicted.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        from spotforecast2_safe.forecaster.utils import prepare_steps_direct</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        max_step = 5</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        steps = 3</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        steps_direct = prepare_steps_direct(max_step, steps)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        print(steps_direct)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        [1, 2, 3]</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        max_step = 5</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        steps = [1, 3, 5]</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        steps_direct = prepare_steps_direct(max_step, steps)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        print(steps_direct)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        [1, 3, 5]</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        max_step = 5</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        steps = None</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        steps_direct = prepare_steps_direct(max_step, steps)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        print(steps_direct)</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        [1, 2, 3, 4, 5]</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">steps_direct</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="k">elif</span> <span class="n">steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_step</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>            <span class="n">steps_direct</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="n">steps_direct</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">max_step</span><span class="p">]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="n">steps_direct</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="sa">f</span><span class="s2">&quot;`steps` argument must be an int, a list of ints or `None`. &quot;</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="n">steps_direct</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">step</span><span class="p">))</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="k">return</span> <span class="n">steps_direct</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.select_n_jobs_fit_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_n_jobs_fit_forecaster</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">,</span> <span class="n">estimator</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select the number of jobs to run in parallel during the fit process.</p>
<p>This function determines the optimal number of parallel processes for fitting
the forecaster based on the available system resources. In safety-critical
environments, this helps manage computational load and ensures system
predictability.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the forecaster being fitted. Currently unused but
reserved for granular resource allocation based on model complexity.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estimator</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The estimator object being used by the forecaster. Currently
unused but reserved for checking if the estimator itself supports
internal parallelism.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs (CPUs) to use for parallel processing. Defaults to</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the system CPU count, with a fallback to 1 if the count cannot be</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>determined.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="k">def</span><span class="w"> </span><span class="nf">select_n_jobs_fit_forecaster</span><span class="p">(</span><span class="n">forecaster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">estimator</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Select the number of jobs to run in parallel during the fit process.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    This function determines the optimal number of parallel processes for fitting</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">    the forecaster based on the available system resources. In safety-critical</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    environments, this helps manage computational load and ensures system</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">    predictability.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        forecaster_name: Name of the forecaster being fitted. Currently unused but</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            reserved for granular resource allocation based on model complexity.</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        estimator: The estimator object being used by the forecaster. Currently</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">            unused but reserved for checking if the estimator itself supports</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">            internal parallelism.</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        The number of jobs (CPUs) to use for parallel processing. Defaults to</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        the system CPU count, with a fallback to 1 if the count cannot be</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">        determined.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.set_skforecast_warnings" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Suppress spotforecast warnings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool
If True, spotforecast warnings will be suppressed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>action</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str, default 'ignore'
Action to take regarding the warnings.</p>
              </div>
            </td>
            <td>
                  <code>&#39;ignore&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/exceptions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">    Suppress spotforecast warnings.</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">        suppress_warnings: bool</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a><span class="sd">            If True, spotforecast warnings will be suppressed.</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a><span class="sd">        action: str, default &#39;ignore&#39;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a><span class="sd">            Action to take regarding the warnings.</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="k">if</span> <span class="n">suppress_warnings</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">warn_skforecast_categories</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.transform_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transform raw values of pandas DataFrame with a scikit-learn alike
transformer, preprocessor or ColumnTransformer.</p>
<p>The transformer used must have the following methods: fit, transform,
fit_transform and inverse_transform. ColumnTransformers are not allowed
since they do not have inverse_transform method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to be transformed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn alike transformer, preprocessor, or ColumnTransformer.
Must implement fit, transform, fit_transform and inverse_transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Train the transformer before applying it. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inverse_transform</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transform back the data to the original representation.
This is not available when using transformers of class
scikit-learn ColumnTransformers. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformed DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If df is not a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inverse_transform is requested for ColumnTransformer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/utils/data_transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform_dataframe</span><span class="p">(</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">transformer</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Transform raw values of pandas DataFrame with a scikit-learn alike</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    transformer, preprocessor or ColumnTransformer.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    The transformer used must have the following methods: fit, transform,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    fit_transform and inverse_transform. ColumnTransformers are not allowed</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    since they do not have inverse_transform method.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        df: DataFrame to be transformed.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        transformer: Scikit-learn alike transformer, preprocessor, or ColumnTransformer.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            Must implement fit, transform, fit_transform and inverse_transform.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        fit: Train the transformer before applying it. Defaults to False.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        inverse_transform: Transform back the data to the original representation.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            This is not available when using transformers of class</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            scikit-learn ColumnTransformers. Defaults to False.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        Transformed DataFrame.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        TypeError: If df is not a pandas DataFrame.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        ValueError: If inverse_transform is requested for ColumnTransformer.</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`df` argument must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">return</span> <span class="n">df</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="c1"># Check for ColumnTransformer by class name to avoid importing sklearn</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">is_column_transformer</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">transformer</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;ColumnTransformer&quot;</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="s2">&quot;transformers&quot;</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">if</span> <span class="n">inverse_transform</span> <span class="ow">and</span> <span class="n">is_column_transformer</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="s2">&quot;`inverse_transform` is not available when using ColumnTransformers.&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">inverse_transform</span><span class="p">:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="s2">&quot;toarray&quot;</span><span class="p">):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">values_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_transformed</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">df_transformed</span> <span class="o">=</span> <span class="n">values_transformed</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">df_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="n">values_transformed</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">return</span> <span class="n">df_transformed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.forecaster.utils.transform_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform_numpy</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">transformer</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inverse_transform</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Transform raw values of a numpy ndarray with a scikit-learn alike
transformer, preprocessor or ColumnTransformer. The transformer used must
have the following methods: fit, transform, fit_transform and
inverse_transform. ColumnTransformers are not allowed since they do not
have inverse_transform method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy ndarray
Array to be transformed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transformer</code>
            </td>
            <td>
                  <code><span title="object">object</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>scikit-learn alike transformer, preprocessor, or ColumnTransformer.
Scikit-learn alike transformer (preprocessor) with methods: fit, transform,
fit_transform and inverse_transform.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>fit: bool, default False
    Train the transformer before applying it.
inverse_transform: bool, default False
    Transform back the data to the original representation. This is not available
    when using transformers of class scikit-learn ColumnTransformers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy ndarray: Transformed array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>array</code> is not a numpy ndarray.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>transformer</code> is not a scikit-learn alike transformer, preprocessor, or ColumnTransformer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>inverse_transform</code> is True and <code>transformer</code> is a ColumnTransformer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>ffrom spotforecast2_safe.forecaster.utils import transform_numpy
from sklearn.preprocessing import StandardScaler
import numpy as np
array = np.array([[1, 2], [3, 4], [5, 6]])
transformer = StandardScaler()
array_transformed = transform_numpy(array, transformer, fit=True)
print(array_transformed)
[[-1.22474487 -1.22474487]
 [ 0.          0.        ]
 [ 1.22474487  1.22474487]]
 array_inversed = transform_numpy(array_transformed, transformer, inverse_transform=True)
 print(array_inversed)
 [[1. 2.]
  [3. 4.]
  [5. 6.]]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/forecaster/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="k">def</span><span class="w"> </span><span class="nf">transform_numpy</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">transformer</span><span class="p">:</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">fit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">inverse_transform</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    Transform raw values of a numpy ndarray with a scikit-learn alike</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    transformer, preprocessor or ColumnTransformer. The transformer used must</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">    have the following methods: fit, transform, fit_transform and</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    inverse_transform. ColumnTransformers are not allowed since they do not</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    have inverse_transform method.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        array: numpy ndarray</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">            Array to be transformed.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        transformer: scikit-learn alike transformer, preprocessor, or ColumnTransformer.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            Scikit-learn alike transformer (preprocessor) with methods: fit, transform,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            fit_transform and inverse_transform.</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    fit: bool, default False</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Train the transformer before applying it.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    inverse_transform: bool, default False</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        Transform back the data to the original representation. This is not available</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        when using transformers of class scikit-learn ColumnTransformers.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        numpy ndarray: Transformed array.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        TypeError: If `array` is not a numpy ndarray.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        TypeError: If `transformer` is not a scikit-learn alike transformer, preprocessor, or ColumnTransformer.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        ValueError: If `inverse_transform` is True and `transformer` is a ColumnTransformer.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        ffrom spotforecast2_safe.forecaster.utils import transform_numpy</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        from sklearn.preprocessing import StandardScaler</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        import numpy as np</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">        array = np.array([[1, 2], [3, 4], [5, 6]])</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        transformer = StandardScaler()</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">        array_transformed = transform_numpy(array, transformer, fit=True)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        print(array_transformed)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        [[-1.22474487 -1.22474487]</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">         [ 0.          0.        ]</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">         [ 1.22474487  1.22474487]]</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">         array_inversed = transform_numpy(array_transformed, transformer, inverse_transform=True)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">         print(array_inversed)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">         [[1. 2.]</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">          [3. 4.]</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">          [5. 6.]]</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="k">if</span> <span class="n">transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="k">return</span> <span class="n">array</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`array` argument must be a numpy ndarray. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="n">original_ndim</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="n">original_shape</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="n">reshaped_for_inverse</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="k">if</span> <span class="n">original_ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="k">if</span> <span class="n">inverse_transform</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transformer</span><span class="p">,</span> <span class="n">ColumnTransformer</span><span class="p">):</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>            <span class="s2">&quot;`inverse_transform` is not available when using ColumnTransformers.&quot;</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inverse_transform</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="k">if</span> <span class="n">fit</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="c1"># Vectorized inverse transformation for 2D arrays with multiple columns.</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="c1"># Reshape to single column, transform, and reshape back.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="c1"># This is faster than applying the transformer column by column.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                <span class="n">reshaped_for_inverse</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">array_transformed</span><span class="p">,</span> <span class="s2">&quot;toarray&quot;</span><span class="p">):</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="c1"># If the returned values are in sparse matrix format, it is converted to dense</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">array_transformed</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array_transformed</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">array_transformed</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="c1"># Reshape back to original shape only if we reshaped for inverse_transform</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="k">if</span> <span class="n">reshaped_for_inverse</span><span class="p">:</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">array_transformed</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">original_shape</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="k">if</span> <span class="n">original_ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">array_transformed</span> <span class="o">=</span> <span class="n">array_transformed</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="k">return</span> <span class="n">array_transformed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../processing/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Processing">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Processing
              </div>
            </div>
          </a>
        
        
          
          <a href="../utils/" class="md-footer__link md-footer__link--next" aria-label="Next: Utils">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Utils
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024-2026 bartzbeielstein
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/sequential-parameter-optimization/spotforecast2-safe" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "content.code.copy", "content.code.annotate", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>