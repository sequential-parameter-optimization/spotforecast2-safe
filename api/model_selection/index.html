
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Safe forecasting with spot">
      
      
        <meta name="author" content="bartzbeielstein">
      
      
        <link rel="canonical" href="https://sequential-parameter-optimization.github.io/spotforecast2-safe/api/model_selection/">
      
      
        <link rel="prev" href="../forecaster/">
      
      
        <link rel="next" href="../stats/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Model Selection - spotforecast2-safe</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-selection-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="spotforecast2-safe" class="md-header__button md-logo" aria-label="spotforecast2-safe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotforecast2-safe
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model Selection
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotforecast2-safe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    spotforecast2-safe
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../data/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../processing/model_persistence/" class="md-tabs__link">
          
  
  
  Processing Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../preprocessing/outliers/" class="md-tabs__link">
          
  
  
  Preprocessing Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="spotforecast2-safe" class="md-nav__button md-logo" aria-label="spotforecast2-safe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    spotforecast2-safe
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotforecast2-safe" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    spotforecast2-safe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../forecaster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Forecaster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Model Selection
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Selection
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_selection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model_selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeSeriesFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        backtesting_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bayesian Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.bayesian_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bayesian_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.bayesian_search.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grid-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grid Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grid Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grid_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.grid_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grid_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.grid_search.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#random-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Random Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Random Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.random_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="random_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.random_search.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-validation-splitting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Validation Splitting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Validation Splitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#split_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_base
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base.BaseFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base.BaseFold.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_one_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_one_step
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_one_step
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_one_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_ts_cv" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_ts_cv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_ts_cv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_ts_cv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeSeriesFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilities-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utilities and Metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilities and Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils_common" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_common
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_common
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils_common">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.OneStepAheadValidationWarning" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadValidationWarning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_backtesting_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.check_one_step_ahead_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_one_step_ahead_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_lags_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      
        select_n_jobs_backtesting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.validation.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        backtesting_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../weather/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weather
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Processing Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Processing Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processing/model_persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Preprocessing Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Preprocessing Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/outliers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Outlier Detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/time_series_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Series Visualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_selection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model_selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeSeriesFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        backtesting_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bayesian-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bayesian Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bayesian Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bayesian_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.bayesian_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bayesian_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.bayesian_search.bayesian_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        bayesian_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grid-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grid Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grid Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grid_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.grid_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grid_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.grid_search.grid_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        grid_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#random-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Random Search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Random Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#random_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.random_search" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="random_search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.random_search.random_search_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        random_search_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-validation-splitting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Validation Splitting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cross-Validation Splitting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#split_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_base
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_base
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base.BaseFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_base.BaseFold.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_params
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_one_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_one_step
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_one_step
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_one_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OneStepAheadFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split_ts_cv" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_ts_cv
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv" class="md-nav__link">
    <span class="md-ellipsis">
      
        split_ts_cv
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="split_ts_cv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold" class="md-nav__link">
    <span class="md-ellipsis">
      
        TimeSeriesFold
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeSeriesFold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __repr__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.split" class="md-nav__link">
    <span class="md-ellipsis">
      
        split
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilities-and-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Utilities and Metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilities and Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils_common" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_common
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_common
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils_common">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.OneStepAheadValidationWarning" class="md-nav__link">
    <span class="md-ellipsis">
      
        OneStepAheadValidationWarning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.check_backtesting_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_backtesting_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.check_one_step_ahead_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_one_step_ahead_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.initialize_lags_grid" class="md-nav__link">
    <span class="md-ellipsis">
      
        initialize_lags_grid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_common.select_n_jobs_backtesting" class="md-nav__link">
    <span class="md-ellipsis">
      
        select_n_jobs_backtesting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.utils_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils_metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils_metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        validation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spotforecast2_safe.model_selection.validation.backtesting_forecaster" class="md-nav__link">
    <span class="md-ellipsis">
      
        backtesting_forecaster
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="model-selection-module">Model Selection Module</h1>
<p>Hyperparameter tuning and model selection using Bayesian, grid, and random search.</p>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.OneStepAheadFold" class="doc doc-heading">
            <code>OneStepAheadFold</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFold (spotforecast2_safe.model_selection.split_base.BaseFold)" href="#spotforecast2_safe.model_selection.split_base.BaseFold">BaseFold</a></code></p>



        <p>Class to split time series data into train and test folds for one-step-ahead
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used
for initial training.</p>
<ul>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in
  the initial training set.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the
start and end indexes of each fold. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.OneStepAheadFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.OneStepAheadFold.window_size">window_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.OneStepAheadFold.differentiation">differentiation</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.OneStepAheadFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start
and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.OneStepAheadFold.verbose">verbose</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">OneStepAheadFold</span><span class="p">(</span><span class="n">BaseFold</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Class to split time series data into train and test folds for one-step-ahead</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    forecasting.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        initial_train_size (int | str | pd.Timestamp): Number of observations used</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            for initial training.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            - If an integer, the number of observations used for initial training.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            - If a date string or pandas Timestamp, it is the last date included in</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">              the initial training set.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        window_size (int, optional): Number of observations needed to generate the</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            autoregressive predictors. Defaults to None.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        differentiation (int, optional): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            differentiation order. Defaults to None.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        return_all_indexes (bool, optional): Whether to return all indexes or only the</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            start and end indexes of each fold. Defaults to False.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        verbose (bool, optional): Whether to print information about generated folds.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        initial_train_size (int): Number of observations used for initial training.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        window_size (int): Number of observations needed to generate the</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            autoregressive predictors.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        differentiation (int): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            differentiation order.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        return_all_indexes (bool): Whether to return all indexes or only the start</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            and end indexes of each fold.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        verbose (bool): Whether to print information about generated folds.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">initial_train_size</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="n">differentiation</span><span class="o">=</span><span class="n">differentiation</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">return_all_indexes</span><span class="o">=</span><span class="n">return_all_indexes</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        Information displayed when printed.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="sa">f</span><span class="s2">&quot;Initial train size = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="sa">f</span><span class="s2">&quot;Window size        = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="sa">f</span><span class="s2">&quot;Return all indexes = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="sa">f</span><span class="s2">&quot;Verbose            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        HTML representation of the object.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        Split the time series data into train and test folds.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            X (pd.Series | pd.DataFrame | pd.Index | dict): Time series data or index to split.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            as_pandas (bool, optional): If True, the folds are returned as a DataFrame.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                This is useful to visualize the folds in a more interpretable way.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                Defaults to False.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            externally_fitted (Any, optional): This argument is not used in this class.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                It is included for API consistency. Defaults to None.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            list | pd.DataFrame: A list of lists containing the indices (position) of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            the fold. The list contains 2 lists with the following information:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            - fold: fold number.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            - [train_start, train_end]: list with the start and end positions of the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                training set.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            - [test_start, test_end]: list with the start and end positions of the test</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                in this fold.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            It is important to note that the returned values are the positions of the</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            observations and not the actual values of the index, so they can be used to</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            slice the data directly using iloc.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            &#39;test_end&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            slice.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="p">]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="p">]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                        <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                        <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                        <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                        <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="p">],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fold</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fold&quot;</span><span class="p">,</span> <span class="s2">&quot;train_index&quot;</span><span class="p">,</span> <span class="s2">&quot;test_index&quot;</span><span class="p">,</span> <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">return</span> <span class="n">fold</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">fold</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        Print information about folds.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            index (pd.Index): Index of the time series data.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            fold (list): A list of lists containing the indices (position) of the fold.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="n">differentiation</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">test_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of observations in train: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training set &quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of observations in test: </span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">training_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">test_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">test_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training : </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test     : </span><span class="si">{</span><span class="n">test_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">test_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.OneStepAheadFold.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when printed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Information displayed when printed.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="sa">f</span><span class="s2">&quot;Initial train size = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="sa">f</span><span class="s2">&quot;Window size        = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="sa">f</span><span class="s2">&quot;Return all indexes = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="sa">f</span><span class="s2">&quot;Verbose            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.OneStepAheadFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">externally_fitted</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="pandas.Index">Index</span> | <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame.
This is useful to visualize the folds in a more interpretable way.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>externally_fitted</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This argument is not used in this class.
It is included for API consistency. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list | pd.DataFrame: A list of lists containing the indices (position) of</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the fold. The list contains 2 lists with the following information:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>fold: fold number.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>fit_forecaster: boolean indicating whether the forecaster should be fitted
in this fold.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>It is important to note that the returned values are the positions of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>observations and not the actual values of the index, so they can be used to</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>slice the data directly using iloc.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>following columns: 'fold', 'train_start', 'train_end', 'test_start',</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'test_end', 'fit_forecaster'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Following the python convention, the start index is inclusive and the end</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index is exclusive. This means that the last index is not included in the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Split the time series data into train and test folds.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        X (pd.Series | pd.DataFrame | pd.Index | dict): Time series data or index to split.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        as_pandas (bool, optional): If True, the folds are returned as a DataFrame.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            This is useful to visualize the folds in a more interpretable way.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        externally_fitted (Any, optional): This argument is not used in this class.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            It is included for API consistency. Defaults to None.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        list | pd.DataFrame: A list of lists containing the indices (position) of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        the fold. The list contains 2 lists with the following information:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        - fold: fold number.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            training set.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            in this fold.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        It is important to note that the returned values are the positions of the</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        slice the data directly using iloc.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &#39;test_end&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        slice.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="p">]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="p">]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                    <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                    <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                    <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="p">],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fold</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fold&quot;</span><span class="p">,</span> <span class="s2">&quot;train_index&quot;</span><span class="p">,</span> <span class="s2">&quot;test_index&quot;</span><span class="p">,</span> <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">return</span> <span class="n">fold</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.TimeSeriesFold" class="doc doc-heading">
            <code>TimeSeriesFold</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFold (spotforecast2_safe.model_selection.split_base.BaseFold)" href="#spotforecast2_safe.model_selection.split_base.BaseFold">BaseFold</a></code></p>



        <p>Class to split time series data into train and test folds.</p>
<p>When used within a backtesting or hyperparameter search, the arguments
'initial_train_size', 'window_size' and 'differentiation' are not required
as they are automatically set by the backtesting or hyperparameter search
functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold.
This is also commonly referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
<ul>
<li>If <code>None</code> or 0, the initial forecaster is not trained in the first fold.</li>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in
  the initial training set.</li>
</ul>
<p>Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fold_stride</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations that the start of the test set
advances between consecutive folds.</p>
<ul>
<li>If <code>None</code>, it defaults to the same value as <code>steps</code>, meaning that folds
  are placed back-to-back without overlap.</li>
<li>If <code>fold_stride &lt; steps</code>, test sets overlap and multiple forecasts will
  be generated for the same observations.</li>
<li>If <code>fold_stride &gt; steps</code>, gaps are left between consecutive test sets.</li>
</ul>
<p>Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
<p>Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed_train_size</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases
in each fold. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set
and the start of the test set. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_folds</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_incomplete_fold</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include
fewer observations than <code>steps</code>. If <code>False</code>, the last fold is excluded if it
is incomplete. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the
start and end indexes of each fold. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.steps">steps</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.initial_train_size">initial_train_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.
If <code>None</code> or 0, the initial forecaster is not trained in the first fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.fold_stride">fold_stride</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations that the start of the test set
advances between consecutive folds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.overlapping_folds">overlapping_folds</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the folds overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.window_size">window_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.differentiation">differentiation</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.refit">refit</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.fixed_train_size">fixed_train_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.gap">gap</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the
start of the test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.skip_folds">skip_folds</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.allow_incomplete_fold">allow_incomplete_fold</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer
observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start
and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.TimeSeriesFold.verbose">verbose</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage with fixed train size:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample time series data</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create fold splitter</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get folds</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">Number of folds: 4</span>
</code></pre></div>
    <p>Overlapping folds with custom stride:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">fold_stride</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First test fold covers [50, 80), second [57, 87), etc.</span>
</code></pre></div>
    <p>Return as pandas DataFrame:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds_df</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">folds_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[&#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;, &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;, &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;]</span>
</code></pre></div>
    <p>Skip folds for faster evaluation:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">skip_folds</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Returns folds 0, 2, 4, 6, ...</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Returned values are the positions of the observations and not the actual values of
the index, so they can be used to slice the data directly using iloc. For example,
if the input series is <code>X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</code>, the
<code>initial_train_size = 3</code>, <code>window_size = 2</code>, <code>steps = 4</code>, and <code>gap = 1</code>,
the output of the first fold will: [0, [0, 3], [1, 3], [3, 8], [4, 8], True].</p>
<p>The first element is the fold number, the first list <code>[0, 3]</code> indicates that
the training set goes from the first to the third observation. The second
list <code>[1, 3]</code> indicates that the last window seen by the forecaster during
training goes from the second to the third observation. The third list <code>[3, 8]</code>
indicates that the test set goes from the fourth to the eighth observation.
The fourth list <code>[4, 8]</code> indicates that the test set including the gap goes
from the fifth to the eighth observation. The boolean <code>False</code> indicates that
the forecaster should not be trained in this fold.</p>
<p>Following the python convention, the start index is inclusive and the end index is
exclusive. This means that the last index is not included in the slice.</p>
<p>As an example, with <code>initial_train_size=50</code>, <code>steps=30</code>, and <code>fold_stride=7</code>,
the first test fold will cover observations [50, 80), the second fold [57, 87),
and the third fold [64, 94). This configuration produces multiple forecasts
for the same observations, which is often desirable in rolling-origin
evaluation.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesFold</span><span class="p">(</span><span class="n">BaseFold</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to split time series data into train and test folds.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    When used within a backtesting or hyperparameter search, the arguments</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    &#39;initial_train_size&#39;, &#39;window_size&#39; and &#39;differentiation&#39; are not required</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    as they are automatically set by the backtesting or hyperparameter search</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    functions.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        steps: Number of observations used to be predicted in each fold.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            This is also commonly referred to as the forecast horizon or test size.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        initial_train_size: Number of observations used for initial training.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            - If `None` or 0, the initial forecaster is not trained in the first fold.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            - If an integer, the number of observations used for initial training.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            - If a date string or pandas Timestamp, it is the last date included in</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">              the initial training set.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        fold_stride: Number of observations that the start of the test set</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            advances between consecutive folds.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            - If `None`, it defaults to the same value as `steps`, meaning that folds</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">              are placed back-to-back without overlap.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            - If `fold_stride &lt; steps`, test sets overlap and multiple forecasts will</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">              be generated for the same observations.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            - If `fold_stride &gt; steps`, gaps are left between consecutive test sets.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        window_size: Number of observations needed to generate the</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            autoregressive predictors. Defaults to None.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        differentiation: Number of observations to use for differentiation.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            differentiation order. Defaults to None.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        refit: Whether to refit the forecaster in each fold.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            - If `True`, the forecaster is refitted in each fold.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            - If `False`, the forecaster is trained only in the first fold.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            - If an integer, the forecaster is trained in the first fold and then refitted</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">              every `refit` folds.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        fixed_train_size: Whether the training size is fixed or increases</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            in each fold. Defaults to True.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        gap: Number of observations between the end of the training set</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            and the start of the test set. Defaults to 0.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        skip_folds: Number of folds to skip.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            - If an integer, every &#39;skip_folds&#39;-th is returned.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            - If a list, the indexes of the folds to skip.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            For example, if `skip_folds=3` and there are 10 folds, the returned folds are</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            0, 3, 6, and 9. If `skip_folds=[1, 2, 3]`, the returned folds are 0, 4, 5, 6, 7,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            8, and 9. Defaults to None.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        allow_incomplete_fold: Whether to allow the last fold to include</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            fewer observations than `steps`. If `False`, the last fold is excluded if it</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            is incomplete. Defaults to True.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        return_all_indexes: Whether to return all indexes or only the</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            start and end indexes of each fold. Defaults to False.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        verbose: Whether to print information about generated folds.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        steps: Number of observations used to be predicted in each fold.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        initial_train_size: Number of observations used for initial training.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            If `None` or 0, the initial forecaster is not trained in the first fold.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        fold_stride: Number of observations that the start of the test set</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            advances between consecutive folds.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        overlapping_folds: Whether the folds overlap.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        window_size: Number of observations needed to generate the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            autoregressive predictors.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        differentiation: Number of observations to use for differentiation.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            differentiation order.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        refit: Whether to refit the forecaster in each fold.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        fixed_train_size: Whether the training size is fixed or increases in each fold.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        gap: Number of observations between the end of the training set and the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            start of the test set.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        skip_folds: Number of folds to skip.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        allow_incomplete_fold: Whether to allow the last fold to include fewer</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            observations than `steps`.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        return_all_indexes: Whether to return all indexes or only the start</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            and end indexes of each fold.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        verbose: Whether to print information about generated folds.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Basic usage with fixed train size:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import TimeSeriesFold</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &gt;&gt;&gt; # Create sample time series data</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        &gt;&gt;&gt; dates = pd.date_range(&#39;2020-01-01&#39;, periods=100, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(100), index=dates)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        &gt;&gt;&gt; # Create fold splitter</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ...     steps=10,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ...     refit=True,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        ...     fixed_train_size=True</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt; # Get folds</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Number of folds: {len(folds)}&quot;)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Number of folds: 4</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        Overlapping folds with custom stride:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        ...     steps=30,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ...     fold_stride=7,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        ...     fixed_train_size=False</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; # First test fold covers [50, 80), second [57, 87), etc.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Return as pandas DataFrame:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(steps=10, initial_train_size=50)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        &gt;&gt;&gt; folds_df = cv.split(y, as_pandas=True)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &gt;&gt;&gt; print(folds_df.columns.tolist())</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        [&#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;, &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;, &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Skip folds for faster evaluation:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        ...     steps=5,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        ...     skip_folds=2</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; # Returns folds 0, 2, 4, 6, ...</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Returned values are the positions of the observations and not the actual values of</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        the index, so they can be used to slice the data directly using iloc. For example,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        if the input series is `X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]`, the</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        `initial_train_size = 3`, `window_size = 2`, `steps = 4`, and `gap = 1`,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        the output of the first fold will: [0, [0, 3], [1, 3], [3, 8], [4, 8], True].</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        The first element is the fold number, the first list `[0, 3]` indicates that</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        the training set goes from the first to the third observation. The second</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        list `[1, 3]` indicates that the last window seen by the forecaster during</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        training goes from the second to the third observation. The third list `[3, 8]`</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        indicates that the test set goes from the fourth to the eighth observation.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        The fourth list `[4, 8]` indicates that the test set including the gap goes</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        from the fifth to the eighth observation. The boolean `False` indicates that</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        the forecaster should not be trained in this fold.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Following the python convention, the start index is inclusive and the end index is</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        exclusive. This means that the last index is not included in the slice.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        As an example, with `initial_train_size=50`, `steps=30`, and `fold_stride=7`,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        the first test fold will cover observations [50, 80), the second fold [57, 87),</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        and the third fold [64, 94). This configuration produces multiple forecasts</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        for the same observations, which is often desirable in rolling-origin</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        evaluation.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">fold_stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">initial_train_size</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">fold_stride</span><span class="o">=</span><span class="n">fold_stride</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">differentiation</span><span class="o">=</span><span class="n">differentiation</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">refit</span><span class="o">=</span><span class="n">refit</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">fixed_train_size</span><span class="o">=</span><span class="n">fixed_train_size</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">gap</span><span class="o">=</span><span class="n">gap</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">skip_folds</span><span class="o">=</span><span class="n">skip_folds</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="n">allow_incomplete_fold</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">return_all_indexes</span><span class="o">=</span><span class="n">return_all_indexes</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span> <span class="o">=</span> <span class="n">fold_stride</span> <span class="k">if</span> <span class="n">fold_stride</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">steps</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="n">refit</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="o">=</span> <span class="n">fixed_train_size</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">=</span> <span class="n">gap</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">=</span> <span class="n">skip_folds</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Information displayed when printed.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            String representation of the TimeSeriesFold object.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="sa">f</span><span class="s2">&quot;Initial train size    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="sa">f</span><span class="s2">&quot;Steps                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="sa">f</span><span class="s2">&quot;Fold stride           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="sa">f</span><span class="s2">&quot;Overlapping folds     = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="sa">f</span><span class="s2">&quot;Window size           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation       = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="sa">f</span><span class="s2">&quot;Refit                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="sa">f</span><span class="s2">&quot;Fixed train size      = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="sa">f</span><span class="s2">&quot;Gap                   = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="sa">f</span><span class="s2">&quot;Skip folds            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="sa">f</span><span class="s2">&quot;Allow incomplete fold = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="sa">f</span><span class="s2">&quot;Return all indexes    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="sa">f</span><span class="s2">&quot;Verbose               = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;HTML representation of the object.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            HTML string representation for Jupyter notebooks.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Fold stride:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Overlapping folds:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Refit:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Fixed train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Skip folds:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Allow incomplete fold:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Split the time series data into train and test folds.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            X: Time series data or index to split. Can be a pandas Series, DataFrame,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">                Index, or a dictionary of Series/DataFrames.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            as_pandas: If True, the folds are returned as a DataFrame. This is useful</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                to visualize the folds in a more interpretable way. Defaults to False.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            A list of lists containing the indices (position) for each fold, or a</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            DataFrame if `as_pandas=True`. Each list contains 4 lists and a boolean</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            with the following information:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            - **fold**: fold number.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            - **[train_start, train_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                    the training set.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            - **[last_window_start, last_window_end]**: list with the start and end</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                    positions of the last window seen by the forecaster during training.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                    The last window is used to generate the lags use as predictors. If</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">                    `differentiation` is included, the interval is extended as many</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                    observations as the differentiation order. If the argument `window_size`</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                    is `None`, this list is empty.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            - **[test_start, test_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                    the test set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            - **[test_start_with_gap, test_end_with_gap]**: list with the start and</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">                    end positions of the test set including the gap. The gap is the number</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                    of observations between the end of the training set and the start of</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">                    the test set.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            - **fit_forecaster**: boolean indicating whether the forecaster should be</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                    fitted in this fold.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            The returned values are the positions of the observations and not the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            actual values of the index, so they can be used to slice the data directly</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            using iloc.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            slice.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">window_size_as_date_offset</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="c1"># because the offset follows the calendar rules and the distance between</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="c1"># two dates may not be constant.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                    <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                    <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="sa">f</span><span class="s2">&quot;the offset (forecaster.offset) is larger than the available &quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                    <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (forecaster.offset), &quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (forecaster.n_offsets) or increase the &quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                    <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                    <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                    <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                    <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                <span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                    <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                        <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                        <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>                        <span class="sa">f</span><span class="s2">&quot;and smaller than the length of the series (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                        <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                    <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="c1"># At least one observation after the gap to allow incomplete fold</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                    <span class="sa">f</span><span class="s2">&quot;The time series must have more than `initial_train_size + gap` &quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create at least one fold.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="c1"># At least one complete fold</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                    <span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + gap + steps` &quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create a minimum of one complete fold &quot;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="sa">f</span><span class="s2">&quot;(allow_incomplete_fold=False).</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt;= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="sa">f</span><span class="s2">&quot;    steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                <span class="c1"># NOTE: If `fixed_train_size` the train size doesn&#39;t increase but</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                <span class="c1"># moves by `fold_stride` positions in each iteration. If `False`,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="c1"># the train size increases by `fold_stride` in each iteration.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                <span class="c1"># NOTE: The train size doesn&#39;t increase and doesn&#39;t move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span><span class="p">:</span><span class="n">train_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                    <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span><span class="p">:</span><span class="n">test_iloc_start</span><span class="p">]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                    <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="p">),</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span><span class="p">:</span><span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="c1"># NOTE: Delete all incomplete folds at the end if not allowed</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">n_removed_folds</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="c1"># NOTE: While folds and the last &quot;test_index_with_gap&quot; is incomplete,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="c1"># calculating len of range objects</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">while</span> <span class="n">folds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="n">folds</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="n">n_removed_folds</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="c1"># Create a flag to know whether to train the forecaster</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="n">folds</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="n">externally_fitted</span><span class="o">=</span><span class="n">externally_fitted</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="n">n_removed_folds</span><span class="o">=</span><span class="n">n_removed_folds</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="n">index_to_skip</span><span class="o">=</span><span class="n">index_to_skip</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="p">[</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                    <span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                        <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                        <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                    <span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                <span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="p">]</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                        <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                        <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                    <span class="p">],</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                        <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                        <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                        <span class="s2">&quot;last_window_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                        <span class="s2">&quot;last_window_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                        <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                        <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                        <span class="s2">&quot;test_start_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                        <span class="s2">&quot;test_end_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                    <span class="p">],</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>                <span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                        <span class="s2">&quot;train_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                        <span class="s2">&quot;last_window_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                        <span class="s2">&quot;test_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                        <span class="s2">&quot;test_index_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                    <span class="p">],</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>                <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="k">return</span> <span class="n">folds</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">folds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">externally_fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">n_removed_folds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">index_to_skip</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print information about folds.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            index: Index of the time series data.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">            folds: A list of lists containing the indices (position) for each fold.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            externally_fitted: Whether an already trained forecaster is to be used.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            n_removed_folds: Number of folds removed.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            index_to_skip: Number of folds skipped.</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="sa">f</span><span class="s2">&quot;An already trained forecaster is to be used. Window size: &quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                    <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training sets &quot;</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                    <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="sa">f</span><span class="s2">&quot;Number of observations used for backtesting: &quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="sa">f</span><span class="s2">&quot;    Number skipped folds: &quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index_to_skip</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of steps per fold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="sa">f</span><span class="s2">&quot;    Number of steps to the next fold (fold stride): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="sa">f</span><span class="s2">&quot;    Number of steps to exclude between last observed data &quot;</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="sa">f</span><span class="s2">&quot;(last window) and predictions (gap): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="p">)</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="k">if</span> <span class="n">n_removed_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="sa">f</span><span class="s2">&quot;    The last </span><span class="si">{</span><span class="n">n_removed_folds</span><span class="si">}</span><span class="s2"> fold(s) have been excluded &quot;</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                <span class="sa">f</span><span class="s2">&quot;because they were incomplete.&quot;</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Last fold only includes </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">}</span><span class="s2"> observations.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">):</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>            <span class="n">is_fold_skipped</span> <span class="o">=</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">has_training</span> <span class="o">=</span> <span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="n">training_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="n">training_length</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>                <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">differentiation</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="n">validation_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="n">validation_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="n">validation_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="k">if</span> <span class="n">is_fold_skipped</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Fold skipped&quot;</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">externally_fitted</span> <span class="ow">and</span> <span class="n">has_training</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                    <span class="sa">f</span><span class="s2">&quot;    Training:   </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">training_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                    <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Training:   No training in this fold&quot;</span><span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                    <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.TimeSeriesFold.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when printed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of the TimeSeriesFold object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Information displayed when printed.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        String representation of the TimeSeriesFold object.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="sa">f</span><span class="s2">&quot;Initial train size    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="sa">f</span><span class="s2">&quot;Steps                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="sa">f</span><span class="s2">&quot;Fold stride           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="sa">f</span><span class="s2">&quot;Overlapping folds     = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="sa">f</span><span class="s2">&quot;Window size           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation       = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="sa">f</span><span class="s2">&quot;Refit                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="sa">f</span><span class="s2">&quot;Fixed train size      = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="sa">f</span><span class="s2">&quot;Gap                   = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="sa">f</span><span class="s2">&quot;Skip folds            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="sa">f</span><span class="s2">&quot;Allow incomplete fold = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="sa">f</span><span class="s2">&quot;Return all indexes    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="sa">f</span><span class="s2">&quot;Verbose               = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.TimeSeriesFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="pandas.Index">Index</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split. Can be a pandas Series, DataFrame,
Index, or a dictionary of Series/DataFrames.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful
to visualize the folds in a more interpretable way. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for each fold, or a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame if <code>as_pandas=True</code>. Each list contains 4 lists and a boolean</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with the following information:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>fold</strong>: fold number.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[train_start, train_end]</strong>: list with the start and end positions of
    the training set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[last_window_start, last_window_end]</strong>: list with the start and end
    positions of the last window seen by the forecaster during training.
    The last window is used to generate the lags use as predictors. If
    <code>differentiation</code> is included, the interval is extended as many
    observations as the differentiation order. If the argument <code>window_size</code>
    is <code>None</code>, this list is empty.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[test_start, test_end]</strong>: list with the start and end positions of
    the test set. These are the observations used to evaluate the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[test_start_with_gap, test_end_with_gap]</strong>: list with the start and
    end positions of the test set including the gap. The gap is the number
    of observations between the end of the training set and the start of
    the test set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>fit_forecaster</strong>: boolean indicating whether the forecaster should be
    fitted in this fold.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The returned values are the positions of the observations and not the
actual values of the index, so they can be used to slice the data directly
using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'last_window_start',
'last_window_end', 'test_start', 'test_end', 'test_start_with_gap',
'test_end_with_gap', 'fit_forecaster'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Split the time series data into train and test folds.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        X: Time series data or index to split. Can be a pandas Series, DataFrame,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            Index, or a dictionary of Series/DataFrames.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        as_pandas: If True, the folds are returned as a DataFrame. This is useful</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            to visualize the folds in a more interpretable way. Defaults to False.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        A list of lists containing the indices (position) for each fold, or a</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        DataFrame if `as_pandas=True`. Each list contains 4 lists and a boolean</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        with the following information:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        - **fold**: fold number.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        - **[train_start, train_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                the training set.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        - **[last_window_start, last_window_end]**: list with the start and end</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                positions of the last window seen by the forecaster during training.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                The last window is used to generate the lags use as predictors. If</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">                `differentiation` is included, the interval is extended as many</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                observations as the differentiation order. If the argument `window_size`</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                is `None`, this list is empty.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        - **[test_start, test_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                the test set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        - **[test_start_with_gap, test_end_with_gap]**: list with the start and</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">                end positions of the test set including the gap. The gap is the number</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                of observations between the end of the training set and the start of</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">                the test set.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        - **fit_forecaster**: boolean indicating whether the forecaster should be</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                fitted in this fold.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        The returned values are the positions of the observations and not the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        actual values of the index, so they can be used to slice the data directly</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        using iloc.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        slice.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">window_size_as_date_offset</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="c1"># because the offset follows the calendar rules and the distance between</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="c1"># two dates may not be constant.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="sa">f</span><span class="s2">&quot;the offset (forecaster.offset) is larger than the available &quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (forecaster.offset), &quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (forecaster.n_offsets) or increase the &quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                    <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                    <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>                    <span class="sa">f</span><span class="s2">&quot;and smaller than the length of the series (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                    <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="c1"># At least one observation after the gap to allow incomplete fold</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="sa">f</span><span class="s2">&quot;The time series must have more than `initial_train_size + gap` &quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="sa">f</span><span class="s2">&quot;observations to create at least one fold.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="sa">f</span><span class="s2">&quot;    Required &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="c1"># At least one complete fold</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + gap + steps` &quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="sa">f</span><span class="s2">&quot;observations to create a minimum of one complete fold &quot;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="sa">f</span><span class="s2">&quot;(allow_incomplete_fold=False).</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="sa">f</span><span class="s2">&quot;    Required &gt;= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                <span class="sa">f</span><span class="s2">&quot;    steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="c1"># NOTE: If `fixed_train_size` the train size doesn&#39;t increase but</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="c1"># moves by `fold_stride` positions in each iteration. If `False`,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="c1"># the train size increases by `fold_stride` in each iteration.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="c1"># NOTE: The train size doesn&#39;t increase and doesn&#39;t move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span><span class="p">:</span><span class="n">train_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span><span class="p">:</span><span class="n">test_iloc_start</span><span class="p">]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="p">),</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span><span class="p">:</span><span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="c1"># NOTE: Delete all incomplete folds at the end if not allowed</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">n_removed_folds</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># NOTE: While folds and the last &quot;test_index_with_gap&quot; is incomplete,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="c1"># calculating len of range objects</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">while</span> <span class="n">folds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">folds</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">n_removed_folds</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="c1"># Create a flag to know whether to train the forecaster</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">folds</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="n">externally_fitted</span><span class="o">=</span><span class="n">externally_fitted</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="n">n_removed_folds</span><span class="o">=</span><span class="n">n_removed_folds</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="n">index_to_skip</span><span class="o">=</span><span class="n">index_to_skip</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="p">[</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                    <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="p">]</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="p">],</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                    <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="s2">&quot;last_window_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                    <span class="s2">&quot;last_window_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                    <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                    <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                    <span class="s2">&quot;test_start_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                    <span class="s2">&quot;test_end_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="p">],</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                <span class="n">data</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                    <span class="s2">&quot;train_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                    <span class="s2">&quot;last_window_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                    <span class="s2">&quot;test_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                    <span class="s2">&quot;test_index_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                <span class="p">],</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="k">return</span> <span class="n">folds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.backtesting_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">backtesting_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval_method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>, <span title="ForecasterEquivalentDate">ForecasterEquivalentDate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TimeSeriesFold (spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold)" href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to
split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit
of the model.</p>
<ul>
<li>If <code>str</code>: {'mean_squared_error', 'mean_absolute_error',
  'mean_absolute_percentage_error', 'mean_squared_log_error',
  'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
  (Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as
predictor/s. Must have the same number of observations as <code>y</code> and should
be aligned so that y[i] is regressed on exog[i]. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="list">list</span> | <span title="tuple">tuple</span> | <span title="str">str</span> | <span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether
probabilistic predictions should be estimated and the method to use.
The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1).
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must
  be between 0 and 100 inclusive. For example, a 95% confidence interval can
  be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10,
  50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be
  generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
  be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.
Defaults to None.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction
intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction intervals.</li>
<li>'conformal': Employs the conformal prediction split method for
  interval estimation.
Defaults to 'bootstrapping'.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when
estimating prediction intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the
training data are used as proxy of prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected
based on the predicted values (binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to
ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make
the predictions are also returned. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>,
then the number of jobs is set to the number of cores. If 'auto', <code>n_jobs</code>
is set using the function <code>skforecast.utils.select_n_jobs_backtesting</code>.
Defaults to 'auto'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and
validation sets used for backtesting. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, spotforecast warnings will be
suppressed during the backtesting process. See
<code>spotforecast.exceptions.warn_skforecast_categories</code> for more information.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>metric_values: Value(s) of the metric(s).</li>
<li>
<p>backtest_predictions: Value of predictions. The DataFrame includes
  the following columns:</p>
</li>
<li>
<p>fold: Indicates the fold number where the prediction was made.</p>
</li>
<li>pred: Predicted values for the corresponding series and time steps.</li>
</ul>
<p>If <code>interval</code> is not <code>None</code>, additional columns are included depending
  on the method:</p>
<ul>
<li>For <code>float</code>: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> of 2 elements: Columns <code>lower_bound</code> and
    <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> with multiple percentiles: One column per
    percentile (e.g., <code>p_10</code>, <code>p_50</code>, <code>p_90</code>).</li>
<li>For <code>'bootstrapping'</code>: One column per bootstrapping iteration
    (e.g., <code>pred_boot_0</code>, <code>pred_boot_1</code>, ..., <code>pred_boot_n</code>).</li>
<li>For <code>scipy.stats</code> distribution objects: One column for each
    estimated parameter of the distribution (e.g., <code>loc</code>, <code>scale</code>).</li>
</ul>
<p>If <code>return_predictors</code> is <code>True</code>, one column per predictor is created.</p>
<p>Depending on the relation between <code>steps</code> and <code>fold_stride</code>, the output
  may include repeated indexes (if <code>fold_stride &lt; steps</code>) or gaps
  (if <code>fold_stride &gt; steps</code>). See Notes below for more details.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Note on <code>fold_stride</code> vs. <code>steps</code>:</p>
<ul>
<li>If <code>fold_stride == steps</code>, test sets are placed back-to-back without overlap.
  Each observation appears only once in the output DataFrame, so the
  index is unique.</li>
<li>If <code>fold_stride &lt; steps</code>, test sets overlap. Multiple forecasts are
  generated for the same observations and, therefore, the output
  DataFrame contains repeated indexes.</li>
<li>If <code>fold_stride &gt; steps</code>, there are gaps between consecutive test sets.
  Some observations in the series will not have associated predictions,
  so the output DataFrame has non-contiguous indexes.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">backtesting_forecaster</span><span class="p">,</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">metric_values</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">   mean_squared_error</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">0            0.201334</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">backtest_predictions</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">   fold  pred</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">5     0  5.18</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">6     0  6.10</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">7     1  7.36</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">8     1  8.40</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">9     2  9.31</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="k">def</span><span class="w"> </span><span class="nf">backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    class and using the metric(s) provided.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    them.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    A copy of the original forecaster is created so that it is not modified during</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    the process.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        forecaster (ForecasterRecursive, ForecasterDirect, ForecasterEquivalentDate):</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            Forecaster model.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        y (pd.Series): Training time series.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">        cv (TimeSeriesFold): TimeSeriesFold object with the information needed to</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            split the data into folds.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        metric (str | Callable | list): Metric used to quantify the goodness of fit</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">            of the model.</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            - If `str`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">              &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">              &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">              (Optional) that returns a float.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">            - If `list`: List containing multiple strings and/or Callables.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        exog (pd.Series | pd.DataFrame, optional): Exogenous variable/s included as</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            predictor/s. Must have the same number of observations as `y` and should</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">            be aligned so that y[i] is regressed on exog[i]. Defaults to None.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        interval (float | list | tuple | str | object, optional): Specifies whether</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            probabilistic predictions should be estimated and the method to use.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            The following options are supported:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0 and 1).</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            - If `list` or `tuple`: Sequence of percentiles to compute, each value must</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">              be between 0 and 100 inclusive. For example, a 95% confidence interval can</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">              be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">              50 and 90) as `interval = [10, 50, 90]`.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">              generated.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            - If scipy.stats distribution object, the distribution parameters will</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">              be estimated for each prediction.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            - If None, no probabilistic predictions are estimated.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        interval_method (str, optional): Technique used to estimate prediction</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            intervals. Available options:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction intervals.</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">              interval estimation.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        n_boot (int, optional): Number of bootstrapping iterations to perform when</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            estimating prediction intervals. Defaults to 250.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        use_in_sample_residuals (bool, optional): If `True`, residuals from the</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            training data are used as proxy of prediction error to create predictions.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        use_binned_residuals (bool, optional): If `True`, residuals are selected</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            based on the predicted values (binned selection).</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        random_state (int, optional): Seed for the random number generator to</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        return_predictors (bool, optional): If `True`, the predictors used to make</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            the predictions are also returned. Defaults to False.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        n_jobs (int | str, optional): The number of jobs to run in parallel. If `-1`,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            then the number of jobs is set to the number of cores. If &#39;auto&#39;, `n_jobs`</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            is set using the function `skforecast.utils.select_n_jobs_backtesting`.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            Defaults to &#39;auto&#39;.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        verbose (bool, optional): Print number of folds and index of training and</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            validation sets used for backtesting. Defaults to False.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        show_progress (bool, optional): Whether to show a progress bar.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        suppress_warnings (bool, optional): If `True`, spotforecast warnings will be</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">            suppressed during the backtesting process. See</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">            `spotforecast.exceptions.warn_skforecast_categories` for more information.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        tuple (pd.DataFrame, pd.DataFrame):</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            - metric_values: Value(s) of the metric(s).</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            - backtest_predictions: Value of predictions. The DataFrame includes</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">              the following columns:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">              - fold: Indicates the fold number where the prediction was made.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">              - pred: Predicted values for the corresponding series and time steps.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">              If `interval` is not `None`, additional columns are included depending</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">              on the method:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">              - For `float`: Columns `lower_bound` and `upper_bound`.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">              - For `list` or `tuple` of 2 elements: Columns `lower_bound` and</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">                `upper_bound`.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">              - For `list` or `tuple` with multiple percentiles: One column per</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">                percentile (e.g., `p_10`, `p_50`, `p_90`).</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">              - For `&#39;bootstrapping&#39;`: One column per bootstrapping iteration</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">                (e.g., `pred_boot_0`, `pred_boot_1`, ..., `pred_boot_n`).</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">              - For `scipy.stats` distribution objects: One column for each</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">                estimated parameter of the distribution (e.g., `loc`, `scale`).</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">              If `return_predictors` is `True`, one column per predictor is created.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">              Depending on the relation between `steps` and `fold_stride`, the output</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">              may include repeated indexes (if `fold_stride &lt; steps`) or gaps</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">              (if `fold_stride &gt; steps`). See Notes below for more details.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        Note on `fold_stride` vs. `steps`:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        - If `fold_stride == steps`, test sets are placed back-to-back without overlap.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">          Each observation appears only once in the output DataFrame, so the</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">          index is unique.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        - If `fold_stride &lt; steps`, test sets overlap. Multiple forecasts are</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">          generated for the same observations and, therefore, the output</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">          DataFrame contains repeated indexes.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        - If `fold_stride &gt; steps`, there are gaps between consecutive test sets.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">          Some observations in the series will not have associated predictions,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">          so the output DataFrame has non-contiguous indexes.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import backtesting_forecaster, TimeSeriesFold</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        ...     estimator=RandomForestRegressor(random_state=123),</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        ...     lags=2</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        ...     steps=2,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">        ...     initial_train_size=5,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        ...     refit=False</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">        &gt;&gt;&gt; metric_values, backtest_predictions = backtesting_forecaster(</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        ...     forecaster=forecaster,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        ...     y=y,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        ...     cv=cv,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        ...     metric=&#39;mean_squared_error&#39;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        &gt;&gt;&gt; metric_values</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">           mean_squared_error</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        0            0.201334</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        &gt;&gt;&gt; backtest_predictions</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">           fold  pred</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        5     0  5.18</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        6     0  6.10</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        7     1  7.36</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        8     1  8.40</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        9     2  9.31</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="n">forecaters_allowed</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="p">]</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecaters_allowed</span><span class="p">:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">forecaters_allowed</span><span class="si">}</span><span class="s2">. For all other &quot;</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="sa">f</span><span class="s2">&quot;types of forecasters use the other functions available in the &quot;</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="sa">f</span><span class="s2">&quot;`model_selection` module.&quot;</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="n">check_backtesting_input</span><span class="p">(</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="n">interval_method</span><span class="o">=</span><span class="n">interval_method</span><span class="p">,</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">return_predictors</span><span class="o">=</span><span class="n">return_predictors</span><span class="p">,</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">interval_method</span><span class="o">=</span><span class="n">interval_method</span><span class="p">,</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="n">return_predictors</span><span class="o">=</span><span class="n">return_predictors</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="bayesian-search">Bayesian Search</h2>
<h3 id="bayesian_search">bayesian_search</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.bayesian_search" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.bayesian_search</code>


</h2>

    <div class="doc doc-contents first">

        <p>Bayesian hyperparameter search functions for forecasters using Optuna.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.bayesian_search.bayesian_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bayesian_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">search_space</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kwargs_create_study</span><span class="o">=</span><span class="p">{},</span> <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Bayesian hyperparameter optimization for a Forecaster using Optuna.</p>
<p>Performs Bayesian hyperparameter search using the Optuna library for a
Forecaster object. Validation is done using time series backtesting with
the provided cross-validation strategy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model. Can be ForecasterRecursive, ForecasterDirect,
or any compatible forecaster class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series values. Must be a pandas Series with a
datetime or numeric index.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TimeSeriesFold (spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold)" href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold">TimeSeriesFold</a> | <a class="autorefs autorefs-internal" title="OneStepAheadFold (spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold)" href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold">OneStepAheadFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cross-validation strategy with information needed to split the data
into folds. Must be an instance of TimeSeriesFold or OneStepAheadFold.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>search_space</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable function with argument <code>trial</code> that returns
a dictionary with parameter names (str) as keys and Trial objects
from optuna (trial.suggest_float, trial.suggest_int,
trial.suggest_categorical) as values. Can optionally include 'lags'
key to search over different lag configurations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span>[<span title="str">str</span> | <span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric(s) to quantify model goodness of fit. Can be:
- str: One of 'mean_squared_error', 'mean_absolute_error',
  'mean_absolute_percentage_error', 'mean_squared_log_error',
  'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'.
- Callable: Function with arguments (y_true, y_pred) or
  (y_true, y_pred, y_train) that returns a float.
- list: List containing multiple strings and/or Callables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictors. Must have the
same number of observations as <code>y</code> and aligned so that y[i] is
regressed on exog[i]. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_trials</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings sampled during optimization.
Default is 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for sampling reproducibility. When passing a custom
sampler in kwargs_create_study, set the seed within the sampler
(e.g., {'sampler': TPESampler(seed=145)}). Default is 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, refit the forecaster using the best parameters
found on the whole dataset at the end. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel jobs. If -1, uses all cores. If 'auto',
uses spotforecast.skforecast.utils.select_n_jobs_backtesting to
automatically determine the number of jobs. Default is 'auto'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print number of folds used for cross-validation.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show an Optuna progress bar during
optimization. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, suppress spotforecast warnings during
hyperparameter search. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename or full path to save results as TSV. If None,
results are not saved to file. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_create_study</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to
optuna.create_study(). If not specified, direction is set to
'minimize' and TPESampler(seed=123) is used. Default is {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs_study_optimize</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments passed to
study.optimize(). Default is {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[pd.DataFrame, object]: A tuple containing:
- results: DataFrame with columns 'lags', 'params', metric values,
  and individual parameter columns. Sorted by the first metric.
- best_trial: Best optimization result as an optuna.FrozenTrial
  object containing the best parameters and metric value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If exog length doesn't match y length when return_best=True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If cv is not an instance of TimeSeriesFold or OneStepAheadFold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If metric list contains duplicate metric names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/bayesian_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="k">def</span><span class="w"> </span><span class="nf">bayesian_search_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">search_space</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">n_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">kwargs_create_study</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">kwargs_study_optimize</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">object</span><span class="p">]:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Bayesian hyperparameter optimization for a Forecaster using Optuna.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Performs Bayesian hyperparameter search using the Optuna library for a</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Forecaster object. Validation is done using time series backtesting with</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    the provided cross-validation strategy.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        forecaster: Forecaster model. Can be ForecasterRecursive, ForecasterDirect,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            or any compatible forecaster class.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        y: Training time series values. Must be a pandas Series with a</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            datetime or numeric index.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        cv: Cross-validation strategy with information needed to split the data</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            into folds. Must be an instance of TimeSeriesFold or OneStepAheadFold.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        search_space: Callable function with argument `trial` that returns</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            a dictionary with parameter names (str) as keys and Trial objects</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            from optuna (trial.suggest_float, trial.suggest_int,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            trial.suggest_categorical) as values. Can optionally include &#39;lags&#39;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            key to search over different lag configurations.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        metric: Metric(s) to quantify model goodness of fit. Can be:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            - str: One of &#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">              &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">              &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            - Callable: Function with arguments (y_true, y_pred) or</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">              (y_true, y_pred, y_train) that returns a float.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            - list: List containing multiple strings and/or Callables.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        exog: Exogenous variable(s) included as predictors. Must have the</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            same number of observations as `y` and aligned so that y[i] is</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        n_trials: Number of parameter settings sampled during optimization.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            Default is 10.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        random_state: Seed for sampling reproducibility. When passing a custom</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">            sampler in kwargs_create_study, set the seed within the sampler</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            (e.g., {&#39;sampler&#39;: TPESampler(seed=145)}). Default is 123.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        return_best: If True, refit the forecaster using the best parameters</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            found on the whole dataset at the end. Default is True.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        n_jobs: Number of parallel jobs. If -1, uses all cores. If &#39;auto&#39;,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            uses spotforecast.skforecast.utils.select_n_jobs_backtesting to</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            automatically determine the number of jobs. Default is &#39;auto&#39;.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        verbose: If True, print number of folds used for cross-validation.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            Default is False.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        show_progress: Whether to show an Optuna progress bar during</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            optimization. Default is True.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        suppress_warnings: If True, suppress spotforecast warnings during</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            hyperparameter search. Default is False.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        output_file: Filename or full path to save results as TSV. If None,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            results are not saved to file. Default is None.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        kwargs_create_study: Additional keyword arguments passed to</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            optuna.create_study(). If not specified, direction is set to</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            &#39;minimize&#39; and TPESampler(seed=123) is used. Default is {}.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        kwargs_study_optimize: Additional keyword arguments passed to</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">            study.optimize(). Default is {}.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        tuple[pd.DataFrame, object]: A tuple containing:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            - results: DataFrame with columns &#39;lags&#39;, &#39;params&#39;, metric values,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">              and individual parameter columns. Sorted by the first metric.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            - best_trial: Best optimization result as an optuna.FrozenTrial</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">              object containing the best parameters and metric value.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        ValueError: If exog length doesn&#39;t match y length when return_best=True.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        TypeError: If cv is not an instance of TimeSeriesFold or OneStepAheadFold.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        ValueError: If metric list contains duplicate metric names.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">return_best</span> <span class="ow">and</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="sa">f</span><span class="s2">&quot;`exog` must have same number of samples as `y`. &quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="sa">f</span><span class="s2">&quot;length `exog`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">), length `y`: (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span> <span class="o">=</span> <span class="n">_bayesian_search_optuna</span><span class="p">(</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">search_space</span><span class="o">=</span><span class="n">search_space</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">n_trials</span><span class="o">=</span><span class="n">n_trials</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">return_best</span><span class="o">=</span><span class="n">return_best</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">kwargs_create_study</span><span class="o">=</span><span class="n">kwargs_create_study</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">kwargs_study_optimize</span><span class="o">=</span><span class="n">kwargs_study_optimize</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">return</span> <span class="n">results</span><span class="p">,</span> <span class="n">best_trial</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="grid-search">Grid Search</h2>
<h3 id="grid_search">grid_search</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.grid_search" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.grid_search</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.grid_search.grid_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grid_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exhaustive grid search over parameter values for a Forecaster.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/grid_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="k">def</span><span class="w"> </span><span class="nf">grid_search_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">param_grid</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    Exhaustive grid search over parameter values for a Forecaster.</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">))</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">lags_grid</span><span class="o">=</span><span class="n">lags_grid</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">return_best</span><span class="o">=</span><span class="n">return_best</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="random-search">Random Search</h2>
<h3 id="random_search">random_search</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.random_search" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.random_search</code>


</h2>

    <div class="doc doc-contents first">

        <p>Random search hyperparameter optimization for forecasters.</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.random_search.random_search_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">random_search_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Random search over parameter distributions for a Forecaster.</p>
<p>Performs random sampling of parameter settings from distributions for a
Forecaster object. Validation is done using time series backtesting with
the provided cross-validation strategy. This is more efficient than grid
search when exploring large parameter spaces.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model (ForecasterRecursive or ForecasterDirect).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TimeSeriesFold (spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold)" href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold">TimeSeriesFold</a> | <a class="autorefs autorefs-internal" title="OneStepAheadFold (spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold)" href="#spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold">OneStepAheadFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cross-validation strategy (TimeSeriesFold or OneStepAheadFold)
with information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_distributions</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with parameter names (str) as keys
and distributions or lists of parameters to try as values.
Use scipy.stats distributions for continuous parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span>[<span title="str">str</span> | <span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric(s) to quantify model goodness of fit. If str:
'mean_squared_error', 'mean_absolute_error',
'mean_absolute_percentage_error', 'mean_squared_log_error',
'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'.
If Callable: Function with arguments (y_true, y_pred, y_train)
that returns a float. If list: Multiple strings and/or Callables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable(s) included as predictors. Must have the
same number of observations as y and aligned so that y[i] is
regressed on exog[i]. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>]] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>]]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try. Can be int, lists, numpy ndarray,
or range objects. If dict, keys are used as labels in results
DataFrame. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_iter</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parameter settings sampled per lags configuration.
Trades off runtime vs solution quality. Default is 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for random sampling for reproducible output.
Default is 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_best</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, refit the forecaster using best parameters
on the whole dataset. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of jobs to run in parallel. If -1, uses all cores.
If 'auto', uses select_n_jobs_backtesting. Default is 'auto'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print number of folds used for cv. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, suppress spotforecast warnings during
hyperparameter search. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename or full path to save results as TSV. If None,
results are not saved to file. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Results for each parameter combination with columns: lags (lags</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration), lags_label (descriptive label), params (parameters</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration), metric (metric value), and additional columns with</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>param=value pairs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic random search with continuous parameter distributions:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">uniform</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection.random_search</span><span class="w"> </span><span class="kn">import</span> <span class="n">random_search_forecaster</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample data</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up forecaster and cross-validation</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define parameter distributions with scipy.stats</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">param_distributions</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>    <span class="s1">&#39;estimator__alpha&#39;</span><span class="p">:</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>  <span class="c1"># Uniform between 0.1 and 10.1</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span><span class="p">}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run random search</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">random_search_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">... </span>    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="gp">... </span>    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="gp">... </span>    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="gp">... </span>    <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_distributions</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="gp">... </span>    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="gp">... </span>    <span class="n">n_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="gp">... </span>    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="gp">... </span>    <span class="n">return_best</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="gp">... </span>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="gp">... </span>    <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="gp">&gt;&gt;&gt;</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check results</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">5</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;estimator__alpha&#39;</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="go">True</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean_squared_error&#39;</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">True</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/random_search.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">random_search_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span> <span class="o">|</span> <span class="n">OneStepAheadFold</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">param_distributions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">return_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random search over parameter distributions for a Forecaster.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Performs random sampling of parameter settings from distributions for a</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Forecaster object. Validation is done using time series backtesting with</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    the provided cross-validation strategy. This is more efficient than grid</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    search when exploring large parameter spaces.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        forecaster: Forecaster model (ForecasterRecursive or ForecasterDirect).</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        y: Training time series.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        cv: Cross-validation strategy (TimeSeriesFold or OneStepAheadFold)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            with information needed to split the data into folds.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        param_distributions: Dictionary with parameter names (str) as keys</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            and distributions or lists of parameters to try as values.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            Use scipy.stats distributions for continuous parameters.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        metric: Metric(s) to quantify model goodness of fit. If str:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            &#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">            &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            If Callable: Function with arguments (y_true, y_pred, y_train)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            that returns a float. If list: Multiple strings and/or Callables.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        exog: Exogenous variable(s) included as predictors. Must have the</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            same number of observations as y and aligned so that y[i] is</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            regressed on exog[i]. Default is None.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        lags_grid: Lists of lags to try. Can be int, lists, numpy ndarray,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            or range objects. If dict, keys are used as labels in results</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            DataFrame. Default is None.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        n_iter: Number of parameter settings sampled per lags configuration.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            Trades off runtime vs solution quality. Default is 10.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        random_state: Seed for random sampling for reproducible output.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            Default is 123.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        return_best: If True, refit the forecaster using best parameters</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            on the whole dataset. Default is True.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        n_jobs: Number of jobs to run in parallel. If -1, uses all cores.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            If &#39;auto&#39;, uses select_n_jobs_backtesting. Default is &#39;auto&#39;.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        verbose: If True, print number of folds used for cv. Default is False.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        show_progress: Whether to show a progress bar. Default is True.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        suppress_warnings: If True, suppress spotforecast warnings during</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            hyperparameter search. Default is False.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        output_file: Filename or full path to save results as TSV. If None,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            results are not saved to file. Default is None.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        Results for each parameter combination with columns: lags (lags</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        configuration), lags_label (descriptive label), params (parameters</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        configuration), metric (metric value), and additional columns with</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        param=value pairs.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        Basic random search with continuous parameter distributions:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import Ridge</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &gt;&gt;&gt; from scipy.stats import uniform</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import TimeSeriesFold</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection.random_search import random_search_forecaster</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        &gt;&gt;&gt; # Create sample data</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        &gt;&gt;&gt; np.random.seed(123)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.random.randn(50), name=&#39;y&#39;)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        &gt;&gt;&gt; # Set up forecaster and cross-validation</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(estimator=Ridge(), lags=3)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(steps=3, initial_train_size=20, refit=False)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &gt;&gt;&gt; # Define parameter distributions with scipy.stats</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &gt;&gt;&gt; param_distributions = {</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        ...     &#39;estimator__alpha&#39;: uniform(0.1, 10.0)  # Uniform between 0.1 and 10.1</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        ... }</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        &gt;&gt;&gt; # Run random search</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &gt;&gt;&gt; results = random_search_forecaster(</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        ...     forecaster=forecaster,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        ...     y=y,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        ...     cv=cv,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        ...     param_distributions=param_distributions,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ...     metric=&#39;mean_squared_error&#39;,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     n_iter=5,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ...     random_state=42,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        ...     return_best=False,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        ...     verbose=False,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        ...     show_progress=False</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        &gt;&gt;&gt; # Check results</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        &gt;&gt;&gt; print(results.shape[0])</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        5</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        &gt;&gt;&gt; print(&#39;estimator__alpha&#39; in results.columns)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        True</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        &gt;&gt;&gt; print(&#39;mean_squared_error&#39; in results.columns)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        True</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">param_grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">ParameterSampler</span><span class="p">(</span><span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="n">n_iter</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">_evaluate_grid_hyperparameters</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">lags_grid</span><span class="o">=</span><span class="n">lags_grid</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">return_best</span><span class="o">=</span><span class="n">return_best</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="cross-validation-splitting">Cross-Validation Splitting</h2>
<h3 id="split_base">split_base</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.split_base" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.split_base</code>


</h2>

    <div class="doc doc-contents first">

        <p>Base class for time series cross-validation splitting.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.split_base.BaseFold" class="doc doc-heading">
            <code>BaseFold</code>


</h3>


    <div class="doc doc-contents ">



        <p>Base class for all Fold classes in spotforecast. All fold classes should specify
all the parameters that can be set at the class level in their <code>__init__</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold.
This is also commonly referred to as the forecast horizon or test size.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations
used for initial training.</p>
<ul>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in
  the initial training set.
Defaults to None.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fold_stride</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations that the start of the test
set advances between consecutive folds.</p>
<ul>
<li>If <code>None</code>, it defaults to the same value as <code>steps</code>, meaning that folds
  are placed back-to-back without overlap.</li>
<li>If <code>fold_stride &lt; steps</code>, test sets overlap and multiple forecasts will
  be generated for the same observations.</li>
<li>If <code>fold_stride &gt; steps</code>, gaps are left between consecutive test sets.
Defaults to None.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.
Defaults to False.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed_train_size</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases
in each fold. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set
and the start of the test set. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_folds</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_incomplete_fold</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include
fewer observations than <code>steps</code>. If <code>False</code>, the last fold is excluded if it
is incomplete. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the
start and end indexes of each fold. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_base.BaseFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_base.BaseFold.window_size">window_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_base.BaseFold.differentiation">differentiation</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_base.BaseFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start
and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_base.BaseFold.verbose">verbose</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseFold</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Base class for all Fold classes in spotforecast. All fold classes should specify</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    all the parameters that can be set at the class level in their ``__init__``.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        steps (int, optional): Number of observations used to be predicted in each fold.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">            This is also commonly referred to as the forecast horizon or test size.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        initial_train_size (int | str | pd.Timestamp, optional): Number of observations</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">            used for initial training.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            - If an integer, the number of observations used for initial training.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">            - If a date string or pandas Timestamp, it is the last date included in</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">              the initial training set.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        fold_stride (int, optional): Number of observations that the start of the test</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            set advances between consecutive folds.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            - If `None`, it defaults to the same value as `steps`, meaning that folds</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">              are placed back-to-back without overlap.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            - If `fold_stride &lt; steps`, test sets overlap and multiple forecasts will</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">              be generated for the same observations.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            - If `fold_stride &gt; steps`, gaps are left between consecutive test sets.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        window_size (int, optional): Number of observations needed to generate the</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            autoregressive predictors. Defaults to None.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        differentiation (int, optional): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            differentiation order. Defaults to None.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        refit (bool | int, optional): Whether to refit the forecaster in each fold.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            - If `True`, the forecaster is refitted in each fold.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            - If `False`, the forecaster is trained only in the first fold.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            - If an integer, the forecaster is trained in the first fold and then refitted</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">              every `refit` folds.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        fixed_train_size (bool, optional): Whether the training size is fixed or increases</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            in each fold. Defaults to True.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        gap (int, optional): Number of observations between the end of the training set</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            and the start of the test set. Defaults to 0.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        skip_folds (int | list, optional): Number of folds to skip.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            - If an integer, every &#39;skip_folds&#39;-th is returned.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            - If a list, the indexes of the folds to skip.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            For example, if `skip_folds=3` and there are 10 folds, the returned folds are</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            0, 3, 6, and 9. If `skip_folds=[1, 2, 3]`, the returned folds are 0, 4, 5, 6, 7,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            8, and 9. Defaults to None.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        allow_incomplete_fold (bool, optional): Whether to allow the last fold to include</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            fewer observations than `steps`. If `False`, the last fold is excluded if it</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            is incomplete. Defaults to True.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        return_all_indexes (bool, optional): Whether to return all indexes or only the</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            start and end indexes of each fold. Defaults to False.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        verbose (bool, optional): Whether to print information about generated folds.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        initial_train_size (int): Number of observations used for initial training.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        window_size (int): Number of observations needed to generate the</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            autoregressive predictors.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        differentiation (int): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            differentiation order.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        return_all_indexes (bool): Whether to return all indexes or only the start</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            and end indexes of each fold.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        verbose (bool): Whether to print information about generated folds.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">fold_stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">cv_name</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">initial_train_size</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">fold_stride</span><span class="o">=</span><span class="n">fold_stride</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">differentiation</span><span class="o">=</span><span class="n">differentiation</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">refit</span><span class="o">=</span><span class="n">refit</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">fixed_train_size</span><span class="o">=</span><span class="n">fixed_train_size</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">gap</span><span class="o">=</span><span class="n">gap</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">skip_folds</span><span class="o">=</span><span class="n">skip_folds</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="n">allow_incomplete_fold</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">return_all_indexes</span><span class="o">=</span><span class="n">return_all_indexes</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">initial_train_size</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="o">=</span> <span class="n">differentiation</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span> <span class="o">=</span> <span class="n">return_all_indexes</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_params</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">cv_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">fold_stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        Validate all input parameters to ensure correctness.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">steps</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                    <span class="sa">f</span><span class="s2">&quot;`steps` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                <span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                    <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, a date &quot;</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>                    <span class="sa">f</span><span class="s2">&quot;string, a pandas Timestamp, or None. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="p">):</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                    <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, &quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                    <span class="sa">f</span><span class="s2">&quot;a date string, a pandas Timestamp, or None. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">if</span> <span class="n">fold_stride</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fold_stride</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">fold_stride</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                        <span class="sa">f</span><span class="s2">&quot;`fold_stride` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                    <span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                    <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="ow">and</span> <span class="n">refit</span> <span class="o">&lt;</span> <span class="mi">0</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="p">):</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                    <span class="sa">f</span><span class="s2">&quot;`refit` must be a boolean or an integer equal or greater than 0. &quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">refit</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fixed_train_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                    <span class="sa">f</span><span class="s2">&quot;`fixed_train_size` must be a boolean: `True`, `False`. &quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">gap</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                    <span class="sa">f</span><span class="s2">&quot;`gap` must be an integer greater than or equal to 0. Got </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="k">if</span> <span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                        <span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                        <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                    <span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="n">skip_folds</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                        <span class="sa">f</span><span class="s2">&quot;`skip_folds` must be an integer greater than 0, a list of &quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                        <span class="sa">f</span><span class="s2">&quot;integers or `None`. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                    <span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">skip_folds</span><span class="p">]):</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                        <span class="sa">f</span><span class="s2">&quot;`skip_folds` list must contain integers greater than or &quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                        <span class="sa">f</span><span class="s2">&quot;equal to 1. The first fold is always needed to train the &quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                        <span class="sa">f</span><span class="s2">&quot;forecaster. Got </span><span class="si">{</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">allow_incomplete_fold</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                    <span class="sa">f</span><span class="s2">&quot;`allow_incomplete_fold` must be a boolean: `True`, `False`. &quot;</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">if</span> <span class="n">cv_name</span> <span class="o">==</span> <span class="s2">&quot;OneStepAheadFold&quot;</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">)):</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                    <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, a date &quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                    <span class="sa">f</span><span class="s2">&quot;string, or a pandas Timestamp. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="nb">isinstance</span><span class="p">(</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="ow">and</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                    <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than 0, &quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                    <span class="sa">f</span><span class="s2">&quot;a date string, or a pandas Timestamp. Got </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)))</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">window_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="ow">and</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="mi">1</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="p">):</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="sa">f</span><span class="s2">&quot;`window_size` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">if</span> <span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>                <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">0</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="p">):</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                    <span class="sa">f</span><span class="s2">&quot;`differentiation` must be None or an integer greater than or &quot;</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                    <span class="sa">f</span><span class="s2">&quot;equal to 0. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                <span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_all_indexes</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="sa">f</span><span class="s2">&quot;`return_all_indexes` must be a boolean: `True`, `False`. &quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="p">)</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbose</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="sa">f</span><span class="s2">&quot;`verbose` must be a boolean: `True`, `False`. &quot;</span> <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_index</span><span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Extracts and returns the index from the input data X.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            X (pd.Series | pd.DataFrame | pd.Index | dict): Time series data or</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">                index to split.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">            pd.Index: Index extracted from the input data.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">indexes_freq</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">not_valid_index</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">min_index</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">max_index</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">index</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                    <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">):</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>                    <span class="n">indexes_freq</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>                    <span class="n">not_valid_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                <span class="n">min_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="n">max_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="k">if</span> <span class="n">not_valid_index</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                    <span class="sa">f</span><span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                    <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                    <span class="sa">f</span><span class="s2">&quot;Review series: </span><span class="si">{</span><span class="n">not_valid_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>                <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">indexes_freq</span><span class="p">:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                    <span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                    <span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                    <span class="s2">&quot;Found series with no frequency or step.&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>                    <span class="sa">f</span><span class="s2">&quot;If `X` is a dictionary, all series must have a Pandas &quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>                    <span class="sa">f</span><span class="s2">&quot;RangeIndex or DatetimeIndex with the same step/frequency. &quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                    <span class="sa">f</span><span class="s2">&quot;Found frequencies: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">indexes_freq</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>                <span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>                    <span class="n">start</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">min_index</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">max_index</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="n">indexes_freq</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>                <span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>                    <span class="n">start</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">min_index</span><span class="p">),</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                    <span class="n">stop</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">max_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                    <span class="n">step</span><span class="o">=</span><span class="n">indexes_freq</span><span class="o">.</span><span class="n">pop</span><span class="p">(),</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">return</span> <span class="n">idx</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        Set the parameters of the Fold object. Before overwriting the current</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        parameters, the input parameters are validated to ensure correctness.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            params (dict): Dictionary with the parameters to set.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`params` must be a dictionary. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">current_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">unknown_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">current_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="k">if</span> <span class="n">unknown_params</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="sa">f</span><span class="s2">&quot;Unknown parameters: </span><span class="si">{</span><span class="n">unknown_params</span><span class="si">}</span><span class="s2">. They have been ignored.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">filtered_params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">current_params</span><span class="p">}</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="n">updated_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>            <span class="s2">&quot;cv_name&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="o">**</span><span class="n">current_params</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="o">**</span><span class="n">filtered_params</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="p">}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span><span class="o">**</span><span class="n">updated_params</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">updated_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.split_base.BaseFold.set_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Set the parameters of the Fold object. Before overwriting the current
parameters, the input parameters are validated to ensure correctness.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the parameters to set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Set the parameters of the Fold object. Before overwriting the current</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    parameters, the input parameters are validated to ensure correctness.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        params (dict): Dictionary with the parameters to set.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`params` must be a dictionary. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">current_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">unknown_params</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">current_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">if</span> <span class="n">unknown_params</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="sa">f</span><span class="s2">&quot;Unknown parameters: </span><span class="si">{</span><span class="n">unknown_params</span><span class="si">}</span><span class="s2">. They have been ignored.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">filtered_params</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">current_params</span><span class="p">}</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">updated_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="s2">&quot;cv_name&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="o">**</span><span class="n">current_params</span><span class="p">,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="o">**</span><span class="n">filtered_params</span><span class="p">,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="p">}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">(</span><span class="o">**</span><span class="n">updated_params</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">updated_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h3 id="split_one_step">split_one_step</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.split_one_step" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.split_one_step</code>


</h2>

    <div class="doc doc-contents first">

        <p>One step ahead cross-validation splitting.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold" class="doc doc-heading">
            <code>OneStepAheadFold</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFold (spotforecast2_safe.model_selection.split_base.BaseFold)" href="#spotforecast2_safe.model_selection.split_base.BaseFold">BaseFold</a></code></p>



        <p>Class to split time series data into train and test folds for one-step-ahead
forecasting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used
for initial training.</p>
<ul>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in
  the initial training set.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the
start and end indexes of each fold. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.initial_train_size">initial_train_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.window_size">window_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.differentiation">differentiation</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start
and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.verbose">verbose</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">class</span><span class="w"> </span><span class="nc">OneStepAheadFold</span><span class="p">(</span><span class="n">BaseFold</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Class to split time series data into train and test folds for one-step-ahead</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    forecasting.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        initial_train_size (int | str | pd.Timestamp): Number of observations used</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">            for initial training.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            - If an integer, the number of observations used for initial training.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">            - If a date string or pandas Timestamp, it is the last date included in</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">              the initial training set.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        window_size (int, optional): Number of observations needed to generate the</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">            autoregressive predictors. Defaults to None.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        differentiation (int, optional): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            differentiation order. Defaults to None.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        return_all_indexes (bool, optional): Whether to return all indexes or only the</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            start and end indexes of each fold. Defaults to False.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        verbose (bool, optional): Whether to print information about generated folds.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        initial_train_size (int): Number of observations used for initial training.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        window_size (int): Number of observations needed to generate the</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">            autoregressive predictors.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        differentiation (int): Number of observations to use for differentiation.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            differentiation order.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        return_all_indexes (bool): Whether to return all indexes or only the start</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            and end indexes of each fold.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        verbose (bool): Whether to print information about generated folds.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">initial_train_size</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="n">differentiation</span><span class="o">=</span><span class="n">differentiation</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">return_all_indexes</span><span class="o">=</span><span class="n">return_all_indexes</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        Information displayed when printed.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="sa">f</span><span class="s2">&quot;Initial train size = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="sa">f</span><span class="s2">&quot;Window size        = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="sa">f</span><span class="s2">&quot;Return all indexes = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="sa">f</span><span class="s2">&quot;Verbose            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        HTML representation of the object.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        Split the time series data into train and test folds.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            X (pd.Series | pd.DataFrame | pd.Index | dict): Time series data or index to split.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            as_pandas (bool, optional): If True, the folds are returned as a DataFrame.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">                This is useful to visualize the folds in a more interpretable way.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">                Defaults to False.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            externally_fitted (Any, optional): This argument is not used in this class.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">                It is included for API consistency. Defaults to None.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            list | pd.DataFrame: A list of lists containing the indices (position) of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            the fold. The list contains 2 lists with the following information:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            - fold: fold number.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            - [train_start, train_end]: list with the start and end positions of the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">                training set.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            - [test_start, test_end]: list with the start and end positions of the test</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">                set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">                in this fold.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            It is important to note that the returned values are the positions of the</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            observations and not the actual values of the index, so they can be used to</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            slice the data directly using iloc.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            &#39;test_end&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            slice.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="p">]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="p">]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                        <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                        <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                        <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                        <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="p">],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fold</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fold&quot;</span><span class="p">,</span> <span class="s2">&quot;train_index&quot;</span><span class="p">,</span> <span class="s2">&quot;test_index&quot;</span><span class="p">,</span> <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">return</span> <span class="n">fold</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">fold</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        Print information about folds.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            index (pd.Index): Index of the time series data.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            fold (list): A list of lists containing the indices (position) of the fold.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="n">differentiation</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">test_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of observations in train: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training set &quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of observations in test: </span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">training_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">test_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">test_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training : </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test     : </span><span class="si">{</span><span class="n">test_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">test_end</span><span class="si">}</span><span class="s2"> (n=</span><span class="si">{</span><span class="n">test_length</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when printed.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Information displayed when printed.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="sa">f</span><span class="s2">&quot;Initial train size = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="sa">f</span><span class="s2">&quot;Window size        = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="sa">f</span><span class="s2">&quot;Return all indexes = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="sa">f</span><span class="s2">&quot;Verbose            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.split_one_step.OneStepAheadFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">externally_fitted</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="pandas.Index">Index</span> | <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame.
This is useful to visualize the folds in a more interpretable way.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>externally_fitted</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This argument is not used in this class.
It is included for API consistency. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list | pd.DataFrame: A list of lists containing the indices (position) of</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the fold. The list contains 2 lists with the following information:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>fold: fold number.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>[train_start, train_end]: list with the start and end positions of the
training set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>[test_start, test_end]: list with the start and end positions of the test
set. These are the observations used to evaluate the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>fit_forecaster: boolean indicating whether the forecaster should be fitted
in this fold.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>It is important to note that the returned values are the positions of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>observations and not the actual values of the index, so they can be used to</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>slice the data directly using iloc.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>following columns: 'fold', 'train_start', 'train_end', 'test_start',</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'test_end', 'fit_forecaster'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Following the python convention, the start index is inclusive and the end</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>index is exclusive. This means that the last index is not included in the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>slice.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_one_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">externally_fitted</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Split the time series data into train and test folds.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        X (pd.Series | pd.DataFrame | pd.Index | dict): Time series data or index to split.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        as_pandas (bool, optional): If True, the folds are returned as a DataFrame.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            This is useful to visualize the folds in a more interpretable way.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        externally_fitted (Any, optional): This argument is not used in this class.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            It is included for API consistency. Defaults to None.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        list | pd.DataFrame: A list of lists containing the indices (position) of</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        the fold. The list contains 2 lists with the following information:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        - fold: fold number.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        - [train_start, train_end]: list with the start and end positions of the</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            training set.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        - [test_start, test_end]: list with the start and end positions of the test</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        - fit_forecaster: boolean indicating whether the forecaster should be fitted</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            in this fold.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        It is important to note that the returned values are the positions of the</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        observations and not the actual values of the index, so they can be used to</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        slice the data directly using iloc.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;test_start&#39;,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        &#39;test_end&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        slice.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="p">)</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="p">)</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="n">fold</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])],</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="p">]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="p">]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                    <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                    <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                    <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="p">],</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">fold</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">fold</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;fold&quot;</span><span class="p">,</span> <span class="s2">&quot;train_index&quot;</span><span class="p">,</span> <span class="s2">&quot;test_index&quot;</span><span class="p">,</span> <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">return</span> <span class="n">fold</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h3 id="split_ts_cv">split_ts_cv</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.split_ts_cv" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.split_ts_cv</code>


</h2>

    <div class="doc doc-contents first">

        <p>Time series cross-validation splitting.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold" class="doc doc-heading">
            <code>TimeSeriesFold</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseFold (spotforecast2_safe.model_selection.split_base.BaseFold)" href="#spotforecast2_safe.model_selection.split_base.BaseFold">BaseFold</a></code></p>



        <p>Class to split time series data into train and test folds.</p>
<p>When used within a backtesting or hyperparameter search, the arguments
'initial_train_size', 'window_size' and 'differentiation' are not required
as they are automatically set by the backtesting or hyperparameter search
functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold.
This is also commonly referred to as the forecast horizon or test size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_train_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span> | <span title="pandas.Timestamp">Timestamp</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.</p>
<ul>
<li>If <code>None</code> or 0, the initial forecaster is not trained in the first fold.</li>
<li>If an integer, the number of observations used for initial training.</li>
<li>If a date string or pandas Timestamp, it is the last date included in
  the initial training set.</li>
</ul>
<p>Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fold_stride</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations that the start of the test set
advances between consecutive folds.</p>
<ul>
<li>If <code>None</code>, it defaults to the same value as <code>steps</code>, meaning that folds
  are placed back-to-back without overlap.</li>
<li>If <code>fold_stride &lt; steps</code>, test sets overlap and multiple forecasts will
  be generated for the same observations.</li>
<li>If <code>fold_stride &gt; steps</code>, gaps are left between consecutive test sets.</li>
</ul>
<p>Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>differentiation</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
<ul>
<li>If <code>True</code>, the forecaster is refitted in each fold.</li>
<li>If <code>False</code>, the forecaster is trained only in the first fold.</li>
<li>If an integer, the forecaster is trained in the first fold and then refitted
  every <code>refit</code> folds.</li>
</ul>
<p>Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fixed_train_size</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases
in each fold. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gap</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set
and the start of the test set. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_folds</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
<ul>
<li>If an integer, every 'skip_folds'-th is returned.</li>
<li>If a list, the indexes of the folds to skip.</li>
</ul>
<p>For example, if <code>skip_folds=3</code> and there are 10 folds, the returned folds are
0, 3, 6, and 9. If <code>skip_folds=[1, 2, 3]</code>, the returned folds are 0, 4, 5, 6, 7,
8, and 9. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_incomplete_fold</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include
fewer observations than <code>steps</code>. If <code>False</code>, the last fold is excluded if it
is incomplete. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all_indexes</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the
start and end indexes of each fold. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.steps">steps</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used to be predicted in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.initial_train_size">initial_train_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations used for initial training.
If <code>None</code> or 0, the initial forecaster is not trained in the first fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.fold_stride">fold_stride</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations that the start of the test set
advances between consecutive folds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.overlapping_folds">overlapping_folds</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the folds overlap.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.window_size">window_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations needed to generate the
autoregressive predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.differentiation">differentiation</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations to use for differentiation.
This is used to extend the <code>last_window</code> as many observations as the
differentiation order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.refit">refit</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to refit the forecaster in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.fixed_train_size">fixed_train_size</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the training size is fixed or increases in each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.gap">gap</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of observations between the end of the training set and the
start of the test set.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.skip_folds">skip_folds</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of folds to skip.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.allow_incomplete_fold">allow_incomplete_fold</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to allow the last fold to include fewer
observations than <code>steps</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.return_all_indexes">return_all_indexes</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return all indexes or only the start
and end indexes of each fold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.verbose">verbose</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print information about generated folds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic usage with fixed train size:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create sample time series data</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create fold splitter</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get folds</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">Number of folds: 4</span>
</code></pre></div>
    <p>Overlapping folds with custom stride:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">fold_stride</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First test fold covers [50, 80), second [57, 87), etc.</span>
</code></pre></div>
    <p>Return as pandas DataFrame:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds_df</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">folds_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">[&#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;, &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;, &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;]</span>
</code></pre></div>
    <p>Skip folds for faster evaluation:</p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">skip_folds</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">folds</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Returns folds 0, 2, 4, 6, ...</span>
</code></pre></div>


<details class="note" open>
  <summary>Note</summary>
  <p>Returned values are the positions of the observations and not the actual values of
the index, so they can be used to slice the data directly using iloc. For example,
if the input series is <code>X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</code>, the
<code>initial_train_size = 3</code>, <code>window_size = 2</code>, <code>steps = 4</code>, and <code>gap = 1</code>,
the output of the first fold will: [0, [0, 3], [1, 3], [3, 8], [4, 8], True].</p>
<p>The first element is the fold number, the first list <code>[0, 3]</code> indicates that
the training set goes from the first to the third observation. The second
list <code>[1, 3]</code> indicates that the last window seen by the forecaster during
training goes from the second to the third observation. The third list <code>[3, 8]</code>
indicates that the test set goes from the fourth to the eighth observation.
The fourth list <code>[4, 8]</code> indicates that the test set including the gap goes
from the fifth to the eighth observation. The boolean <code>False</code> indicates that
the forecaster should not be trained in this fold.</p>
<p>Following the python convention, the start index is inclusive and the end index is
exclusive. This means that the last index is not included in the slice.</p>
<p>As an example, with <code>initial_train_size=50</code>, <code>steps=30</code>, and <code>fold_stride=7</code>,
the first test fold will cover observations [50, 80), the second fold [57, 87),
and the third fold [64, 94). This configuration produces multiple forecasts
for the same observations, which is often desirable in rolling-origin
evaluation.</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesFold</span><span class="p">(</span><span class="n">BaseFold</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to split time series data into train and test folds.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    When used within a backtesting or hyperparameter search, the arguments</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    &#39;initial_train_size&#39;, &#39;window_size&#39; and &#39;differentiation&#39; are not required</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    as they are automatically set by the backtesting or hyperparameter search</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    functions.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        steps: Number of observations used to be predicted in each fold.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            This is also commonly referred to as the forecast horizon or test size.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        initial_train_size: Number of observations used for initial training.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">            - If `None` or 0, the initial forecaster is not trained in the first fold.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            - If an integer, the number of observations used for initial training.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            - If a date string or pandas Timestamp, it is the last date included in</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">              the initial training set.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        fold_stride: Number of observations that the start of the test set</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            advances between consecutive folds.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            - If `None`, it defaults to the same value as `steps`, meaning that folds</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">              are placed back-to-back without overlap.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            - If `fold_stride &lt; steps`, test sets overlap and multiple forecasts will</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">              be generated for the same observations.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            - If `fold_stride &gt; steps`, gaps are left between consecutive test sets.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        window_size: Number of observations needed to generate the</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            autoregressive predictors. Defaults to None.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        differentiation: Number of observations to use for differentiation.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            differentiation order. Defaults to None.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        refit: Whether to refit the forecaster in each fold.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            - If `True`, the forecaster is refitted in each fold.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            - If `False`, the forecaster is trained only in the first fold.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            - If an integer, the forecaster is trained in the first fold and then refitted</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">              every `refit` folds.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        fixed_train_size: Whether the training size is fixed or increases</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            in each fold. Defaults to True.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        gap: Number of observations between the end of the training set</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            and the start of the test set. Defaults to 0.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        skip_folds: Number of folds to skip.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            - If an integer, every &#39;skip_folds&#39;-th is returned.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            - If a list, the indexes of the folds to skip.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            For example, if `skip_folds=3` and there are 10 folds, the returned folds are</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            0, 3, 6, and 9. If `skip_folds=[1, 2, 3]`, the returned folds are 0, 4, 5, 6, 7,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            8, and 9. Defaults to None.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        allow_incomplete_fold: Whether to allow the last fold to include</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            fewer observations than `steps`. If `False`, the last fold is excluded if it</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            is incomplete. Defaults to True.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        return_all_indexes: Whether to return all indexes or only the</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            start and end indexes of each fold. Defaults to False.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        verbose: Whether to print information about generated folds.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        steps: Number of observations used to be predicted in each fold.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        initial_train_size: Number of observations used for initial training.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            If `None` or 0, the initial forecaster is not trained in the first fold.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        fold_stride: Number of observations that the start of the test set</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            advances between consecutive folds.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        overlapping_folds: Whether the folds overlap.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        window_size: Number of observations needed to generate the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            autoregressive predictors.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        differentiation: Number of observations to use for differentiation.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            This is used to extend the `last_window` as many observations as the</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">            differentiation order.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        refit: Whether to refit the forecaster in each fold.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        fixed_train_size: Whether the training size is fixed or increases in each fold.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        gap: Number of observations between the end of the training set and the</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            start of the test set.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        skip_folds: Number of folds to skip.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        allow_incomplete_fold: Whether to allow the last fold to include fewer</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            observations than `steps`.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        return_all_indexes: Whether to return all indexes or only the start</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            and end indexes of each fold.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        verbose: Whether to print information about generated folds.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Basic usage with fixed train size:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import TimeSeriesFold</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &gt;&gt;&gt; # Create sample time series data</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        &gt;&gt;&gt; dates = pd.date_range(&#39;2020-01-01&#39;, periods=100, freq=&#39;D&#39;)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series(np.arange(100), index=dates)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        &gt;&gt;&gt; # Create fold splitter</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ...     steps=10,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ...     refit=True,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        ...     fixed_train_size=True</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        &gt;&gt;&gt; # Get folds</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Number of folds: {len(folds)}&quot;)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        Number of folds: 4</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        Overlapping folds with custom stride:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        ...     steps=30,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        ...     fold_stride=7,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        ...     fixed_train_size=False</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        &gt;&gt;&gt; # First test fold covers [50, 80), second [57, 87), etc.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Return as pandas DataFrame:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(steps=10, initial_train_size=50)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        &gt;&gt;&gt; folds_df = cv.split(y, as_pandas=True)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        &gt;&gt;&gt; print(folds_df.columns.tolist())</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        [&#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;, &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;, &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Skip folds for faster evaluation:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        ...     steps=5,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        ...     initial_train_size=50,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        ...     skip_folds=2</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &gt;&gt;&gt; folds = cv.split(y)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &gt;&gt;&gt; # Returns folds 0, 2, 4, 6, ...</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Returned values are the positions of the observations and not the actual values of</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        the index, so they can be used to slice the data directly using iloc. For example,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        if the input series is `X = [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]`, the</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        `initial_train_size = 3`, `window_size = 2`, `steps = 4`, and `gap = 1`,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        the output of the first fold will: [0, [0, 3], [1, 3], [3, 8], [4, 8], True].</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        The first element is the fold number, the first list `[0, 3]` indicates that</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        the training set goes from the first to the third observation. The second</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        list `[1, 3]` indicates that the last window seen by the forecaster during</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        training goes from the second to the third observation. The third list `[3, 8]`</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        indicates that the test set goes from the fourth to the eighth observation.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        The fourth list `[4, 8]` indicates that the test set including the gap goes</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        from the fifth to the eighth observation. The boolean `False` indicates that</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        the forecaster should not be trained in this fold.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Following the python convention, the start index is inclusive and the end index is</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        exclusive. This means that the last index is not included in the slice.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        As an example, with `initial_train_size=50`, `steps=30`, and `fold_stride=7`,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        the first test fold will cover observations [50, 80), the second fold [57, 87),</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        and the third fold [64, 94). This configuration produces multiple forecasts</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        for the same observations, which is often desirable in rolling-origin</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        evaluation.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">fold_stride</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">differentiation</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">fixed_train_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">gap</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">skip_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">allow_incomplete_fold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">return_all_indexes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="n">initial_train_size</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">fold_stride</span><span class="o">=</span><span class="n">fold_stride</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">window_size</span><span class="o">=</span><span class="n">window_size</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="n">differentiation</span><span class="o">=</span><span class="n">differentiation</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">refit</span><span class="o">=</span><span class="n">refit</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">fixed_train_size</span><span class="o">=</span><span class="n">fixed_train_size</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">gap</span><span class="o">=</span><span class="n">gap</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">skip_folds</span><span class="o">=</span><span class="n">skip_folds</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="n">allow_incomplete_fold</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">return_all_indexes</span><span class="o">=</span><span class="n">return_all_indexes</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span> <span class="o">=</span> <span class="n">fold_stride</span> <span class="k">if</span> <span class="n">fold_stride</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">steps</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="n">refit</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="o">=</span> <span class="n">fixed_train_size</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">=</span> <span class="n">gap</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">=</span> <span class="n">skip_folds</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">allow_incomplete_fold</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Information displayed when printed.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            String representation of the TimeSeriesFold object.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="sa">f</span><span class="s2">&quot;Initial train size    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="sa">f</span><span class="s2">&quot;Steps                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="sa">f</span><span class="s2">&quot;Fold stride           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="sa">f</span><span class="s2">&quot;Overlapping folds     = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="sa">f</span><span class="s2">&quot;Window size           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="sa">f</span><span class="s2">&quot;Differentiation       = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="sa">f</span><span class="s2">&quot;Refit                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="sa">f</span><span class="s2">&quot;Fixed train size      = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="sa">f</span><span class="s2">&quot;Gap                   = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="sa">f</span><span class="s2">&quot;Skip folds            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="sa">f</span><span class="s2">&quot;Allow incomplete fold = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="sa">f</span><span class="s2">&quot;Return all indexes    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="sa">f</span><span class="s2">&quot;Verbose               = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="k">return</span> <span class="n">info</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;HTML representation of the object.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        The &quot;General Information&quot; section is expanded by default.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            HTML string representation for Jupyter notebooks.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="n">get_style_repr_html</span><span class="p">()</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="s2">        &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="s2">            &lt;p style=&quot;font-size: 1.5em; font-weight: bold; margin-block-start: 0.83em; margin-block-end: 0.83em;&quot;&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/p&gt;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="s2">            &lt;details open&gt;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="s2">                &lt;summary&gt;General Information&lt;/summary&gt;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="s2">                &lt;ul&gt;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Initial train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Steps:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Fold stride:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Overlapping folds:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Differentiation:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Refit:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Fixed train size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Gap:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Skip folds:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Allow incomplete fold:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="s2">                    &lt;li&gt;&lt;strong&gt;Return all indexes:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="s2">                &lt;/ul&gt;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="s2">            &lt;/details&gt;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="s2">        &lt;/div&gt;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Split the time series data into train and test folds.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            X: Time series data or index to split. Can be a pandas Series, DataFrame,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">                Index, or a dictionary of Series/DataFrames.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            as_pandas: If True, the folds are returned as a DataFrame. This is useful</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">                to visualize the folds in a more interpretable way. Defaults to False.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            A list of lists containing the indices (position) for each fold, or a</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            DataFrame if `as_pandas=True`. Each list contains 4 lists and a boolean</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">            with the following information:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            - **fold**: fold number.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            - **[train_start, train_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                    the training set.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            - **[last_window_start, last_window_end]**: list with the start and end</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                    positions of the last window seen by the forecaster during training.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                    The last window is used to generate the lags use as predictors. If</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">                    `differentiation` is included, the interval is extended as many</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                    observations as the differentiation order. If the argument `window_size`</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                    is `None`, this list is empty.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            - **[test_start, test_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                    the test set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            - **[test_start_with_gap, test_end_with_gap]**: list with the start and</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">                    end positions of the test set including the gap. The gap is the number</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                    of observations between the end of the training set and the start of</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">                    the test set.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            - **fit_forecaster**: boolean indicating whether the forecaster should be</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                    fitted in this fold.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            The returned values are the positions of the observations and not the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            actual values of the index, so they can be used to slice the data directly</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            using iloc.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">            index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            slice.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">window_size_as_date_offset</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="c1"># because the offset follows the calendar rules and the distance between</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="c1"># two dates may not be constant.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                    <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                    <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                    <span class="sa">f</span><span class="s2">&quot;the offset (forecaster.offset) is larger than the available &quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                    <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (forecaster.offset), &quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                    <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (forecaster.n_offsets) or increase the &quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                    <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                    <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                    <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                    <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                    <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                <span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                    <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                        <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                        <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>                        <span class="sa">f</span><span class="s2">&quot;and smaller than the length of the series (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                        <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                    <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="c1"># At least one observation after the gap to allow incomplete fold</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                    <span class="sa">f</span><span class="s2">&quot;The time series must have more than `initial_train_size + gap` &quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create at least one fold.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="c1"># At least one complete fold</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                    <span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + gap + steps` &quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create a minimum of one complete fold &quot;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                    <span class="sa">f</span><span class="s2">&quot;(allow_incomplete_fold=False).</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt;= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="sa">f</span><span class="s2">&quot;    steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                <span class="c1"># NOTE: If `fixed_train_size` the train size doesn&#39;t increase but</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                <span class="c1"># moves by `fold_stride` positions in each iteration. If `False`,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                <span class="c1"># the train size increases by `fold_stride` in each iteration.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>                <span class="c1"># NOTE: The train size doesn&#39;t increase and doesn&#39;t move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span><span class="p">:</span><span class="n">train_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                <span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                    <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span><span class="p">:</span><span class="n">test_iloc_start</span><span class="p">]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                    <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="p">),</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span><span class="p">:</span><span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="c1"># NOTE: Delete all incomplete folds at the end if not allowed</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">n_removed_folds</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="c1"># NOTE: While folds and the last &quot;test_index_with_gap&quot; is incomplete,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="c1"># calculating len of range objects</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">while</span> <span class="n">folds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="n">folds</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="n">n_removed_folds</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="c1"># Create a flag to know whether to train the forecaster</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>                <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>                <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                    <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>                <span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>                <span class="n">folds</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>                <span class="n">externally_fitted</span><span class="o">=</span><span class="n">externally_fitted</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>                <span class="n">n_removed_folds</span><span class="o">=</span><span class="n">n_removed_folds</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="n">index_to_skip</span><span class="o">=</span><span class="n">index_to_skip</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="p">[</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                    <span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                        <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                        <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                    <span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>                <span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>                <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="p">]</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>                <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                    <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                        <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                        <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                    <span class="p">],</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                        <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                        <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                        <span class="s2">&quot;last_window_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                        <span class="s2">&quot;last_window_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                        <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                        <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                        <span class="s2">&quot;test_start_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                        <span class="s2">&quot;test_end_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                    <span class="p">],</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>                <span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                        <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                        <span class="s2">&quot;train_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                        <span class="s2">&quot;last_window_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                        <span class="s2">&quot;test_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                        <span class="s2">&quot;test_index_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                        <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                    <span class="p">],</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>                <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="k">return</span> <span class="n">folds</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">folds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">externally_fitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">n_removed_folds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">index_to_skip</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print information about folds.</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            index: Index of the time series data.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">            folds: A list of lists containing the indices (position) for each fold.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">            externally_fitted: Whether an already trained forecaster is to be used.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            n_removed_folds: Number of folds removed.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">            index_to_skip: Number of folds skipped.</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Information of folds&quot;</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--------------------&quot;</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>                <span class="sa">f</span><span class="s2">&quot;An already trained forecaster is to be used. Window size: &quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of observations used for initial training: &quot;</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                    <span class="sa">f</span><span class="s2">&quot;    First </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2"> observation/s in training sets &quot;</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                    <span class="sa">f</span><span class="s2">&quot;are used for differentiation&quot;</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="sa">f</span><span class="s2">&quot;Number of observations used for backtesting: &quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of folds: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="sa">f</span><span class="s2">&quot;    Number skipped folds: &quot;</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index_to_skip</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">index_to_skip</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Number of steps per fold: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                <span class="sa">f</span><span class="s2">&quot;    Number of steps to the next fold (fold stride): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="sa">f</span><span class="s2">&quot;    Number of steps to exclude between last observed data &quot;</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="sa">f</span><span class="s2">&quot;(last window) and predictions (gap): </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="p">)</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="k">if</span> <span class="n">n_removed_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="sa">f</span><span class="s2">&quot;    The last </span><span class="si">{</span><span class="n">n_removed_folds</span><span class="si">}</span><span class="s2"> fold(s) have been excluded &quot;</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                <span class="sa">f</span><span class="s2">&quot;because they were incomplete.&quot;</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="p">)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Last fold only includes </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span><span class="si">}</span><span class="s2"> observations.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>            <span class="n">differentiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">):</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>            <span class="n">is_fold_skipped</span> <span class="o">=</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">has_training</span> <span class="o">=</span> <span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>            <span class="n">training_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">differentiation</span><span class="p">]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="n">training_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="n">training_length</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>                <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">differentiation</span> <span class="k">if</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="n">validation_start</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="n">validation_end</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="n">validation_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fold: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="k">if</span> <span class="n">is_fold_skipped</span><span class="p">:</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Fold skipped&quot;</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">externally_fitted</span> <span class="ow">and</span> <span class="n">has_training</span><span class="p">:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>                    <span class="sa">f</span><span class="s2">&quot;    Training:   </span><span class="si">{</span><span class="n">training_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">training_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">training_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>                    <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Training:   No training in this fold&quot;</span><span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                    <span class="sa">f</span><span class="s2">&quot;    Validation: </span><span class="si">{</span><span class="n">validation_start</span><span class="si">}</span><span class="s2"> -- </span><span class="si">{</span><span class="n">validation_end</span><span class="si">}</span><span class="s2">  &quot;</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                    <span class="sa">f</span><span class="s2">&quot;(n=</span><span class="si">{</span><span class="n">validation_length</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                <span class="p">)</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Information displayed when printed.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of the TimeSeriesFold object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Information displayed when printed.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        String representation of the TimeSeriesFold object.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">info</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="sa">f</span><span class="s2">&quot;Initial train size    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="sa">f</span><span class="s2">&quot;Steps                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="sa">f</span><span class="s2">&quot;Fold stride           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="sa">f</span><span class="s2">&quot;Overlapping folds     = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">overlapping_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="sa">f</span><span class="s2">&quot;Window size           = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="sa">f</span><span class="s2">&quot;Differentiation       = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="sa">f</span><span class="s2">&quot;Refit                 = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="sa">f</span><span class="s2">&quot;Fixed train size      = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="sa">f</span><span class="s2">&quot;Gap                   = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="sa">f</span><span class="s2">&quot;Skip folds            = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="sa">f</span><span class="s2">&quot;Allow incomplete fold = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="sa">f</span><span class="s2">&quot;Return all indexes    = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="sa">f</span><span class="s2">&quot;Verbose               = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">return</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold.split" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split the time series data into train and test folds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="pandas.Index">Index</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series data or index to split. Can be a pandas Series, DataFrame,
Index, or a dictionary of Series/DataFrames.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>as_pandas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the folds are returned as a DataFrame. This is useful
to visualize the folds in a more interpretable way. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of lists containing the indices (position) for each fold, or a</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame if <code>as_pandas=True</code>. Each list contains 4 lists and a boolean</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with the following information:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>fold</strong>: fold number.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[train_start, train_end]</strong>: list with the start and end positions of
    the training set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[last_window_start, last_window_end]</strong>: list with the start and end
    positions of the last window seen by the forecaster during training.
    The last window is used to generate the lags use as predictors. If
    <code>differentiation</code> is included, the interval is extended as many
    observations as the differentiation order. If the argument <code>window_size</code>
    is <code>None</code>, this list is empty.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[test_start, test_end]</strong>: list with the start and end positions of
    the test set. These are the observations used to evaluate the forecaster.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>[test_start_with_gap, test_end_with_gap]</strong>: list with the start and
    end positions of the test set including the gap. The gap is the number
    of observations between the end of the training set and the start of
    the test set.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li><strong>fit_forecaster</strong>: boolean indicating whether the forecaster should be
    fitted in this fold.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The returned values are the positions of the observations and not the
actual values of the index, so they can be used to slice the data directly
using iloc.</p>
<p>If <code>as_pandas</code> is <code>True</code>, the folds are returned as a DataFrame with the
following columns: 'fold', 'train_start', 'train_end', 'last_window_start',
'last_window_end', 'test_start', 'test_end', 'test_start_with_gap',
'test_end_with_gap', 'fit_forecaster'.</p>
<p>Following the python convention, the start index is inclusive and the end
index is exclusive. This means that the last index is not included in the
slice.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/split_ts_cv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">X</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">],</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Split the time series data into train and test folds.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        X: Time series data or index to split. Can be a pandas Series, DataFrame,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            Index, or a dictionary of Series/DataFrames.</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        as_pandas: If True, the folds are returned as a DataFrame. This is useful</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            to visualize the folds in a more interpretable way. Defaults to False.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        A list of lists containing the indices (position) for each fold, or a</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        DataFrame if `as_pandas=True`. Each list contains 4 lists and a boolean</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        with the following information:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        - **fold**: fold number.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        - **[train_start, train_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">                the training set.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        - **[last_window_start, last_window_end]**: list with the start and end</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">                positions of the last window seen by the forecaster during training.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">                The last window is used to generate the lags use as predictors. If</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">                `differentiation` is included, the interval is extended as many</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">                observations as the differentiation order. If the argument `window_size`</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">                is `None`, this list is empty.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        - **[test_start, test_end]**: list with the start and end positions of</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">                the test set. These are the observations used to evaluate the forecaster.</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        - **[test_start_with_gap, test_end_with_gap]**: list with the start and</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">                end positions of the test set including the gap. The gap is the number</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">                of observations between the end of the training set and the start of</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">                the test set.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        - **fit_forecaster**: boolean indicating whether the forecaster should be</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                fitted in this fold.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        The returned values are the positions of the observations and not the</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        actual values of the index, so they can be used to slice the data directly</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        using iloc.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        If `as_pandas` is `True`, the folds are returned as a DataFrame with the</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        following columns: &#39;fold&#39;, &#39;train_start&#39;, &#39;train_end&#39;, &#39;last_window_start&#39;,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &#39;last_window_end&#39;, &#39;test_start&#39;, &#39;test_end&#39;, &#39;test_start_with_gap&#39;,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &#39;test_end_with_gap&#39;, &#39;fit_forecaster&#39;.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        Following the python convention, the start index is inclusive and the end</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        index is exclusive. This means that the last index is not included in the</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        slice.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="sa">f</span><span class="s2">&quot;X must be a pandas Series, DataFrame, Index or a dictionary. &quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">window_size_as_date_offset</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="c1"># Calculate the window_size in steps. This is not a exact calculation</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="c1"># because the offset follows the calendar rules and the distance between</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="c1"># two dates may not be constant.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">first_valid_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">window_size_idx_start</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">first_valid_index</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">window_size_idx_end</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size_idx_end</span> <span class="o">-</span> <span class="n">window_size_idx_start</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                <span class="sa">f</span><span class="s2">&quot;The length of `y` (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">), must be greater than or equal &quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="sa">f</span><span class="s2">&quot;to the window size (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">). This is because  &quot;</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>                <span class="sa">f</span><span class="s2">&quot;the offset (forecaster.offset) is larger than the available &quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="sa">f</span><span class="s2">&quot;data. Try to decrease the size of the offset (forecaster.offset), &quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="sa">f</span><span class="s2">&quot;the number of `n_offsets` (forecaster.n_offsets) or increase the &quot;</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="sa">f</span><span class="s2">&quot;size of `y`.&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="s2">&quot;To use split method when `initial_train_size` is None, &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="s2">&quot;`window_size` must be an integer greater than 0. &quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="s2">&quot;Although no initial training is done and all data is used to &quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="s2">&quot;evaluate the model, the first `window_size` observations are &quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="s2">&quot;needed to create the initial predictors. Got `window_size` = None.&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`. &quot;</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="s2">&quot;Set `refit` to `False` if you want to use `initial_train_size = None`.&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>  <span class="c1"># Reset to None later</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="s2">&quot;Last window cannot be calculated because `window_size` is None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">IgnoredArgumentWarning</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="n">externally_fitted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">date_input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">if</span> <span class="n">window_size_as_date_offset</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                    <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                    <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>                    <span class="sa">f</span><span class="s2">&quot;and smaller than the length of the series (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>                    <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="c1"># At least one observation after the gap to allow incomplete fold</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="sa">f</span><span class="s2">&quot;The time series must have more than `initial_train_size + gap` &quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="sa">f</span><span class="s2">&quot;observations to create at least one fold.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="sa">f</span><span class="s2">&quot;    Required &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="c1"># At least one complete fold</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="sa">f</span><span class="s2">&quot;The time series must have at least `initial_train_size + gap + steps` &quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="sa">f</span><span class="s2">&quot;observations to create a minimum of one complete fold &quot;</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="sa">f</span><span class="s2">&quot;(allow_incomplete_fold=False).</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="sa">f</span><span class="s2">&quot;    Required &gt;= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                <span class="sa">f</span><span class="s2">&quot;    steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="c1"># NOTE: If `fixed_train_size` the train size doesn&#39;t increase but</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>            <span class="c1"># moves by `fold_stride` positions in each iteration. If `False`,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>            <span class="c1"># the train size increases by `fold_stride` in each iteration.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_train_size</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="n">train_iloc_end</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="c1"># NOTE: The train size doesn&#39;t increase and doesn&#39;t move.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">train_iloc_start</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">train_iloc_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="n">test_iloc_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fold_stride</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="n">last_window_iloc_start</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">test_iloc_end</span> <span class="o">=</span> <span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">partitions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">train_iloc_start</span><span class="p">:</span><span class="n">train_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                <span class="n">idx</span><span class="p">[</span><span class="n">last_window_iloc_start</span><span class="p">:</span><span class="n">test_iloc_start</span><span class="p">]</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="p">),</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span><span class="p">:</span><span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="n">idx</span><span class="p">[</span><span class="n">test_iloc_start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gap</span> <span class="p">:</span> <span class="n">test_iloc_end</span><span class="p">],</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="c1"># NOTE: Delete all incomplete folds at the end if not allowed</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">n_removed_folds</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># NOTE: While folds and the last &quot;test_index_with_gap&quot; is incomplete,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="c1"># calculating len of range objects</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">while</span> <span class="n">folds</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">folds</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">n_removed_folds</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># Replace partitions inside folds with length 0 with `None`</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="p">[</span><span class="n">partition</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">fold</span><span class="p">]</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="c1"># Create a flag to know whether to train the forecaster</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">fit_forecaster</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">fit_forecaster</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">refit</span><span class="p">):</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)):</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">if</span> <span class="n">fit_forecaster</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">index_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)),</span> <span class="n">index_to_keep</span><span class="p">,</span> <span class="n">assume_unique</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_to_skip</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">index_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_folds</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">folds</span><span class="p">)]</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_print_info</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">folds</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>            <span class="n">externally_fitted</span><span class="o">=</span><span class="n">externally_fitted</span><span class="p">,</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="n">n_removed_folds</span><span class="o">=</span><span class="n">n_removed_folds</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="n">index_to_skip</span><span class="o">=</span><span class="n">index_to_skip</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span><span class="n">fold</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">index_to_skip</span><span class="p">]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="c1"># NOTE: +1 to prevent iloc pandas from deleting the last observation</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="n">folds</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="p">[</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                    <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">fold</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>            <span class="p">]</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="p">]</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">if</span> <span class="n">externally_fitted</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_train_size</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">folds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">if</span> <span class="n">as_pandas</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>                <span class="n">fold</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_all_indexes</span><span class="p">:</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>                <span class="n">data</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>                    <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fold</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> <span class="p">[</span><span class="n">fold</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">folds</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="p">],</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>                    <span class="s2">&quot;train_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>                    <span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                    <span class="s2">&quot;last_window_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                    <span class="s2">&quot;last_window_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                    <span class="s2">&quot;test_start&quot;</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                    <span class="s2">&quot;test_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                    <span class="s2">&quot;test_start_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                    <span class="s2">&quot;test_end_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="p">],</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="p">)</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">folds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                <span class="n">data</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                    <span class="s2">&quot;fold&quot;</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                    <span class="s2">&quot;train_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                    <span class="s2">&quot;last_window_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                    <span class="s2">&quot;test_index&quot;</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                    <span class="s2">&quot;test_index_with_gap&quot;</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                    <span class="s2">&quot;fit_forecaster&quot;</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                <span class="p">],</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="k">return</span> <span class="n">folds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="utilities-and-metrics">Utilities and Metrics</h2>
<h3 id="utils_common">utils_common</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.utils_common" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.utils_common</code>


</h2>

    <div class="doc doc-contents first">

        <p>Common validation and initialization utilities for model selection.</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="spotforecast2_safe.model_selection.utils_common.OneStepAheadValidationWarning" class="doc doc-heading">
            <code>OneStepAheadValidationWarning</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="UserWarning">UserWarning</span></code></p>



        <p>Warning used when validation is performed with one-step-ahead predictions.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/spotforecast2_safe/model_selection/utils_common.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">class</span><span class="w"> </span><span class="nc">OneStepAheadValidationWarning</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">):</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Warning used when validation is performed with one-step-ahead predictions.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.utils_common.check_backtesting_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_backtesting_input</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">add_aggregated_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval_method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">freeze_params</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This is a helper function to check most inputs of backtesting functions in
modules <code>model_selection</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span>[<span title="str">str</span> | <span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_aggregated_metric</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the aggregated metrics (average, weighted average and pooling)
over all levels are also returned (only multiseries).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for uni-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for multi-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="list">list</span>[<span title="float">float</span>] | <span title="tuple">tuple</span>[<span title="float">float</span>] | <span title="str">str</span> | <span title="object">object</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether probabilistic predictions should be estimated and the
method to use. The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1).
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must
be between 0 and 100 inclusive. For example, a 95% confidence interval can
be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10,
50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction
intervals.</li>
<li>'conformal': Employs the conformal prediction split method for
interval estimation.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The confidence intervals used in ForecasterStats are (1 - alpha) %.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when estimating prediction
intervals.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of prediction
error to create prediction intervals.  If <code>False</code>, out_sample_residuals
are used if they are already stored inside the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected based on the predicted values
(binned selection).
If <code>False</code>, residuals are selected randomly.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to ensure reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make the predictions are also returned.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>, then the number of jobs is
set to the number of cores. If 'auto', <code>n_jobs</code> is set using the function
select_n_jobs_fit_forecaster.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>freeze_params</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determines whether to freeze the model parameters after the first fit
for estimators that perform automatic model selection.</p>
<ul>
<li>If <code>True</code>, the model parameters found during the first fit (e.g., order
and seasonal_order for Arima, or smoothing parameters for Ets) are reused
in all subsequent refits. This avoids re-running the automatic selection
procedure in each fold and reduces runtime.</li>
<li>If <code>False</code>, automatic model selection is performed independently in each
refit, allowing parameters to adapt across folds. This increases runtime
and adds a <code>params</code> column to the output with the parameters selected per
fold.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, spotforecast warnings will be suppressed during the backtesting
process.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection.utils_common</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_backtesting_input</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">gap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="n">fixed_train_size</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="n">allow_incomplete_fold</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_backtesting_input</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span>    <span class="n">metric</span><span class="o">=</span><span class="n">mean_squared_error</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">... </span>    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/utils_common.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_backtesting_input</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">cv</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">add_aggregated_metric</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">freeze_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    This is a helper function to check most inputs of backtesting functions in</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    modules `model_selection`.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        forecaster: Forecaster model.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        cv: TimeSeriesFold object with the information needed to split the data into folds.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        metric: Metric used to quantify the goodness of fit of the model.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        add_aggregated_metric: If `True`, the aggregated metrics (average, weighted average and pooling)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">            over all levels are also returned (only multiseries).</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        y: Training time series for uni-series forecasters.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        series: Training time series for multi-series forecasters.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        exog: Exogenous variables.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        interval: Specifies whether probabilistic predictions should be estimated and the</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            method to use. The following options are supported:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0 and 1).</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            - If `list` or `tuple`: Sequence of percentiles to compute, each value must</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            be between 0 and 100 inclusive. For example, a 95% confidence interval can</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">            50 and 90) as `interval = [10, 50, 90]`.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">            - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be generated.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">            - If scipy.stats distribution object, the distribution parameters will</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">            be estimated for each prediction.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">            - If None, no probabilistic predictions are estimated.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        interval_method: Technique used to estimate prediction intervals. Available options:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            intervals.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            interval estimation.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        alpha: The confidence intervals used in ForecasterStats are (1 - alpha) %.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        n_boot: Number of bootstrapping iterations to perform when estimating prediction</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            intervals.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        use_in_sample_residuals: If `True`, residuals from the training data are used as proxy of prediction</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            error to create prediction intervals.  If `False`, out_sample_residuals</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            are used if they are already stored inside the forecaster.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        use_binned_residuals: If `True`, residuals are selected based on the predicted values</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            (binned selection).</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            If `False`, residuals are selected randomly.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        random_state: Seed for the random number generator to ensure reproducibility.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        return_predictors: If `True`, the predictors used to make the predictions are also returned.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        n_jobs: The number of jobs to run in parallel. If `-1`, then the number of jobs is</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            set to the number of cores. If &#39;auto&#39;, `n_jobs` is set using the function</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            select_n_jobs_fit_forecaster.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        freeze_params: Determines whether to freeze the model parameters after the first fit</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            for estimators that perform automatic model selection.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            - If `True`, the model parameters found during the first fit (e.g., order</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            and seasonal_order for Arima, or smoothing parameters for Ets) are reused</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            in all subsequent refits. This avoids re-running the automatic selection</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            procedure in each fold and reduces runtime.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            - If `False`, automatic model selection is performed independently in each</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            refit, allowing parameters to adapt across folds. This increases runtime</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            and adds a `params` column to the output with the parameters selected per</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            fold.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        show_progress: Whether to show a progress bar.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        suppress_warnings: If `True`, spotforecast warnings will be suppressed during the backtesting</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            process.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection.utils_common import check_backtesting_input</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import TimeSeriesFold</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        &gt;&gt;&gt; from sklearn.metrics import mean_squared_error</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(LinearRegression(), lags=2)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        ...     steps=3,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        ...     initial_train_size=5,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        ...     gap=0,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        ...     refit=False,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        ...     fixed_train_size=False,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        ...     allow_incomplete_fold=True</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &gt;&gt;&gt; check_backtesting_input(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        ...     forecaster=forecaster,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ...     cv=cv,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        ...     metric=mean_squared_error,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ...     y=y</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">cv_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">!=</span> <span class="s2">&quot;TimeSeriesFold&quot;</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`cv` must be a &#39;TimeSeriesFold&#39; object. Got &#39;</span><span class="si">{</span><span class="n">cv_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">steps</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">steps</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">gap</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">gap</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">allow_incomplete_fold</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">allow_incomplete_fold</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">refit</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">refit</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="s2">&quot;ForecasterStats&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="p">]</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">forecasters_direct</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="p">]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="n">forecasters_multi_no_dict</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="s2">&quot;ForecasterRnn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="p">]</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">]</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="c1"># NOTE: ForecasterStats has interval but not with bootstrapping or conformal</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">forecasters_boot_conformal</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="p">]</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">forecasters_return_predictors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="p">]</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`y` must be a pandas Series.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_no_dict</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`series` must be a pandas DataFrame.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;series&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="c1"># NOTE: Checks are not need as they are done in the function</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="c1"># `check_preprocess_series` that is used before `check_backtesting_input`</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="c1"># in the backtesting function.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;series&quot;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="c1"># NOTE: Checks are not need as they are done in the function</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="c1"># `check_preprocess_exog_multiseries` that is used before</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="c1"># `check_backtesting_input` in the backtesting function.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="k">pass</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                    <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                <span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s2">&quot;differentiation&quot;</span><span class="p">):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">!=</span> <span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">dict</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                    <span class="sa">f</span><span class="s2">&quot;When using a dict as `differentiation` in ForecasterRecursiveMultiSeries, &quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                    <span class="sa">f</span><span class="s2">&quot;the `differentiation` included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">) must be &quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                    <span class="sa">f</span><span class="s2">&quot;the same as the maximum `differentiation` included in the forecaster &quot;</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                    <span class="sa">f</span><span class="s2">&quot;The differentiation included in the forecaster &quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">) differs from the differentiation &quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="sa">f</span><span class="s2">&quot;included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">forecaster</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">tseries</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">DateOffset</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="p">):</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="c1"># NOTE: Checks when initial_train_size is not None cannot be done here</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="c1"># because the forecaster is not fitted yet and we don&#39;t know the</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="c1"># window_size since pd.DateOffset is not a fixed window size.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">if</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="sa">f</span><span class="s2">&quot;`initial_train_size` must be an integer greater than &quot;</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>                <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>                <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">) or &quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="sa">f</span><span class="s2">&quot;a date within this range of the index.&quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">elif</span> <span class="n">initial_train_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">date_input</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="k">if</span> <span class="p">(</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="p">):</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">if</span> <span class="n">allow_incomplete_fold</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="c1"># At least one observation after the gap to allow incomplete fold</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="k">if</span> <span class="n">data_length</span> <span class="o">&lt;=</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` must have more than `initial_train_size + gap` &quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create at least one fold.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt; </span><span class="si">{</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>                <span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="c1"># At least one complete fold</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="k">if</span> <span class="n">data_length</span> <span class="o">&lt;</span> <span class="n">initial_train_size</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">+</span> <span class="n">steps</span><span class="p">:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` must have at least `initial_train_size + gap + steps` &quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                    <span class="sa">f</span><span class="s2">&quot;observations to create a minimum of one complete fold &quot;</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                    <span class="sa">f</span><span class="s2">&quot;(allow_incomplete_fold=False).</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                    <span class="sa">f</span><span class="s2">&quot;    Time series length: </span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="sa">f</span><span class="s2">&quot;    Required &gt;= </span><span class="si">{</span><span class="n">initial_train_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                    <span class="sa">f</span><span class="s2">&quot;    initial_train_size: </span><span class="si">{</span><span class="n">initial_train_size</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                    <span class="sa">f</span><span class="s2">&quot;    gap: </span><span class="si">{</span><span class="n">gap</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                    <span class="sa">f</span><span class="s2">&quot;    steps: </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>                <span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ForecasterStats&quot;</span><span class="p">,</span> <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="sa">f</span><span class="s2">&quot;When using </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">, `initial_train_size` must be an &quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="sa">f</span><span class="s2">&quot;integer smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                    <span class="s2">&quot;`forecaster` must be already trained if no `initial_train_size` &quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                    <span class="s2">&quot;is provided.&quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="k">if</span> <span class="n">refit</span><span class="p">:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                    <span class="s2">&quot;`refit` is only allowed when `initial_train_size` is not `None`.&quot;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterStats&quot;</span> <span class="ow">and</span> <span class="n">cv</span><span class="o">.</span><span class="n">skip_folds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="s2">&quot;`skip_folds` is not allowed for ForecasterStats. Set it to `None`.&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_aggregated_metric</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`add_aggregated_metric` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_boot</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">n_boot</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_boot` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">n_boot</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_in_sample_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_in_sample_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">use_binned_residuals</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`use_binned_residuals` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">random_state</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="sa">f</span><span class="s2">&quot;`random_state` must be an integer greater than 0. Got </span><span class="si">{</span><span class="n">random_state</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_predictors</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`return_predictors` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">freeze_params</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`freeze_params` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n_jobs</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n_jobs</span> <span class="o">!=</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`n_jobs` must be an integer or `&#39;auto&#39;`. Got </span><span class="si">{</span><span class="n">n_jobs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="k">if</span> <span class="n">interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_boot_conformal</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="k">if</span> <span class="n">interval_method</span> <span class="o">==</span> <span class="s2">&quot;conformal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                        <span class="sa">f</span><span class="s2">&quot;When `interval_method` is &#39;conformal&#39;, `interval` must &quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                        <span class="sa">f</span><span class="s2">&quot;be a float or a list/tuple defining a symmetric interval. &quot;</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                        <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                    <span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="k">elif</span> <span class="n">interval_method</span> <span class="o">==</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                    <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="s2">&quot;_pdf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                    <span class="ow">or</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="s2">&quot;fit&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="p">):</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                        <span class="sa">f</span><span class="s2">&quot;When `interval_method` is &#39;bootstrapping&#39;, `interval` &quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                        <span class="sa">f</span><span class="s2">&quot;must be a float, a list or tuple of floats, a &quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                        <span class="sa">f</span><span class="s2">&quot;scipy.stats distribution object (with methods `_pdf` and &quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                        <span class="sa">f</span><span class="s2">&quot;`fit`) or the string &#39;bootstrapping&#39;. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                    <span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                                <span class="sa">f</span><span class="s2">&quot;`interval` must be a list or tuple of floats. &quot;</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>                            <span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>                        <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>                        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">interval</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>                            <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mf">100.0</span><span class="p">):</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>                                    <span class="s2">&quot;When `interval` is a list or tuple, all values must be &quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                                    <span class="s2">&quot;between 0 and 100 inclusive.&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                                <span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>                    <span class="k">if</span> <span class="n">interval</span> <span class="o">!=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>                            <span class="sa">f</span><span class="s2">&quot;When `interval` is a string, it must be &#39;bootstrapping&#39;.&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>                            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>                        <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                    <span class="sa">f</span><span class="s2">&quot;`interval_method` must be &#39;bootstrapping&#39; or &#39;conformal&#39;. &quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                    <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">interval_method</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                    <span class="sa">f</span><span class="s2">&quot;`interval` is not supported for </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">. Class &quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                    <span class="sa">f</span><span class="s2">&quot;probabilities are returned by default during backtesting, &quot;</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                    <span class="sa">f</span><span class="s2">&quot;set `interval=None`.&quot;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="k">if</span> <span class="n">return_predictors</span> <span class="ow">and</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecasters_return_predictors</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="sa">f</span><span class="s2">&quot;`return_predictors` is only allowed for forecasters of type &quot;</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">forecasters_return_predictors</span><span class="si">}</span><span class="s2">. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_direct</span> <span class="ow">and</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">max_step</span> <span class="o">&lt;</span> <span class="n">steps</span> <span class="o">+</span> <span class="n">gap</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="sa">f</span><span class="s2">&quot;When using a </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">, the combination of steps &quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="sa">f</span><span class="s2">&quot;+ gap (</span><span class="si">{</span><span class="n">steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">gap</span><span class="si">}</span><span class="s2">) cannot be greater than the `steps` parameter &quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="sa">f</span><span class="s2">&quot;declared when the forecaster is initialized (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">max_step</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.utils_common.check_one_step_ahead_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_one_step_ahead_input</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This is a helper function to check most inputs of hyperparameter tuning
functions in modules <code>model_selection</code> when using a <code>OneStepAheadFold</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OneStepAheadFold object with the information needed to split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span>[<span title="str">str</span> | <span title="typing.Callable">Callable</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for uni-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>series</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series for multi-series forecasters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, spotforecast warnings will be suppressed during the hyperparameter
search.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection.utils_common</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_one_step_ahead_input</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">OneStepAheadFold</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_squared_error</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">OneStepAheadFold</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">return_all_predictions</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">check_one_step_ahead_input</span><span class="p">(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>    <span class="n">metric</span><span class="o">=</span><span class="n">mean_squared_error</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="n">y</span><span class="o">=</span><span class="n">y</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/utils_common.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_one_step_ahead_input</span><span class="p">(</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">cv</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    This is a helper function to check most inputs of hyperparameter tuning</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    functions in modules `model_selection` when using a `OneStepAheadFold`.</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        forecaster: Forecaster model.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        cv: OneStepAheadFold object with the information needed to split the data into folds.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">        metric: Metric used to quantify the goodness of fit of the model.</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        y: Training time series for uni-series forecasters.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        series: Training time series for multi-series forecasters.</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">        exog: Exogenous variables.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        show_progress: Whether to show a progress bar.</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">        suppress_warnings: If `True`, spotforecast warnings will be suppressed during the hyperparameter</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            search.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        None</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection.utils_common import check_one_step_ahead_input</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import OneStepAheadFold</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        &gt;&gt;&gt; from sklearn.metrics import mean_squared_error</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(LinearRegression(), lags=2)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        &gt;&gt;&gt; cv = OneStepAheadFold(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        ...     initial_train_size=5,</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        ...     return_all_predictions=False</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        &gt;&gt;&gt; check_one_step_ahead_input(</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        ...     forecaster=forecaster,</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        ...     cv=cv,</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        ...     metric=mean_squared_error,</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        ...     y=y</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="n">cv_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">cv</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="k">if</span> <span class="n">cv_name</span> <span class="o">!=</span> <span class="s2">&quot;OneStepAheadFold&quot;</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`cv` must be a &#39;OneStepAheadFold&#39; object. Got &#39;</span><span class="si">{</span><span class="n">cv_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">initial_train_size</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="n">forecasters_one_step_ahead</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="p">]</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecasters_one_step_ahead</span><span class="p">:</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="sa">f</span><span class="s2">&quot;Only forecasters of type </span><span class="si">{</span><span class="n">forecasters_one_step_ahead</span><span class="si">}</span><span class="s2"> are allowed &quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="sa">f</span><span class="s2">&quot;when using `cv` of type `OneStepAheadFold`. Got </span><span class="si">{</span><span class="n">forecaster_name</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">forecasters_uni</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="p">]</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="n">forecasters_multi_no_dict</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="p">]</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="n">forecasters_multi_dict</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">]</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`y` must be a pandas Series. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_no_dict</span><span class="p">:</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`series` must be a pandas DataFrame. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;series&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="c1"># NOTE: Checks are not need as they are done in the function</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="c1"># `check_preprocess_series` that is used before `check_one_step_ahead_input`</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="c1"># in the backtesting function.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="n">data_name</span> <span class="o">=</span> <span class="s2">&quot;series&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">serie</span><span class="p">])</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series</span><span class="p">])</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_multi_dict</span><span class="p">:</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="c1"># NOTE: Checks are not need as they are done in the function</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="c1"># `check_preprocess_exog_multiseries` that is used before</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="c1"># `check_backtesting_input` in the backtesting function.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="k">pass</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>                    <span class="sa">f</span><span class="s2">&quot;`exog` must be a pandas Series, DataFrame or None. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>                <span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="s2">&quot;differentiation&quot;</span><span class="p">):</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="k">if</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span> <span class="o">!=</span> <span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>            <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>                <span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">dict</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="p">):</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>                    <span class="sa">f</span><span class="s2">&quot;When using a dict as `differentiation` in ForecasterRecursiveMultiSeries, &quot;</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>                    <span class="sa">f</span><span class="s2">&quot;the `differentiation` included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">) must be &quot;</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>                    <span class="sa">f</span><span class="s2">&quot;the same as the maximum `differentiation` included in the forecaster &quot;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                <span class="p">)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                    <span class="sa">f</span><span class="s2">&quot;The differentiation included in the forecaster &quot;</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                    <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">differentiation_max</span><span class="si">}</span><span class="s2">) differs from the differentiation &quot;</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                    <span class="sa">f</span><span class="s2">&quot;included in the cv (</span><span class="si">{</span><span class="n">cv</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">). Set the same value &quot;</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                    <span class="sa">f</span><span class="s2">&quot;for both using the `differentiation` argument.&quot;</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>                <span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>            <span class="sa">f</span><span class="s2">&quot;`metric` must be a string, a callable function, or a list containing &quot;</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="sa">f</span><span class="s2">&quot;multiple strings and/or callables. Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="n">forecasters_uni</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="n">index</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">_extract_index</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>    <span class="n">initial_train_size</span> <span class="o">=</span> <span class="n">date_to_index_position</span><span class="p">(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">date_input</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="n">date_literal</span><span class="o">=</span><span class="s2">&quot;initial_train_size&quot;</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="p">)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">if</span> <span class="n">initial_train_size</span> <span class="o">&lt;</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span> <span class="ow">or</span> <span class="n">initial_train_size</span> <span class="o">&gt;=</span> <span class="n">data_length</span><span class="p">:</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="sa">f</span><span class="s2">&quot;If `initial_train_size` is an integer, it must be greater than &quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="sa">f</span><span class="s2">&quot;the `window_size` of the forecaster (</span><span class="si">{</span><span class="n">forecaster</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">) &quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="sa">f</span><span class="s2">&quot;and smaller than the length of `</span><span class="si">{</span><span class="n">data_name</span><span class="si">}</span><span class="s2">` (</span><span class="si">{</span><span class="n">data_length</span><span class="si">}</span><span class="s2">). If &quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="sa">f</span><span class="s2">&quot;it is a date, it must be within this range of the index.&quot;</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>        <span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_progress</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`show_progress` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`suppress_warnings` must be a boolean: `True`, `False`.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">suppress_warnings</span><span class="p">:</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="s2">&quot;One-step-ahead predictions are used for faster model comparison, but they &quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="s2">&quot;may not fully represent multi-step prediction performance. It is recommended &quot;</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="s2">&quot;to backtest the final model for a more accurate multi-step performance &quot;</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="s2">&quot;estimate.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="n">OneStepAheadValidationWarning</span><span class="p">,</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.utils_common.initialize_lags_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_lags_grid</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">lags_grid</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize lags grid and lags label for model selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model. ForecasterRecursive, ForecasterDirect,
ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lags_grid</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>]] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="int">int</span> | <span title="list">list</span>[<span title="int">int</span>] | <span title="numpy.ndarray">ndarray</span>[<span title="int">int</span>] | <span title="range">range</span>[<span title="int">int</span>]]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of lags to try, containing int, lists, numpy ndarray, or range
objects. If <code>dict</code>, the keys are used as labels in the <code>results</code>
DataFrame, and the values are used as the lists of lags to try.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(lags_grid, lags_label)
- lags_grid (dict): Dictionary with lags configuration for each iteration.
- lags_label (str): Label for lags representation in the results object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection.utils_common</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_lags_grid</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">lags_grid</span><span class="p">,</span> <span class="n">lags_label</span> <span class="o">=</span> <span class="n">initialize_lags_grid</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">lags_grid</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">{&#39;2&#39;: 2, &#39;4&#39;: 4}</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lags_label</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">values</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/utils_common.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize_lags_grid</span><span class="p">(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">lags_grid</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">range</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="p">)</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Initialize lags grid and lags label for model selection.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        forecaster: Forecaster model. ForecasterRecursive, ForecasterDirect,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            ForecasterRecursiveMultiSeries, ForecasterDirectMultiVariate.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        lags_grid: Lists of lags to try, containing int, lists, numpy ndarray, or range</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            objects. If `dict`, the keys are used as labels in the `results`</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            DataFrame, and the values are used as the lists of lags to try.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        tuple: (lags_grid, lags_label)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            - lags_grid (dict): Dictionary with lags configuration for each iteration.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            - lags_label (str): Label for lags representation in the results object.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection.utils_common import initialize_lags_grid</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(LinearRegression(), lags=2)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        &gt;&gt;&gt; lags_grid = [2, 4]</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        &gt;&gt;&gt; lags_grid, lags_label = initialize_lags_grid(forecaster, lags_grid)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        &gt;&gt;&gt; print(lags_grid)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        {&#39;2&#39;: 2, &#39;4&#39;: 4}</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        &gt;&gt;&gt; print(lags_label)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        values</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="sa">f</span><span class="s2">&quot;`lags_grid` argument must be a list, dict or None. &quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">lags_label</span> <span class="o">=</span> <span class="s2">&quot;values&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lags_grid</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">lags</span> <span class="k">for</span> <span class="n">lags</span> <span class="ow">in</span> <span class="n">lags_grid</span><span class="p">}</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">elif</span> <span class="n">lags_grid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">lags</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">lags</span><span class="p">]</span>  <span class="c1"># Required since numpy 2.0</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">lags_grid</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">lags</span><span class="p">}</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">lags_label</span> <span class="o">=</span> <span class="s2">&quot;keys&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">return</span> <span class="n">lags_grid</span><span class="p">,</span> <span class="n">lags_label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.utils_common.select_n_jobs_backtesting" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">refit</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select the optimal number of jobs to use in the backtesting process. This
selection is based on heuristics and is not guaranteed to be optimal.</p>
<p>The number of jobs is chosen as follows:</p>
<ul>
<li>If <code>refit</code> is an integer, then <code>n_jobs = 1</code>. This is because parallelization doesn't
work with intermittent refit.</li>
<li>If forecaster is 'ForecasterRecursive' and estimator is a linear estimator,
then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursive' and estimator is not a linear
estimator then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = True</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterDirect' or 'ForecasterDirectMultiVariate'
and <code>refit = False</code>, then <code>n_jobs = 1</code>.</li>
<li>If forecaster is 'ForecasterRecursiveMultiSeries', then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If forecaster is 'ForecasterStats' or 'ForecasterEquivalentDate',
then <code>n_jobs = 1</code>.</li>
<li>If estimator is a <code>LGBMRegressor(n_jobs=1)</code>, then <code>n_jobs = cpu_count() - 1</code>.</li>
<li>If estimator is a <code>LGBMRegressor</code> with internal n_jobs != 1, then <code>n_jobs = 1</code>.
This is because <code>lightgbm</code> is highly optimized for gradient boosting and
parallelizes operations at a very fine-grained level, making additional
parallelization unnecessary and potentially harmful due to resource contention.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster is refitted during the backtesting process.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection.utils_common</span><span class="w"> </span><span class="kn">import</span> <span class="n">select_n_jobs_backtesting</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">1</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/utils_common.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="k">def</span><span class="w"> </span><span class="nf">select_n_jobs_backtesting</span><span class="p">(</span><span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">refit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">    Select the optimal number of jobs to use in the backtesting process. This</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    selection is based on heuristics and is not guaranteed to be optimal.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">    The number of jobs is chosen as follows:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    - If `refit` is an integer, then `n_jobs = 1`. This is because parallelization doesn&#39;t</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    work with intermittent refit.</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and estimator is a linear estimator,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    then `n_jobs = 1`.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">    - If forecaster is &#39;ForecasterRecursive&#39; and estimator is not a linear</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    estimator then `n_jobs = cpu_count() - 1`.</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    and `refit = True`, then `n_jobs = cpu_count() - 1`.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">    - If forecaster is &#39;ForecasterDirect&#39; or &#39;ForecasterDirectMultiVariate&#39;</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">    and `refit = False`, then `n_jobs = 1`.</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">    - If forecaster is &#39;ForecasterRecursiveMultiSeries&#39;, then `n_jobs = cpu_count() - 1`.</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">    - If forecaster is &#39;ForecasterStats&#39; or &#39;ForecasterEquivalentDate&#39;,</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">    then `n_jobs = 1`.</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    - If estimator is a `LGBMRegressor(n_jobs=1)`, then `n_jobs = cpu_count() - 1`.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    - If estimator is a `LGBMRegressor` with internal n_jobs != 1, then `n_jobs = 1`.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">    This is because `lightgbm` is highly optimized for gradient boosting and</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    parallelizes operations at a very fine-grained level, making additional</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">    parallelization unnecessary and potentially harmful due to resource contention.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        forecaster: Forecaster model.</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        refit: If the forecaster is refitted during the backtesting process.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        int: The number of jobs to run in parallel.</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection.utils_common import select_n_jobs_backtesting</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(LinearRegression(), lags=2)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        &gt;&gt;&gt; select_n_jobs_backtesting(forecaster, refit=True)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">        1</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">if</span> <span class="n">forecaster_name</span> <span class="o">==</span> <span class="s2">&quot;ForecasterStats&quot;</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="k">return</span> <span class="n">n_jobs</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">estimator</span> <span class="o">=</span> <span class="n">forecaster</span><span class="o">.</span><span class="n">estimator</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="n">refit</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">refit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">refit</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refit</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">refit</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">if</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span> <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="p">(</span><span class="n">LinearModel</span><span class="p">,</span> <span class="n">LinearClassifierMixin</span><span class="p">)):</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;LGBMRegressor&quot;</span><span class="p">,</span> <span class="s2">&quot;LGBMClassifier&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">estimator</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span> <span class="s2">&quot;ForecasterDirectMultiVariate&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="c1"># Parallelization is applied during the fitting process.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ForecasterRecursiveMultiSeries&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;LGBMRegressor&quot;</span><span class="p">:</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">estimator</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>                <span class="n">n_jobs</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="k">elif</span> <span class="n">forecaster_name</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">n_jobs</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="k">return</span> <span class="n">n_jobs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="utils_metrics">utils_metrics</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.utils_metrics" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.utils_metrics</code>


</h2>

    <div class="doc doc-contents first">

        <p>Metrics calculation utilities for model selection.</p>










<div class="doc doc-children">












  </div>

    </div>

</div><h3 id="validation">validation</h3>


<div class="doc doc-object doc-module">



<h2 id="spotforecast2_safe.model_selection.validation" class="doc doc-heading">
            <code>spotforecast2_safe.model_selection.validation</code>


</h2>

    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="spotforecast2_safe.model_selection.validation.backtesting_forecaster" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">backtesting_forecaster</span><span class="p">(</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval_method</span><span class="o">=</span><span class="s1">&#39;bootstrapping&#39;</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_binned_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">return_predictors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Backtesting of forecaster model following the folds generated by the TimeSeriesFold
class and using the metric(s) provided.</p>
<p>If <code>forecaster</code> is already trained and <code>initial_train_size</code> is set to <code>None</code> in the
TimeSeriesFold class, no initial train will be done and all data will be used
to evaluate the model. However, the first <code>len(forecaster.last_window)</code> observations
are needed to create the initial predictors, so no predictions are calculated for
them.</p>
<p>A copy of the original forecaster is created so that it is not modified during
the process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forecaster</code>
            </td>
            <td>
                  <code>(<span title="ForecasterRecursive">ForecasterRecursive</span>, <span title="ForecasterDirect">ForecasterDirect</span>, <span title="ForecasterEquivalentDate">ForecasterEquivalentDate</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Forecaster model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cv</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TimeSeriesFold (spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold)" href="#spotforecast2_safe.model_selection.split_ts_cv.TimeSeriesFold">TimeSeriesFold</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeSeriesFold object with the information needed to
split the data into folds.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metric</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="typing.Callable">Callable</span> | <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metric used to quantify the goodness of fit
of the model.</p>
<ul>
<li>If <code>str</code>: {'mean_squared_error', 'mean_absolute_error',
  'mean_absolute_percentage_error', 'mean_squared_log_error',
  'mean_absolute_scaled_error', 'root_mean_squared_scaled_error'}</li>
<li>If <code>Callable</code>: Function with arguments <code>y_true</code>, <code>y_pred</code> and <code>y_train</code>
  (Optional) that returns a float.</li>
<li>If <code>list</code>: List containing multiple strings and/or Callables.</li>
</ul>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exog</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span> | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as
predictor/s. Must have the same number of observations as <code>y</code> and should
be aligned so that y[i] is regressed on exog[i]. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | <span title="list">list</span> | <span title="tuple">tuple</span> | <span title="str">str</span> | <span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies whether
probabilistic predictions should be estimated and the method to use.
The following options are supported:</p>
<ul>
<li>If <code>float</code>, represents the nominal (expected) coverage (between 0 and 1).
For instance, <code>interval=0.95</code> corresponds to <code>[2.5, 97.5]</code> percentiles.</li>
<li>If <code>list</code> or <code>tuple</code>: Sequence of percentiles to compute, each value must
  be between 0 and 100 inclusive. For example, a 95% confidence interval can
  be specified as <code>interval = [2.5, 97.5]</code> or multiple percentiles (e.g. 10,
  50 and 90) as <code>interval = [10, 50, 90]</code>.</li>
<li>If 'bootstrapping' (str): <code>n_boot</code> bootstrapping predictions will be
  generated.</li>
<li>If scipy.stats distribution object, the distribution parameters will
  be estimated for each prediction.</li>
<li>If None, no probabilistic predictions are estimated.
Defaults to None.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval_method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Technique used to estimate prediction
intervals. Available options:</p>
<ul>
<li>'bootstrapping': Bootstrapping is used to generate prediction intervals.</li>
<li>'conformal': Employs the conformal prediction split method for
  interval estimation.
Defaults to 'bootstrapping'.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>&#39;bootstrapping&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_boot</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations to perform when
estimating prediction intervals. Defaults to 250.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_in_sample_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the
training data are used as proxy of prediction error to create predictions.
If <code>False</code>, out of sample residuals (calibration) are used.
Out-of-sample residuals must be precomputed using Forecaster's
<code>set_out_sample_residuals()</code> method. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_binned_residuals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are selected
based on the predicted values (binned selection).
If <code>False</code>, residuals are selected randomly. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator to
ensure reproducibility. Defaults to 123.</p>
              </div>
            </td>
            <td>
                  <code>123</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_predictors</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the predictors used to make
the predictions are also returned. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of jobs to run in parallel. If <code>-1</code>,
then the number of jobs is set to the number of cores. If 'auto', <code>n_jobs</code>
is set using the function <code>skforecast.utils.select_n_jobs_backtesting</code>.
Defaults to 'auto'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Print number of folds and index of training and
validation sets used for backtesting. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_progress</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show a progress bar.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>suppress_warnings</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, spotforecast warnings will be
suppressed during the backtesting process. See
<code>spotforecast.exceptions.warn_skforecast_categories</code> for more information.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrame">DataFrame</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>metric_values: Value(s) of the metric(s).</li>
<li>
<p>backtest_predictions: Value of predictions. The DataFrame includes
  the following columns:</p>
</li>
<li>
<p>fold: Indicates the fold number where the prediction was made.</p>
</li>
<li>pred: Predicted values for the corresponding series and time steps.</li>
</ul>
<p>If <code>interval</code> is not <code>None</code>, additional columns are included depending
  on the method:</p>
<ul>
<li>For <code>float</code>: Columns <code>lower_bound</code> and <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> of 2 elements: Columns <code>lower_bound</code> and
    <code>upper_bound</code>.</li>
<li>For <code>list</code> or <code>tuple</code> with multiple percentiles: One column per
    percentile (e.g., <code>p_10</code>, <code>p_50</code>, <code>p_90</code>).</li>
<li>For <code>'bootstrapping'</code>: One column per bootstrapping iteration
    (e.g., <code>pred_boot_0</code>, <code>pred_boot_1</code>, ..., <code>pred_boot_n</code>).</li>
<li>For <code>scipy.stats</code> distribution objects: One column for each
    estimated parameter of the distribution (e.g., <code>loc</code>, <code>scale</code>).</li>
</ul>
<p>If <code>return_predictors</code> is <code>True</code>, one column per predictor is created.</p>
<p>Depending on the relation between <code>steps</code> and <code>fold_stride</code>, the output
  may include repeated indexes (if <code>fold_stride &lt; steps</code>) or gaps
  (if <code>fold_stride &gt; steps</code>). See Notes below for more details.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Note on <code>fold_stride</code> vs. <code>steps</code>:</p>
<ul>
<li>If <code>fold_stride == steps</code>, test sets are placed back-to-back without overlap.
  Each observation appears only once in the output DataFrame, so the
  index is unique.</li>
<li>If <code>fold_stride &lt; steps</code>, test sets overlap. Multiple forecasts are
  generated for the same observations and, therefore, the output
  DataFrame contains repeated indexes.</li>
<li>If <code>fold_stride &gt; steps</code>, there are gaps between consecutive test sets.
  Some observations in the series will not have associated predictions,
  so the output DataFrame has non-contiguous indexes.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.forecaster.recursive</span><span class="w"> </span><span class="kn">import</span> <span class="n">ForecasterRecursive</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotforecast2.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">backtesting_forecaster</span><span class="p">,</span> <span class="n">TimeSeriesFold</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ForecasterRecursive</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="mi">2</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cv</span> <span class="o">=</span> <span class="n">TimeSeriesFold</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">steps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">initial_train_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">refit</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>    <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span>    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;mean_squared_error&#39;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">metric_values</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">   mean_squared_error</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">0            0.201334</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">backtest_predictions</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">   fold  pred</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">5     0  5.18</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">6     0  6.10</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">7     1  7.36</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">8     1  8.40</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">9     2  9.31</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotforecast2_safe/model_selection/validation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="k">def</span><span class="w"> </span><span class="nf">backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">forecaster</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">cv</span><span class="p">:</span> <span class="n">TimeSeriesFold</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">],</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">exog</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">object</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">interval_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bootstrapping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="n">use_binned_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">return_predictors</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="n">show_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Backtesting of forecaster model following the folds generated by the TimeSeriesFold</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    class and using the metric(s) provided.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    If `forecaster` is already trained and `initial_train_size` is set to `None` in the</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    TimeSeriesFold class, no initial train will be done and all data will be used</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    to evaluate the model. However, the first `len(forecaster.last_window)` observations</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">    are needed to create the initial predictors, so no predictions are calculated for</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    them.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    A copy of the original forecaster is created so that it is not modified during</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    the process.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        forecaster (ForecasterRecursive, ForecasterDirect, ForecasterEquivalentDate):</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            Forecaster model.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        y (pd.Series): Training time series.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">        cv (TimeSeriesFold): TimeSeriesFold object with the information needed to</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">            split the data into folds.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        metric (str | Callable | list): Metric used to quantify the goodness of fit</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">            of the model.</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            - If `str`: {&#39;mean_squared_error&#39;, &#39;mean_absolute_error&#39;,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">              &#39;mean_absolute_percentage_error&#39;, &#39;mean_squared_log_error&#39;,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">              &#39;mean_absolute_scaled_error&#39;, &#39;root_mean_squared_scaled_error&#39;}</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            - If `Callable`: Function with arguments `y_true`, `y_pred` and `y_train`</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">              (Optional) that returns a float.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">            - If `list`: List containing multiple strings and/or Callables.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        exog (pd.Series | pd.DataFrame, optional): Exogenous variable/s included as</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">            predictor/s. Must have the same number of observations as `y` and should</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">            be aligned so that y[i] is regressed on exog[i]. Defaults to None.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        interval (float | list | tuple | str | object, optional): Specifies whether</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            probabilistic predictions should be estimated and the method to use.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            The following options are supported:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">            - If `float`, represents the nominal (expected) coverage (between 0 and 1).</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            For instance, `interval=0.95` corresponds to `[2.5, 97.5]` percentiles.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            - If `list` or `tuple`: Sequence of percentiles to compute, each value must</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">              be between 0 and 100 inclusive. For example, a 95% confidence interval can</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">              be specified as `interval = [2.5, 97.5]` or multiple percentiles (e.g. 10,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">              50 and 90) as `interval = [10, 50, 90]`.</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            - If &#39;bootstrapping&#39; (str): `n_boot` bootstrapping predictions will be</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">              generated.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            - If scipy.stats distribution object, the distribution parameters will</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">              be estimated for each prediction.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">            - If None, no probabilistic predictions are estimated.</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        interval_method (str, optional): Technique used to estimate prediction</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            intervals. Available options:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">            - &#39;bootstrapping&#39;: Bootstrapping is used to generate prediction intervals.</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">            - &#39;conformal&#39;: Employs the conformal prediction split method for</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">              interval estimation.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            Defaults to &#39;bootstrapping&#39;.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        n_boot (int, optional): Number of bootstrapping iterations to perform when</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">            estimating prediction intervals. Defaults to 250.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        use_in_sample_residuals (bool, optional): If `True`, residuals from the</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            training data are used as proxy of prediction error to create predictions.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            If `False`, out of sample residuals (calibration) are used.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            Out-of-sample residuals must be precomputed using Forecaster&#39;s</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            `set_out_sample_residuals()` method. Defaults to True.</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        use_binned_residuals (bool, optional): If `True`, residuals are selected</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            based on the predicted values (binned selection).</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            If `False`, residuals are selected randomly. Defaults to True.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        random_state (int, optional): Seed for the random number generator to</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            ensure reproducibility. Defaults to 123.</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        return_predictors (bool, optional): If `True`, the predictors used to make</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            the predictions are also returned. Defaults to False.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        n_jobs (int | str, optional): The number of jobs to run in parallel. If `-1`,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            then the number of jobs is set to the number of cores. If &#39;auto&#39;, `n_jobs`</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            is set using the function `skforecast.utils.select_n_jobs_backtesting`.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            Defaults to &#39;auto&#39;.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        verbose (bool, optional): Print number of folds and index of training and</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            validation sets used for backtesting. Defaults to False.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        show_progress (bool, optional): Whether to show a progress bar.</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">            Defaults to True.</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        suppress_warnings (bool, optional): If `True`, spotforecast warnings will be</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">            suppressed during the backtesting process. See</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">            `spotforecast.exceptions.warn_skforecast_categories` for more information.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        tuple (pd.DataFrame, pd.DataFrame):</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            - metric_values: Value(s) of the metric(s).</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">            - backtest_predictions: Value of predictions. The DataFrame includes</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">              the following columns:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">              - fold: Indicates the fold number where the prediction was made.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">              - pred: Predicted values for the corresponding series and time steps.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">              If `interval` is not `None`, additional columns are included depending</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">              on the method:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">              - For `float`: Columns `lower_bound` and `upper_bound`.</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">              - For `list` or `tuple` of 2 elements: Columns `lower_bound` and</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">                `upper_bound`.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">              - For `list` or `tuple` with multiple percentiles: One column per</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">                percentile (e.g., `p_10`, `p_50`, `p_90`).</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">              - For `&#39;bootstrapping&#39;`: One column per bootstrapping iteration</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">                (e.g., `pred_boot_0`, `pred_boot_1`, ..., `pred_boot_n`).</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">              - For `scipy.stats` distribution objects: One column for each</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">                estimated parameter of the distribution (e.g., `loc`, `scale`).</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">              If `return_predictors` is `True`, one column per predictor is created.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">              Depending on the relation between `steps` and `fold_stride`, the output</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">              may include repeated indexes (if `fold_stride &lt; steps`) or gaps</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">              (if `fold_stride &gt; steps`). See Notes below for more details.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        Note on `fold_stride` vs. `steps`:</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        - If `fold_stride == steps`, test sets are placed back-to-back without overlap.</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">          Each observation appears only once in the output DataFrame, so the</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">          index is unique.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        - If `fold_stride &lt; steps`, test sets overlap. Multiple forecasts are</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">          generated for the same observations and, therefore, the output</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">          DataFrame contains repeated indexes.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        - If `fold_stride &gt; steps`, there are gaps between consecutive test sets.</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">          Some observations in the series will not have associated predictions,</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">          so the output DataFrame has non-contiguous indexes.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">        &gt;&gt;&gt; from sklearn.ensemble import RandomForestRegressor</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.forecaster.recursive import ForecasterRecursive</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        &gt;&gt;&gt; from spotforecast2.model_selection import backtesting_forecaster, TimeSeriesFold</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">        &gt;&gt;&gt; y = pd.Series([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        &gt;&gt;&gt; forecaster = ForecasterRecursive(</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        ...     estimator=RandomForestRegressor(random_state=123),</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        ...     lags=2</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        &gt;&gt;&gt; cv = TimeSeriesFold(</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        ...     steps=2,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">        ...     initial_train_size=5,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        ...     refit=False</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">        &gt;&gt;&gt; metric_values, backtest_predictions = backtesting_forecaster(</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">        ...     forecaster=forecaster,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="sd">        ...     y=y,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="sd">        ...     cv=cv,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="sd">        ...     metric=&#39;mean_squared_error&#39;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="sd">        &gt;&gt;&gt; metric_values</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">           mean_squared_error</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        0            0.201334</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        &gt;&gt;&gt; backtest_predictions</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">           fold  pred</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        5     0  5.18</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a><span class="sd">        6     0  6.10</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        7     1  7.36</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        8     1  8.40</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        9     2  9.31</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="n">forecaters_allowed</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="s2">&quot;ForecasterRecursive&quot;</span><span class="p">,</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="s2">&quot;ForecasterDirect&quot;</span><span class="p">,</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="s2">&quot;ForecasterEquivalentDate&quot;</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="s2">&quot;ForecasterRecursiveClassifier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="p">]</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">forecaster</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">forecaters_allowed</span><span class="p">:</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="sa">f</span><span class="s2">&quot;`forecaster` must be of type </span><span class="si">{</span><span class="n">forecaters_allowed</span><span class="si">}</span><span class="s2">. For all other &quot;</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="sa">f</span><span class="s2">&quot;types of forecasters use the other functions available in the &quot;</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="sa">f</span><span class="s2">&quot;`model_selection` module.&quot;</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="n">check_backtesting_input</span><span class="p">(</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="n">interval_method</span><span class="o">=</span><span class="n">interval_method</span><span class="p">,</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">return_predictors</span><span class="o">=</span><span class="n">return_predictors</span><span class="p">,</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span> <span class="o">=</span> <span class="n">_backtesting_forecaster</span><span class="p">(</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">interval_method</span><span class="o">=</span><span class="n">interval_method</span><span class="p">,</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">n_boot</span><span class="o">=</span><span class="n">n_boot</span><span class="p">,</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="n">use_in_sample_residuals</span><span class="p">,</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="n">use_binned_residuals</span><span class="o">=</span><span class="n">use_binned_residuals</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="n">return_predictors</span><span class="o">=</span><span class="n">return_predictors</span><span class="p">,</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="n">suppress_warnings</span><span class="o">=</span><span class="n">suppress_warnings</span><span class="p">,</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">return</span> <span class="n">metric_values</span><span class="p">,</span> <span class="n">backtest_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../forecaster/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Forecaster">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Forecaster
              </div>
            </div>
          </a>
        
        
          
          <a href="../stats/" class="md-footer__link md-footer__link--next" aria-label="Next: Stats">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Stats
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024-2026 bartzbeielstein
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/sequential-parameter-optimization/spotforecast2" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "content.code.copy", "content.code.annotate", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>